{"version":3,"file":"static/js/1220.8c449475.chunk.js","mappings":"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","sources":["pages/Trade/TradeStatusStepper.tsx","pages/Trade/components/CostBreakdown.tsx","pages/Trade/components/TradeCostForm.tsx","pages/Trade/components/TradeBrokerageForm.tsx","pages/Trade/components/TradeFinancingForm.tsx","pages/Trade/components/TradeLoanForm.tsx","pages/Trade/components/DeliveryProgressCard.tsx","pages/Trade/components/GRNListWithInvoices.tsx","pages/Trade/components/DeliveryBatchForm.tsx","pages/Trade/components/VoucherAllocationDialog.tsx","pages/Trade/TradeDetails.tsx"],"sourcesContent":["// src/pages/Trade/TradeStatusStepper.tsx - CORRECTED VERSION\nimport React, { FC } from \"react\";\nimport { Stepper, Step, StepLabel, Box, Chip } from \"@mui/material\";\n\ninterface TradeStatusStepperProps {\n  currentStatus: string;\n}\n\n//  FIXED: Added pending_allocation step\nconst statusSteps = [\n  \"draft\",\n  \"pending_approval\",\n  \"approved\",\n  \"pending_allocation\",  //  ADDED - this was missing!\n  \"ready_for_delivery\",\n  \"in_transit\",\n  \"delivered\",\n  \"completed\",\n];\n\nconst statusLabels: Record<string, string> = {\n  draft: \"Draft\",\n  pending_approval: \"Pending Approval\",\n  approved: \"Approved\",\n  pending_allocation: \"Pending Allocation\",  //  ADDED\n  ready_for_delivery: \"Ready for Delivery\",\n  in_transit: \"In Transit\",\n  delivered: \"Delivered\",\n  completed: \"Completed\",\n};\n\n//  Optional statuses that might be skipped\nconst optionalStatuses = [\"pending_allocation\"];\n\nconst TradeStatusStepper: FC<TradeStatusStepperProps> = ({ currentStatus }) => {\n  // Handle special statuses\n  if (currentStatus === \"cancelled\" || currentStatus === \"rejected\") {\n    return (\n      <Box sx={{ textAlign: \"center\", py: 2 }}>\n        <Chip\n          label={currentStatus === \"cancelled\" ? \"Trade Cancelled\" : \"Trade Rejected\"}\n          color=\"error\"\n          sx={{ fontSize: 16, py: 2, px: 3 }}\n        />\n      </Box>\n    );\n  }\n\n  const activeStep = statusSteps.indexOf(currentStatus);\n\n  return (\n    <Box sx={{ width: \"100%\" }}>\n      <Stepper activeStep={activeStep} alternativeLabel>\n        {statusSteps.map((step) => (\n          <Step key={step}>\n            <StepLabel\n              optional={\n                optionalStatuses.includes(step) ? (\n                  <Box component=\"span\" sx={{ fontSize: 10, color: \"text.secondary\" }}>\n                    (If required)\n                  </Box>\n                ) : undefined\n              }\n            >\n              {statusLabels[step]}\n            </StepLabel>\n          </Step>\n        ))}\n      </Stepper>\n    </Box>\n  );\n};\n\nexport default TradeStatusStepper;","import React, { FC, useEffect, useState } from \"react\";\nimport {\n  Box,\n  Grid,\n  Typography,\n  Paper,\n  Divider,\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableRow,\n} from \"@mui/material\";\nimport { TradeService } from \"../Trade.service\";\nimport ProgressIndicator from \"../../../components/UI/ProgressIndicator\";\n\ninterface CostBreakdownProps {\n  tradeId: string;\n}\n\nconst CostBreakdown: FC<CostBreakdownProps> = ({ tradeId }) => {\n  const [breakdown, setBreakdown] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchBreakdown();\n  }, [tradeId]);\n\n  const fetchBreakdown = async () => {\n    try {\n      setLoading(true);\n      const data = await TradeService.getCostBreakdown(tradeId);\n      setBreakdown(data);\n      setLoading(false);\n    } catch (error) {\n      setLoading(false);\n      console.error(\"Failed to load cost breakdown\");\n    }\n  };\n\n  if (loading) {\n    return (\n      <Box display=\"flex\" justifyContent=\"center\" p={3}>\n        <ProgressIndicator />\n      </Box>\n    );\n  }\n\n  if (!breakdown) {\n    return <Typography>No cost breakdown available</Typography>;\n  }\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat(\"en-UG\", {\n      style: \"currency\",\n      currency: \"UGX\",\n      minimumFractionDigits: 0,\n    }).format(value);\n  };\n\n  return (\n    <Box>\n      <Grid container spacing={3}>\n        {/* Direct Costs */}\n        <Grid item xs={12} md={6}>\n          <Paper sx={{ p: 2 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              Direct Costs\n            </Typography>\n            <Table size=\"small\">\n              <TableBody>\n                <TableRow>\n                  <TableCell>Purchase Cost</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.purchase_cost)}\n                  </TableCell>\n                </TableRow>\n                <TableRow>\n                  <TableCell>Aflatoxin/QA Cost</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.aflatoxin_qa_cost)}\n                  </TableCell>\n                </TableRow>\n                <TableRow>\n                  <TableCell>Weighbridge Cost</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.weighbridge_cost)}\n                  </TableCell>\n                </TableRow>\n                <TableRow>\n                  <TableCell>Offloading Cost</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.offloading_cost)}\n                  </TableCell>\n                </TableRow>\n                <TableRow>\n                  <TableCell>Loading Cost</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.loading_cost)}\n                  </TableCell>\n                </TableRow>\n                <TableRow>\n                  <TableCell>Transport Cost</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.transport_cost)}\n                  </TableCell>\n                </TableRow>\n              </TableBody>\n            </Table>\n          </Paper>\n        </Grid>\n\n        {/* Additional Costs */}\n        <Grid item xs={12} md={6}>\n          <Paper sx={{ p: 2 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              Additional Costs\n            </Typography>\n            <Table size=\"small\">\n              <TableBody>\n                <TableRow>\n                  <TableCell>Financing Cost</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.financing_cost)}\n                  </TableCell>\n                </TableRow>\n                <TableRow>\n                  <TableCell>GIT Insurance</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.git_insurance_cost)}\n                  </TableCell>\n                </TableRow>\n                <TableRow>\n                  <TableCell>Deductions</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.deduction_cost)}\n                  </TableCell>\n                </TableRow>\n                <TableRow>\n                  <TableCell>Other Expenses</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.other_expenses)}\n                  </TableCell>\n                </TableRow>\n                <TableRow>\n                  <TableCell>Bennu Fees (to seller)</TableCell>\n                  <TableCell align=\"right\">\n                    {formatCurrency(breakdown.bennu_to_seller)}\n                  </TableCell>\n                </TableRow>\n                {breakdown.loss_cost > 0 && (\n                  <TableRow>\n                    <TableCell>Loss Cost</TableCell>\n                    <TableCell align=\"right\" sx={{ color: \"error.main\" }}>\n                      {formatCurrency(breakdown.loss_cost)}\n                    </TableCell>\n                  </TableRow>\n                )}\n              </TableBody>\n            </Table>\n          </Paper>\n        </Grid>\n\n        {/* Summary */}\n        <Grid item xs={12}>\n          <Paper sx={{ p: 2 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              Summary\n            </Typography>\n            <Divider sx={{ my: 1 }} />\n            <Grid container spacing={2}>\n              <Grid item xs={6}>\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  Total Trade Cost\n                </Typography>\n                <Typography variant=\"h6\" fontWeight={700}>\n                  {formatCurrency(breakdown.total_trade_cost)}\n                </Typography>\n              </Grid>\n              <Grid item xs={6}>\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  Payable by Buyer\n                </Typography>\n                <Typography variant=\"h6\" fontWeight={700} color=\"success.main\">\n                  {formatCurrency(breakdown.payable_by_buyer)}\n                </Typography>\n              </Grid>\n              <Grid item xs={6}>\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  Gross Margin\n                </Typography>\n                <Typography variant=\"h6\" fontWeight={700} color=\"primary.main\">\n                  {formatCurrency(breakdown.margin)}\n                </Typography>\n              </Grid>\n              <Grid item xs={6}>\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  Net Profit (after brokerage)\n                </Typography>\n                <Typography variant=\"h6\" fontWeight={700} color=\"primary.main\">\n                  {formatCurrency(breakdown.net_profit)}\n                </Typography>\n              </Grid>\n            </Grid>\n          </Paper>\n        </Grid>\n\n        {/* Brokerages */}\n        {breakdown.brokerage_costs && breakdown.brokerage_costs.length > 0 && (\n          <Grid item xs={12}>\n            <Paper sx={{ p: 2 }}>\n              <Typography variant=\"h6\" gutterBottom>\n                Brokerage Costs\n              </Typography>\n              <Table size=\"small\">\n                <TableHead>\n                  <TableRow>\n                    <TableCell>Agent</TableCell>\n                    <TableCell>Type</TableCell>\n                    <TableCell>Value</TableCell>\n                    <TableCell align=\"right\">Amount</TableCell>\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {breakdown.brokerage_costs.map((brokerage: any, index: number) => (\n                    <TableRow key={index}>\n                      <TableCell>{brokerage.agent || \"N/A\"}</TableCell>\n                      <TableCell>{brokerage.commission_type}</TableCell>\n                      <TableCell>{brokerage.commission_value}</TableCell>\n                      <TableCell align=\"right\">\n                        {formatCurrency(brokerage.amount)}\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </Paper>\n          </Grid>\n        )}\n      </Grid>\n    </Box>\n  );\n};\n\nexport default CostBreakdown;","// src/pages/Trade/components/TradeCostForm.tsx\nimport React, { FC, useState } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n  Grid,\n  MenuItem,\n  FormControlLabel,\n  Checkbox,\n  CircularProgress,\n} from \"@mui/material\";\nimport { useFormik } from \"formik\";\nimport * as Yup from \"yup\";\nimport { toast } from \"react-hot-toast\";\nimport { TradeService } from \"../Trade.service\";\n\ninterface TradeCostFormProps {\n  open: boolean;\n  onClose: () => void;\n  tradeId: string;\n  onSuccess: () => void;\n  initialValues?: any;\n}\n\nconst validationSchema = Yup.object({\n  cost_type: Yup.string().required(\"Cost type is required\"),\n  amount: Yup.number().required(\"Amount is required\").min(0, \"Amount must be positive\"),\n  description: Yup.string(),\n  is_per_unit: Yup.boolean(),\n});\n\nconst costTypes = [\n  \"Storage\",\n  \"Handling\",\n  \"Fumigation\",\n  \"Packaging\",\n  \"Administrative\",\n  \"Insurance\",\n  \"Security\",\n  \"Other\",\n];\n\nconst TradeCostForm: FC<TradeCostFormProps> = ({\n  open,\n  onClose,\n  tradeId,\n  onSuccess,\n  initialValues,\n}) => {\n  const [loading, setLoading] = useState(false);\n\n  const formik = useFormik({\n    initialValues: initialValues || {\n      cost_type: \"\",\n      amount: \"\",\n      description: \"\",\n      is_per_unit: false,\n    },\n    validationSchema,\n    enableReinitialize: true,\n    onSubmit: async (values) => {\n      try {\n        setLoading(true);\n        const payload = {\n          ...values,\n          trade: tradeId,\n        };\n\n        if (initialValues?.id) {\n          await TradeService.updateTradeCost(payload, initialValues.id);\n          toast.success(\"Cost updated successfully\");\n        } else {\n          await TradeService.createTradeCost(payload);\n          toast.success(\"Cost added successfully\");\n        }\n\n        onSuccess();\n        onClose();\n        formik.resetForm();\n      } catch (error: any) {\n        toast.error(error?.response?.data?.error || \"Failed to save cost\");\n      } finally {\n        setLoading(false);\n      }\n    },\n  });\n\n  const handleClose = () => {\n    if (!loading) {\n      formik.resetForm();\n      onClose();\n    }\n  };\n\n  return (\n    <Dialog open={open} onClose={handleClose} maxWidth=\"sm\" fullWidth>\n      <DialogTitle>\n        {initialValues ? \"Edit Trade Cost\" : \"Add Trade Cost\"}\n      </DialogTitle>\n      <form onSubmit={formik.handleSubmit}>\n        <DialogContent>\n          <Grid container spacing={2}>\n            <Grid item xs={12}>\n              <TextField\n                select\n                fullWidth\n                label=\"Cost Type *\"\n                name=\"cost_type\"\n                value={formik.values.cost_type}\n                onChange={formik.handleChange}\n                error={formik.touched.cost_type && Boolean(formik.errors.cost_type)}\n                helperText={formik.touched.cost_type && formik.errors.cost_type}\n              >\n                {costTypes.map((type) => (\n                  <MenuItem key={type} value={type}>\n                    {type}\n                  </MenuItem>\n                ))}\n              </TextField>\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                type=\"number\"\n                label=\"Amount *\"\n                name=\"amount\"\n                value={formik.values.amount}\n                onChange={formik.handleChange}\n                error={formik.touched.amount && Boolean(formik.errors.amount)}\n                helperText={formik.touched.amount && formik.errors.amount}\n                InputProps={{\n                  startAdornment: \"UGX\",\n                }}\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    name=\"is_per_unit\"\n                    checked={formik.values.is_per_unit}\n                    onChange={formik.handleChange}\n                  />\n                }\n                label=\"Is Per Unit (per kg)\"\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                multiline\n                rows={3}\n                label=\"Description\"\n                name=\"description\"\n                value={formik.values.description}\n                onChange={formik.handleChange}\n                error={formik.touched.description && Boolean(formik.errors.description)}\n                helperText={formik.touched.description && formik.errors.description}\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} disabled={loading}>\n            Cancel\n          </Button>\n          <Button type=\"submit\" variant=\"contained\" disabled={loading}>\n            {loading ? <CircularProgress size={24} /> : initialValues ? \"Update\" : \"Add\"}\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n\nexport default TradeCostForm;","// src/pages/Trade/components/TradeBrokerageForm.tsx\nimport React, { FC, useState, useEffect } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n  Grid,\n  MenuItem,\n  CircularProgress,\n  Autocomplete,\n} from \"@mui/material\";\nimport { useFormik } from \"formik\";\nimport * as Yup from \"yup\";\nimport { toast } from \"react-hot-toast\";\nimport { TradeService } from \"../Trade.service\";\n\ninterface TradeBrokerageFormProps {\n  open: boolean;\n  onClose: () => void;\n  tradeId: string;\n  onSuccess: () => void;\n  initialValues?: any;\n}\n\nconst validationSchema = Yup.object({\n  agent_id: Yup.string().required(\"Agent is required\"),\n  commission_type: Yup.string().required(\"Commission type is required\"),\n  commission_value: Yup.number()\n    .required(\"Commission value is required\")\n    .min(0, \"Must be positive\"),\n  notes: Yup.string(),\n});\n\nconst commissionTypes = [\n  { value: \"percentage\", label: \"Percentage of Trade Value\" },\n  { value: \"per_mt\", label: \"Per Metric Ton\" },\n  { value: \"per_kg\", label: \"Per Kilogram\" },\n  { value: \"fixed\", label: \"Fixed Amount\" },\n];\n\nconst TradeBrokerageForm: FC<TradeBrokerageFormProps> = ({\n  open,\n  onClose,\n  tradeId,\n  onSuccess,\n  initialValues,\n}) => {\n  const [loading, setLoading] = useState(false);\n  const [agents, setAgents] = useState<any[]>([]);\n  const [agentLoading, setAgentLoading] = useState(false);\n\n  useEffect(() => {\n    if (open) {\n      loadAgents();\n    }\n  }, [open]);\n\n  const loadAgents = async (search?: string) => {\n    try {\n      setAgentLoading(true);\n      const data = await TradeService.getAgents(search);\n      setAgents(\n        data.results.map((agent: any) => ({\n          label: `${agent.first_name} ${agent.last_name}`,\n          value: agent.id,\n        }))\n      );\n    } catch (error) {\n      console.error(\"Failed to load agents:\", error);\n    } finally {\n      setAgentLoading(false);\n    }\n  };\n\n  const formik = useFormik({\n    initialValues: initialValues || {\n      agent_id: \"\",\n      commission_type: \"percentage\",\n      commission_value: \"\",\n      notes: \"\",\n    },\n    validationSchema,\n    enableReinitialize: true,\n    onSubmit: async (values) => {\n      try {\n        setLoading(true);\n        const payload = {\n          ...values,\n          trade: tradeId,\n        };\n\n        if (initialValues?.id) {\n          await TradeService.updateBrokerage(payload, initialValues.id);\n          toast.success(\"Brokerage updated successfully\");\n        } else {\n          await TradeService.createBrokerage(payload);\n          toast.success(\"Brokerage added successfully\");\n        }\n\n        onSuccess();\n        onClose();\n        formik.resetForm();\n      } catch (error: any) {\n        toast.error(error?.response?.data?.error || \"Failed to save brokerage\");\n      } finally {\n        setLoading(false);\n      }\n    },\n  });\n\n  const handleClose = () => {\n    if (!loading) {\n      formik.resetForm();\n      onClose();\n    }\n  };\n\n  return (\n    <Dialog open={open} onClose={handleClose} maxWidth=\"sm\" fullWidth>\n      <DialogTitle>\n        {initialValues ? \"Edit Brokerage\" : \"Add Brokerage\"}\n      </DialogTitle>\n      <form onSubmit={formik.handleSubmit}>\n        <DialogContent>\n          <Grid container spacing={2}>\n            <Grid item xs={12}>\n              <Autocomplete\n                options={agents}\n                loading={agentLoading}\n                value={agents.find((a) => a.value === formik.values.agent_id) || null}\n                onChange={(_, newValue) => {\n                  formik.setFieldValue(\"agent_id\", newValue?.value || \"\");\n                }}\n                onInputChange={(_, value) => {\n                  if (value) loadAgents(value);\n                }}\n                renderInput={(params) => (\n                  <TextField\n                    {...params}\n                    label=\"Agent/BDM *\"\n                    error={formik.touched.agent_id && Boolean(formik.errors.agent_id)}\n                    helperText={formik.touched.agent_id && formik.errors.agent_id}\n                  />\n                )}\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                select\n                fullWidth\n                label=\"Commission Type *\"\n                name=\"commission_type\"\n                value={formik.values.commission_type}\n                onChange={formik.handleChange}\n                error={\n                  formik.touched.commission_type &&\n                  Boolean(formik.errors.commission_type)\n                }\n                helperText={\n                  formik.touched.commission_type && formik.errors.commission_type\n                }\n              >\n                {commissionTypes.map((type) => (\n                  <MenuItem key={type.value} value={type.value}>\n                    {type.label}\n                  </MenuItem>\n                ))}\n              </TextField>\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                type=\"number\"\n                label=\"Commission Value *\"\n                name=\"commission_value\"\n                value={formik.values.commission_value}\n                onChange={formik.handleChange}\n                error={\n                  formik.touched.commission_value &&\n                  Boolean(formik.errors.commission_value)\n                }\n                helperText={\n                  formik.touched.commission_value && formik.errors.commission_value\n                }\n                placeholder={\n                  formik.values.commission_type === \"percentage\"\n                    ? \"Enter percentage (e.g., 2.5)\"\n                    : \"Enter amount\"\n                }\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                multiline\n                rows={3}\n                label=\"Notes\"\n                name=\"notes\"\n                value={formik.values.notes}\n                onChange={formik.handleChange}\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} disabled={loading}>\n            Cancel\n          </Button>\n          <Button type=\"submit\" variant=\"contained\" disabled={loading}>\n            {loading ? (\n              <CircularProgress size={24} />\n            ) : initialValues ? (\n              \"Update\"\n            ) : (\n              \"Add\"\n            )}\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n\nexport default TradeBrokerageForm;","// src/pages/Trade/components/TradeFinancingForm.tsx\nimport React, { FC, useState, useEffect } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n  Grid,\n  CircularProgress,\n  Autocomplete,\n  Typography,\n  Alert,\n} from \"@mui/material\";\nimport { useFormik } from \"formik\";\nimport * as Yup from \"yup\";\nimport { toast } from \"react-hot-toast\";\nimport { TradeService } from \"../Trade.service\";\n\ninterface TradeFinancingFormProps {\n  open: boolean;\n  onClose: () => void;\n  tradeId: string;\n  onSuccess: () => void;\n  tradeDetails?: any;\n}\n\nconst validationSchema = Yup.object({\n  investor_account_id: Yup.string().required(\"Investor account is required\"),\n  allocated_amount: Yup.number()\n    .required(\"Allocated amount is required\")\n    .min(0, \"Must be positive\"),\n  notes: Yup.string(),\n});\n\nconst TradeFinancingForm: FC<TradeFinancingFormProps> = ({\n  open,\n  onClose,\n  tradeId,\n  onSuccess,\n  tradeDetails,\n}) => {\n  const [loading, setLoading] = useState(false);\n  const [investors, setInvestors] = useState<any[]>([]);\n  const [investorLoading, setInvestorLoading] = useState(false);\n\n  useEffect(() => {\n    if (open) {\n      loadInvestors();\n    }\n  }, [open]);\n\n  const loadInvestors = async (search?: string) => {\n    try {\n      setInvestorLoading(true);\n      const data = await TradeService.getInvestorAccounts(search);\n      setInvestors(\n        data.results.map((inv: any) => ({\n          label: `${inv.investor_name} - Available: ${formatCurrency(\n            inv.available_balance\n          )}`,\n          value: inv.id,\n          available_balance: inv.available_balance,\n        }))\n      );\n    } catch (error) {\n      console.error(\"Failed to load investors:\", error);\n    } finally {\n      setInvestorLoading(false);\n    }\n  };\n\n  const formik = useFormik({\n    initialValues: {\n      investor_account_id: \"\",\n      allocated_amount: \"\",\n      notes: \"\",\n    },\n    validationSchema,\n    onSubmit: async (values) => {\n      try {\n        setLoading(true);\n        const payload = {\n          ...values,\n          trade: tradeId,\n        };\n\n        await TradeService.createFinancingAllocation(payload);\n        toast.success(\"Financing allocated successfully\");\n\n        onSuccess();\n        onClose();\n        formik.resetForm();\n      } catch (error: any) {\n        toast.error(\n          error?.response?.data?.allocated_amount?.[0] ||\n            error?.response?.data?.error ||\n            \"Failed to allocate financing\"\n        );\n      } finally {\n        setLoading(false);\n      }\n    },\n  });\n\n  const handleClose = () => {\n    if (!loading) {\n      formik.resetForm();\n      onClose();\n    }\n  };\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat(\"en-UG\", {\n      style: \"currency\",\n      currency: \"UGX\",\n      minimumFractionDigits: 0,\n    }).format(value);\n  };\n\n  return (\n    <Dialog open={open} onClose={handleClose} maxWidth=\"sm\" fullWidth>\n      <DialogTitle>Allocate Investor Financing</DialogTitle>\n      <form onSubmit={formik.handleSubmit}>\n        <DialogContent>\n          {tradeDetails && (\n            <Alert severity=\"info\" sx={{ mb: 2 }}>\n              <Typography variant=\"body2\">\n                Trade Cost: {formatCurrency(tradeDetails.total_trade_cost || 0)}\n              </Typography>\n              <Typography variant=\"body2\">\n                Already Financed:{\" \"}\n                {formatCurrency(tradeDetails.total_financing_allocated || 0)}\n              </Typography>\n              <Typography variant=\"body2\" fontWeight={600}>\n                Remaining:{\" \"}\n                {formatCurrency(\n                  (tradeDetails.total_trade_cost || 0) -\n                    (tradeDetails.total_financing_allocated || 0)\n                )}\n              </Typography>\n            </Alert>\n          )}\n\n          <Grid container spacing={2}>\n            <Grid item xs={12}>\n              <Autocomplete\n                options={investors}\n                loading={investorLoading}\n                value={\n                  investors.find(\n                    (i) => i.value === formik.values.investor_account_id\n                  ) || null\n                }\n                onChange={(_, newValue) => {\n                  formik.setFieldValue(\"investor_account_id\", newValue?.value || \"\");\n                }}\n                onInputChange={(_, value) => {\n                  if (value) loadInvestors(value);\n                }}\n                renderInput={(params) => (\n                  <TextField\n                    {...params}\n                    label=\"Investor Account *\"\n                    error={\n                      formik.touched.investor_account_id &&\n                      Boolean(formik.errors.investor_account_id)\n                    }\n                    helperText={\n                      formik.touched.investor_account_id &&\n                      formik.errors.investor_account_id\n                    }\n                  />\n                )}\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                type=\"number\"\n                label=\"Allocated Amount *\"\n                name=\"allocated_amount\"\n                value={formik.values.allocated_amount}\n                onChange={formik.handleChange}\n                error={\n                  formik.touched.allocated_amount &&\n                  Boolean(formik.errors.allocated_amount)\n                }\n                helperText={\n                  formik.touched.allocated_amount && formik.errors.allocated_amount\n                }\n                InputProps={{\n                  startAdornment: \"UGX\",\n                }}\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                multiline\n                rows={3}\n                label=\"Notes\"\n                name=\"notes\"\n                value={formik.values.notes}\n                onChange={formik.handleChange}\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} disabled={loading}>\n            Cancel\n          </Button>\n          <Button type=\"submit\" variant=\"contained\" disabled={loading}>\n            {loading ? <CircularProgress size={24} /> : \"Allocate\"}\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n\nexport default TradeFinancingForm;","// src/pages/Trade/components/TradeLoanForm.tsx\nimport React, { FC, useState, useEffect } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n  Grid,\n  CircularProgress,\n  Autocomplete,\n  Alert,\n  Typography,\n} from \"@mui/material\";\nimport { useFormik } from \"formik\";\nimport * as Yup from \"yup\";\nimport { toast } from \"react-hot-toast\";\nimport { TradeService } from \"../Trade.service\";\n\ninterface TradeLoanFormProps {\n  open: boolean;\n  onClose: () => void;\n  tradeId: string;\n  onSuccess: () => void;\n}\n\nconst validationSchema = Yup.object({\n  investor_account_id: Yup.string().required(\"Investor account is required\"),\n  amount: Yup.number().required(\"Amount is required\").min(0, \"Must be positive\"),\n  interest_rate: Yup.number()\n    .required(\"Interest rate is required\")\n    .min(0, \"Must be positive\")\n    .max(100, \"Cannot exceed 100%\"),\n  due_date: Yup.date().required(\"Due date is required\"),\n  notes: Yup.string(),\n});\n\nconst TradeLoanForm: FC<TradeLoanFormProps> = ({\n  open,\n  onClose,\n  tradeId,\n  onSuccess,\n}) => {\n  const [loading, setLoading] = useState(false);\n  const [investors, setInvestors] = useState<any[]>([]);\n  const [investorLoading, setInvestorLoading] = useState(false);\n\n  useEffect(() => {\n    if (open) {\n      loadInvestors();\n    }\n  }, [open]);\n\n  const loadInvestors = async (search?: string) => {\n    try {\n      setInvestorLoading(true);\n      const data = await TradeService.getInvestorAccounts(search);\n      setInvestors(\n        data.results.map((inv: any) => ({\n          label: `${inv.investor_name} - Available: ${formatCurrency(\n            inv.available_balance\n          )}`,\n          value: inv.id,\n          available_balance: inv.available_balance,\n        }))\n      );\n    } catch (error) {\n      console.error(\"Failed to load investors:\", error);\n    } finally {\n      setInvestorLoading(false);\n    }\n  };\n\n  const formik = useFormik({\n    initialValues: {\n      investor_account_id: \"\",\n      amount: \"\",\n      interest_rate: \"\",\n      due_date: \"\",\n      notes: \"\",\n    },\n    validationSchema,\n    onSubmit: async (values) => {\n      try {\n        setLoading(true);\n        const payload = {\n          ...values,\n          trade: tradeId,\n        };\n\n        await TradeService.createLoan(payload);\n        toast.success(\"Loan created successfully\");\n\n        onSuccess();\n        onClose();\n        formik.resetForm();\n      } catch (error: any) {\n        toast.error(\n          error?.response?.data?.amount?.[0] ||\n            error?.response?.data?.error ||\n            \"Failed to create loan\"\n        );\n      } finally {\n        setLoading(false);\n      }\n    },\n  });\n\n  const handleClose = () => {\n    if (!loading) {\n      formik.resetForm();\n      onClose();\n    }\n  };\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat(\"en-UG\", {\n      style: \"currency\",\n      currency: \"UGX\",\n      minimumFractionDigits: 0,\n    }).format(value);\n  };\n\n  // Calculate interest preview\n  const calculateInterest = () => {\n    const amount = parseFloat(formik.values.amount as any) || 0;\n    const rate = parseFloat(formik.values.interest_rate as any) || 0;\n    const dueDate = new Date(formik.values.due_date);\n    const today = new Date();\n    const days = Math.max(\n      0,\n      Math.ceil((dueDate.getTime() - today.getTime()) / (1000 * 60 * 60 * 24))\n    );\n\n    const interest = (amount * (rate / 100) * days) / 365;\n    return { interest, total: amount + interest, days };\n  };\n\n  const interestCalc = calculateInterest();\n\n  return (\n    <Dialog open={open} onClose={handleClose} maxWidth=\"sm\" fullWidth>\n      <DialogTitle>Create Trade Loan</DialogTitle>\n      <form onSubmit={formik.handleSubmit}>\n        <DialogContent>\n          <Grid container spacing={2}>\n            <Grid item xs={12}>\n              <Autocomplete\n                options={investors}\n                loading={investorLoading}\n                value={\n                  investors.find(\n                    (i) => i.value === formik.values.investor_account_id\n                  ) || null\n                }\n                onChange={(_, newValue) => {\n                  formik.setFieldValue(\"investor_account_id\", newValue?.value || \"\");\n                }}\n                onInputChange={(_, value) => {\n                  if (value) loadInvestors(value);\n                }}\n                renderInput={(params) => (\n                  <TextField\n                    {...params}\n                    label=\"Investor Account *\"\n                    error={\n                      formik.touched.investor_account_id &&\n                      Boolean(formik.errors.investor_account_id)\n                    }\n                    helperText={\n                      formik.touched.investor_account_id &&\n                      formik.errors.investor_account_id\n                    }\n                  />\n                )}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                type=\"number\"\n                label=\"Loan Amount *\"\n                name=\"amount\"\n                value={formik.values.amount}\n                onChange={formik.handleChange}\n                error={formik.touched.amount && Boolean(formik.errors.amount)}\n                helperText={formik.touched.amount && formik.errors.amount}\n                InputProps={{\n                  startAdornment: \"UGX\",\n                }}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                type=\"number\"\n                label=\"Interest Rate (% p.a.) *\"\n                name=\"interest_rate\"\n                value={formik.values.interest_rate}\n                onChange={formik.handleChange}\n                error={\n                  formik.touched.interest_rate && Boolean(formik.errors.interest_rate)\n                }\n                helperText={\n                  formik.touched.interest_rate && formik.errors.interest_rate\n                }\n                InputProps={{\n                  endAdornment: \"%\",\n                }}\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                type=\"date\"\n                label=\"Due Date *\"\n                name=\"due_date\"\n                value={formik.values.due_date}\n                onChange={formik.handleChange}\n                error={formik.touched.due_date && Boolean(formik.errors.due_date)}\n                helperText={formik.touched.due_date && formik.errors.due_date}\n                InputLabelProps={{ shrink: true }}\n                inputProps={{\n                  min: new Date().toISOString().split(\"T\")[0],\n                }}\n              />\n            </Grid>\n\n            {formik.values.amount && formik.values.interest_rate && formik.values.due_date && (\n              <Grid item xs={12}>\n                <Alert severity=\"info\">\n                  <Typography variant=\"body2\">\n                    Loan Period: {interestCalc.days} days\n                  </Typography>\n                  <Typography variant=\"body2\">\n                    Estimated Interest: {formatCurrency(interestCalc.interest)}\n                  </Typography>\n                  <Typography variant=\"body2\" fontWeight={600}>\n                    Total Due: {formatCurrency(interestCalc.total)}\n                  </Typography>\n                </Alert>\n              </Grid>\n            )}\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                multiline\n                rows={3}\n                label=\"Notes\"\n                name=\"notes\"\n                value={formik.values.notes}\n                onChange={formik.handleChange}\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} disabled={loading}>\n            Cancel\n          </Button>\n          <Button type=\"submit\" variant=\"contained\" disabled={loading}>\n            {loading ? <CircularProgress size={24} /> : \"Create Loan\"}\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n\nexport default TradeLoanForm;","// src/pages/Trade/components/DeliveryProgressCard.tsx\nimport React, { FC } from \"react\";\nimport {\n  Card,\n  CardContent,\n  LinearProgress,\n  Typography,\n  Button,\n  Grid,\n  Box,\n  Stack,\n  Chip,\n} from \"@mui/material\";\nimport {\n  Add as AddIcon,\n  CheckCircle as CheckIcon,\n  LocalShipping as ShippingIcon,\n} from \"@mui/icons-material\";\nimport { formatNumber } from \"../tradeWorkflowHelper\";\n\ninterface DeliverySummary {\n  total_ordered_kg: number;\n  total_delivered_kg: number;\n  remaining_kg: number;\n  completion_percentage: number;\n  is_fully_delivered: boolean;\n  delivery_count: number;\n  can_create_more_deliveries: boolean;\n}\n\ninterface DeliveryProgressCardProps {\n  deliverySummary?: DeliverySummary;\n  onCreateDelivery: () => void;\n}\n\nconst DeliveryProgressCard: FC<DeliveryProgressCardProps> = ({\n  deliverySummary,\n  onCreateDelivery,\n}) => {\n  if (!deliverySummary) return null;\n\n  const {\n    total_ordered_kg,\n    total_delivered_kg,\n    remaining_kg,\n    completion_percentage,\n    is_fully_delivered,\n    delivery_count,\n    can_create_more_deliveries,\n  } = deliverySummary;\n\n  return (\n    <Card\n      sx={{\n        mb: 3,\n        borderRadius: 2,\n        border: 1,\n        borderColor: is_fully_delivered ? \"success.main\" : \"primary.main\",\n        bgcolor: is_fully_delivered ? \"success.50\" : \"primary.50\",\n      }}\n    >\n      <CardContent sx={{ p: 3 }}>\n        <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\" mb={2}>\n          <Box display=\"flex\" alignItems=\"center\" gap={1}>\n            <ShippingIcon color={is_fully_delivered ? \"success\" : \"primary\"} />\n            <Typography variant=\"h6\" fontWeight={700}>\n              Delivery Progress\n            </Typography>\n          </Box>\n          {is_fully_delivered && (\n            <Chip\n              icon={<CheckIcon />}\n              label=\"Fully Delivered\"\n              color=\"success\"\n              sx={{ fontWeight: 600 }}\n            />\n          )}\n        </Stack>\n\n        <Box sx={{ mb: 3 }}>\n          <Stack direction=\"row\" justifyContent=\"space-between\" mb={1}>\n            <Typography variant=\"body2\" color=\"text.secondary\">\n              {formatNumber(total_delivered_kg, 0)} / {formatNumber(total_ordered_kg, 0)} kg\n              delivered\n            </Typography>\n            <Typography variant=\"body2\" fontWeight={700} color=\"primary.main\">\n              {completion_percentage.toFixed(1)}%\n            </Typography>\n          </Stack>\n          <LinearProgress\n            variant=\"determinate\"\n            value={completion_percentage}\n            sx={{\n              height: 12,\n              borderRadius: 2,\n              backgroundColor: \"grey.200\",\n              \"& .MuiLinearProgress-bar\": {\n                borderRadius: 2,\n                background: is_fully_delivered\n                  ? \"linear-gradient(90deg, #4CAF50 0%, #66BB6A 100%)\"\n                  : \"linear-gradient(90deg, #2196F3 0%, #42A5F5 100%)\",\n              },\n            }}\n          />\n        </Box>\n\n        <Grid container spacing={2}>\n          <Grid item xs={6} sm={3}>\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              Total Ordered\n            </Typography>\n            <Typography variant=\"h6\" fontWeight={600}>\n              {formatNumber(total_ordered_kg, 0)} kg\n            </Typography>\n          </Grid>\n          <Grid item xs={6} sm={3}>\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              Delivered\n            </Typography>\n            <Typography variant=\"h6\" fontWeight={600} color=\"success.main\">\n              {formatNumber(total_delivered_kg, 0)} kg\n            </Typography>\n          </Grid>\n          <Grid item xs={6} sm={3}>\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              Remaining\n            </Typography>\n            <Typography variant=\"h6\" fontWeight={600} color=\"error.main\">\n              {formatNumber(remaining_kg, 0)} kg\n            </Typography>\n          </Grid>\n          <Grid item xs={6} sm={3}>\n            <Typography variant=\"caption\" color=\"text.secondary\">\n              Delivery Batches\n            </Typography>\n            <Typography variant=\"h6\" fontWeight={600}>\n              {delivery_count}\n            </Typography>\n          </Grid>\n        </Grid>\n\n        {can_create_more_deliveries && !is_fully_delivered && (\n          <Button\n            fullWidth\n            variant=\"contained\"\n            startIcon={<AddIcon />}\n            onClick={onCreateDelivery}\n            sx={{ mt: 3 }}\n            size=\"large\"\n          >\n            Create New Delivery Batch\n          </Button>\n        )}\n\n        {is_fully_delivered && (\n          <Box\n            sx={{\n              mt: 3,\n              p: 2,\n              bgcolor: \"success.100\",\n              borderRadius: 2,\n              textAlign: \"center\",\n            }}\n          >\n            <Typography variant=\"body2\" color=\"success.dark\" fontWeight={600}>\n               All deliveries completed successfully!\n            </Typography>\n          </Box>\n        )}\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default DeliveryProgressCard;","// src/pages/Trade/components/GRNListWithInvoices.tsx\nimport React, { FC } from \"react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Paper,\n  Chip,\n  Typography,\n  Box,\n  IconButton,\n  Tooltip,\n  Stack,\n} from \"@mui/material\";\nimport {\n  Visibility as ViewIcon,\n  Payment as PaymentIcon,\n  Receipt as ReceiptIcon,\n} from \"@mui/icons-material\";\nimport { IGRN } from \"../Trade.interface\";\nimport {\n  formatCurrency,\n  formatDate,\n  getPaymentStatusColor,\n} from \"../tradeWorkflowHelper\";\n\ninterface GRNListWithInvoicesProps {\n  grns: IGRN[];\n  onViewGRN?: (grn: IGRN) => void;\n  onRecordPayment?: (invoiceId: string) => void;\n}\n\nconst GRNListWithInvoices: FC<GRNListWithInvoicesProps> = ({\n  grns,\n  onViewGRN,\n  onRecordPayment,\n}) => {\n  if (!grns || grns.length === 0) {\n    return (\n      <Paper sx={{ p: 8, textAlign: \"center\", bgcolor: \"grey.50\", borderRadius: 2 }}>\n        <Typography color=\"text.secondary\">\n          No delivery batches created yet. Create your first delivery to generate an invoice.\n        </Typography>\n      </Paper>\n    );\n  }\n\n  return (\n    <TableContainer component={Paper} sx={{ borderRadius: 2, mt: 3 }}>\n      <Table>\n        <TableHead>\n          <TableRow sx={{ bgcolor: \"grey.100\" }}>\n            <TableCell>Delivery #</TableCell>\n            <TableCell>GRN #</TableCell>\n            <TableCell>Delivery Date</TableCell>\n            <TableCell align=\"right\">Quantity (kg)</TableCell>\n            <TableCell>Vehicle</TableCell>\n            <TableCell>Driver</TableCell>\n            <TableCell>Invoice #</TableCell>\n            <TableCell align=\"right\">Invoice Amount</TableCell>\n            <TableCell>Payment Status</TableCell>\n            <TableCell align=\"center\">Actions</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {grns.map((grn, index) => (\n            <TableRow key={grn.id} hover>\n              <TableCell>\n                <Chip\n                  label={`#${index + 1}`}\n                  size=\"small\"\n                  color=\"primary\"\n                  sx={{ fontWeight: 600 }}\n                />\n              </TableCell>\n              <TableCell>\n                <Typography variant=\"body2\" fontWeight={600}>\n                  {grn.grn_number}\n                </Typography>\n              </TableCell>\n              <TableCell>{formatDate(grn.delivery_date)}</TableCell>\n              <TableCell align=\"right\">\n                <Typography variant=\"body2\" fontWeight={600}>\n                  {grn.net_weight_kg.toLocaleString()}\n                </Typography>\n              </TableCell>\n              <TableCell>\n                <Typography variant=\"body2\">{grn.vehicle_number}</Typography>\n              </TableCell>\n              <TableCell>\n                <Typography variant=\"body2\">{grn.driver_name}</Typography>\n              </TableCell>\n              <TableCell>\n                {grn.invoice ? (\n                  <Box display=\"flex\" alignItems=\"center\" gap={0.5}>\n                    <ReceiptIcon sx={{ fontSize: 16, color: \"primary.main\" }} />\n                    <Typography variant=\"body2\" color=\"primary.main\" fontWeight={600}>\n                      {grn.invoice.invoice_number}\n                    </Typography>\n                  </Box>\n                ) : (\n                  <Chip label=\"Generating...\" size=\"small\" color=\"warning\" />\n                )}\n              </TableCell>\n              <TableCell align=\"right\">\n                {grn.invoice ? (\n                  <Typography variant=\"body2\" fontWeight={600}>\n                    {formatCurrency(grn.invoice.total_amount)}\n                  </Typography>\n                ) : (\n                  <Typography variant=\"body2\" color=\"text.secondary\">\n                    -\n                  </Typography>\n                )}\n              </TableCell>\n              <TableCell>\n                {grn.invoice ? (\n                  <Stack spacing={0.5}>\n                    <Chip\n                      label={grn.invoice.payment_status?.toUpperCase()}\n                      size=\"small\"\n                      color={getPaymentStatusColor(grn.invoice.payment_status)}\n                      sx={{ fontWeight: 600 }}\n                    />\n                    {grn.invoice.amount_due > 0 && (\n                      <Typography variant=\"caption\" color=\"error.main\" fontWeight={500}>\n                        Due: {formatCurrency(grn.invoice.amount_due)}\n                      </Typography>\n                    )}\n                    {grn.invoice.days_overdue && grn.invoice.days_overdue > 0 && (\n                      <Typography variant=\"caption\" color=\"error.main\" fontWeight={600}>\n                        {grn.invoice.days_overdue} days overdue\n                      </Typography>\n                    )}\n                  </Stack>\n                ) : (\n                  <Typography variant=\"caption\" color=\"text.secondary\">\n                    Pending\n                  </Typography>\n                )}\n              </TableCell>\n              <TableCell align=\"center\">\n                <Stack direction=\"row\" spacing={0.5} justifyContent=\"center\">\n                  <Tooltip title=\"View GRN Details\">\n                    <IconButton\n                      size=\"small\"\n                      onClick={() => onViewGRN && onViewGRN(grn)}\n                      color=\"primary\"\n                    >\n                      <ViewIcon fontSize=\"small\" />\n                    </IconButton>\n                  </Tooltip>\n                  {grn.invoice && grn.invoice.amount_due > 0 && (\n                    <Tooltip title=\"Record Payment\">\n                      <IconButton\n                        size=\"small\"\n                        color=\"success\"\n                        onClick={() =>\n                          onRecordPayment && grn.invoice && onRecordPayment(grn.invoice.id)\n                        }\n                      >\n                        <PaymentIcon fontSize=\"small\" />\n                      </IconButton>\n                    </Tooltip>\n                  )}\n                </Stack>\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </TableContainer>\n  );\n};\n\nexport default GRNListWithInvoices;","// src/pages/Trade/components/DeliveryBatchForm.tsx\nimport React, { FC, useState, useEffect } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n  Grid,\n  CircularProgress,\n  Typography,\n  Divider,\n  Alert,\n  Box,\n} from \"@mui/material\";\nimport { useFormik } from \"formik\";\nimport * as Yup from \"yup\";\nimport { toast } from \"react-hot-toast\";\nimport { TradeService } from \"../Trade.service\";\nimport { formatNumber } from \"../tradeWorkflowHelper\";\n\ninterface DeliveryBatchFormProps {\n  open: boolean;\n  onClose: () => void;\n  tradeId: string;\n  tradeNumber: string;\n  remainingQuantityKg?: number;\n  onSuccess: () => void;\n}\n\nconst validationSchema = Yup.object({\n  net_weight_kg: Yup.number()\n    .required(\"Net weight is required\")\n    .min(1, \"Must be greater than 0\")\n    .test(\"max-remaining\", \"Cannot exceed remaining quantity\", function (value) {\n      const { remainingQuantity } = this.options.context as any;\n      return !value || !remainingQuantity || value <= remainingQuantity;\n    }),\n  point_of_loading: Yup.string().required(\"Point of loading is required\"),\n  loading_date: Yup.date().required(\"Loading date is required\"),\n  delivery_date: Yup.date()\n    .required(\"Delivery date is required\")\n    .min(Yup.ref(\"loading_date\"), \"Delivery date must be after loading date\"),\n  delivered_to_name: Yup.string().required(\"Delivered to name is required\"),\n  delivered_to_address: Yup.string().required(\"Delivery address is required\"),\n  delivered_to_contact: Yup.string().required(\"Contact is required\"),\n  vehicle_number: Yup.string().required(\"Vehicle number is required\"),\n  driver_name: Yup.string().required(\"Driver name is required\"),\n  driver_id_number: Yup.string().required(\"Driver ID is required\"),\n  driver_phone: Yup.string().required(\"Driver phone is required\"),\n  gross_weight_kg: Yup.number()\n    .required(\"Gross weight is required\")\n    .min(0, \"Must be positive\"),\n  tare_weight_kg: Yup.number().min(0, \"Must be positive\"),\n  warehouse_manager_name: Yup.string().required(\"Warehouse manager name is required\"),\n  warehouse_manager_date: Yup.date().required(\"Manager date is required\"),\n  received_by_name: Yup.string().required(\"Received by name is required\"),\n  received_by_date: Yup.date().required(\"Received date is required\"),\n});\n\nconst DeliveryBatchForm: FC<DeliveryBatchFormProps> = ({\n  open,\n  onClose,\n  tradeId,\n  tradeNumber,\n  remainingQuantityKg,\n  onSuccess,\n}) => {\n  const [loading, setLoading] = useState(false);\n\n  const formik = useFormik({\n    initialValues: {\n      net_weight_kg: remainingQuantityKg || \"\",\n      point_of_loading: \"\",\n      loading_date: \"\",\n      delivery_date: \"\",\n      delivered_to_name: \"\",\n      delivered_to_address: \"\",\n      delivered_to_contact: \"\",\n      vehicle_number: \"\",\n      driver_name: \"\",\n      driver_id_number: \"\",\n      driver_phone: \"\",\n      quantity_bags: \"\",\n      gross_weight_kg: \"\",\n      tare_weight_kg: \"\",\n      warehouse_manager_name: \"\",\n      warehouse_manager_date: \"\",\n      received_by_name: \"\",\n      received_by_date: \"\",\n      remarks: \"\",\n    },\n    validationSchema,\n    validateOnChange: true,\n    validateOnBlur: true,\n    onSubmit: async (values) => {\n      try {\n        setLoading(true);\n        const response = await TradeService.createDeliveryBatch(tradeId, values as any);\n        \n        toast.success(\n          `Delivery batch created! Invoice ${response.invoice?.invoice_number || \"\"} generated.`\n        );\n\n        onSuccess();\n        onClose();\n        formik.resetForm();\n      } catch (error: any) {\n        const errorMsg =\n          error?.response?.data?.error ||\n          error?.response?.data?.net_weight_kg?.[0] ||\n          \"Failed to create delivery batch\";\n        toast.error(errorMsg);\n      } finally {\n        setLoading(false);\n      }\n    },\n  });\n\n  // Auto-calculate net weight\n  useEffect(() => {\n    const gross = parseFloat(formik.values.gross_weight_kg as any) || 0;\n    const tare = parseFloat(formik.values.tare_weight_kg as any) || 0;\n    if (gross > 0 && tare >= 0) {\n      formik.setFieldValue(\"net_weight_kg\", gross - tare);\n    }\n  }, [formik.values.gross_weight_kg, formik.values.tare_weight_kg]);\n\n  const handleClose = () => {\n    if (!loading) {\n      formik.resetForm();\n      onClose();\n    }\n  };\n\n  return (\n    <Dialog open={open} onClose={handleClose} maxWidth=\"md\" fullWidth>\n      <DialogTitle>\n        <Box>\n          <Typography variant=\"h6\">Create Delivery Batch</Typography>\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            {tradeNumber}\n          </Typography>\n        </Box>\n      </DialogTitle>\n      <form onSubmit={formik.handleSubmit}>\n        <DialogContent>\n          {remainingQuantityKg && remainingQuantityKg > 0 && (\n            <Alert severity=\"info\" sx={{ mb: 3 }}>\n              <Typography variant=\"body2\">\n                <strong>Remaining to deliver:</strong> {formatNumber(remainingQuantityKg, 0)} kg\n              </Typography>\n              <Typography variant=\"caption\" display=\"block\" color=\"text.secondary\">\n                This delivery will automatically generate an invoice\n              </Typography>\n            </Alert>\n          )}\n\n          <Grid container spacing={2}>\n            {/* Loading Details */}\n            <Grid item xs={12}>\n              <Typography variant=\"subtitle2\" fontWeight={600} gutterBottom sx={{ mt: 1 }}>\n                Loading Details\n              </Typography>\n              <Divider sx={{ mb: 2 }} />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                label=\"Point of Loading *\"\n                name=\"point_of_loading\"\n                value={formik.values.point_of_loading}\n                onChange={formik.handleChange}\n                error={formik.touched.point_of_loading && Boolean(formik.errors.point_of_loading)}\n                helperText={formik.touched.point_of_loading && formik.errors.point_of_loading}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                type=\"date\"\n                label=\"Loading Date *\"\n                name=\"loading_date\"\n                value={formik.values.loading_date}\n                onChange={formik.handleChange}\n                error={formik.touched.loading_date && Boolean(formik.errors.loading_date)}\n                helperText={formik.touched.loading_date && formik.errors.loading_date}\n                InputLabelProps={{ shrink: true }}\n              />\n            </Grid>\n\n            {/* Delivery Details */}\n            <Grid item xs={12}>\n              <Typography variant=\"subtitle2\" fontWeight={600} gutterBottom sx={{ mt: 2 }}>\n                Delivery Details\n              </Typography>\n              <Divider sx={{ mb: 2 }} />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                type=\"date\"\n                label=\"Delivery Date *\"\n                name=\"delivery_date\"\n                value={formik.values.delivery_date}\n                onChange={formik.handleChange}\n                error={formik.touched.delivery_date && Boolean(formik.errors.delivery_date)}\n                helperText={formik.touched.delivery_date && formik.errors.delivery_date}\n                InputLabelProps={{ shrink: true }}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                label=\"Delivered To Name *\"\n                name=\"delivered_to_name\"\n                value={formik.values.delivered_to_name}\n                onChange={formik.handleChange}\n                error={formik.touched.delivered_to_name && Boolean(formik.errors.delivered_to_name)}\n                helperText={formik.touched.delivered_to_name && formik.errors.delivered_to_name}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                multiline\n                rows={2}\n                label=\"Delivery Address *\"\n                name=\"delivered_to_address\"\n                value={formik.values.delivered_to_address}\n                onChange={formik.handleChange}\n                error={\n                  formik.touched.delivered_to_address && Boolean(formik.errors.delivered_to_address)\n                }\n                helperText={formik.touched.delivered_to_address && formik.errors.delivered_to_address}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                label=\"Contact Number *\"\n                name=\"delivered_to_contact\"\n                value={formik.values.delivered_to_contact}\n                onChange={formik.handleChange}\n                error={\n                  formik.touched.delivered_to_contact && Boolean(formik.errors.delivered_to_contact)\n                }\n                helperText={formik.touched.delivered_to_contact && formik.errors.delivered_to_contact}\n              />\n            </Grid>\n\n            {/* Vehicle & Driver */}\n            <Grid item xs={12}>\n              <Typography variant=\"subtitle2\" fontWeight={600} gutterBottom sx={{ mt: 2 }}>\n                Vehicle & Driver Information\n              </Typography>\n              <Divider sx={{ mb: 2 }} />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                label=\"Vehicle Number *\"\n                name=\"vehicle_number\"\n                value={formik.values.vehicle_number}\n                onChange={formik.handleChange}\n                error={formik.touched.vehicle_number && Boolean(formik.errors.vehicle_number)}\n                helperText={formik.touched.vehicle_number && formik.errors.vehicle_number}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                label=\"Driver Name *\"\n                name=\"driver_name\"\n                value={formik.values.driver_name}\n                onChange={formik.handleChange}\n                error={formik.touched.driver_name && Boolean(formik.errors.driver_name)}\n                helperText={formik.touched.driver_name && formik.errors.driver_name}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                label=\"Driver ID Number *\"\n                name=\"driver_id_number\"\n                value={formik.values.driver_id_number}\n                onChange={formik.handleChange}\n                error={formik.touched.driver_id_number && Boolean(formik.errors.driver_id_number)}\n                helperText={formik.touched.driver_id_number && formik.errors.driver_id_number}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                label=\"Driver Phone *\"\n                name=\"driver_phone\"\n                value={formik.values.driver_phone}\n                onChange={formik.handleChange}\n                error={formik.touched.driver_phone && Boolean(formik.errors.driver_phone)}\n                helperText={formik.touched.driver_phone && formik.errors.driver_phone}\n              />\n            </Grid>\n\n            {/* Weight Details */}\n            <Grid item xs={12}>\n              <Typography variant=\"subtitle2\" fontWeight={600} gutterBottom sx={{ mt: 2 }}>\n                Weight Details\n              </Typography>\n              <Divider sx={{ mb: 2 }} />\n            </Grid>\n\n            <Grid item xs={12} sm={4}>\n              <TextField\n                fullWidth\n                type=\"number\"\n                label=\"Quantity (Bags)\"\n                name=\"quantity_bags\"\n                value={formik.values.quantity_bags}\n                onChange={formik.handleChange}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={4}>\n              <TextField\n                fullWidth\n                type=\"number\"\n                label=\"Gross Weight (kg) *\"\n                name=\"gross_weight_kg\"\n                value={formik.values.gross_weight_kg}\n                onChange={formik.handleChange}\n                error={formik.touched.gross_weight_kg && Boolean(formik.errors.gross_weight_kg)}\n                helperText={formik.touched.gross_weight_kg && formik.errors.gross_weight_kg}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={4}>\n              <TextField\n                fullWidth\n                type=\"number\"\n                label=\"Tare Weight (kg)\"\n                name=\"tare_weight_kg\"\n                value={formik.values.tare_weight_kg}\n                onChange={formik.handleChange}\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                type=\"number\"\n                label=\"Net Weight (kg) *\"\n                name=\"net_weight_kg\"\n                value={formik.values.net_weight_kg}\n                onChange={formik.handleChange}\n                error={formik.touched.net_weight_kg && Boolean(formik.errors.net_weight_kg)}\n                helperText={formik.touched.net_weight_kg && formik.errors.net_weight_kg}\n                InputProps={{\n                  readOnly: true,\n                }}\n              />\n            </Grid>\n\n            {/* Sign-off Details */}\n            <Grid item xs={12}>\n              <Typography variant=\"subtitle2\" fontWeight={600} gutterBottom sx={{ mt: 2 }}>\n                Sign-off Details\n              </Typography>\n              <Divider sx={{ mb: 2 }} />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                label=\"Warehouse Manager Name *\"\n                name=\"warehouse_manager_name\"\n                value={formik.values.warehouse_manager_name}\n                onChange={formik.handleChange}\n                error={\n                  formik.touched.warehouse_manager_name &&\n                  Boolean(formik.errors.warehouse_manager_name)\n                }\n                helperText={\n                  formik.touched.warehouse_manager_name && formik.errors.warehouse_manager_name\n                }\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                type=\"date\"\n                label=\"Manager Sign Date *\"\n                name=\"warehouse_manager_date\"\n                value={formik.values.warehouse_manager_date}\n                onChange={formik.handleChange}\n                error={\n                  formik.touched.warehouse_manager_date &&\n                  Boolean(formik.errors.warehouse_manager_date)\n                }\n                helperText={\n                  formik.touched.warehouse_manager_date && formik.errors.warehouse_manager_date\n                }\n                InputLabelProps={{ shrink: true }}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                label=\"Received By Name *\"\n                name=\"received_by_name\"\n                value={formik.values.received_by_name}\n                onChange={formik.handleChange}\n                error={formik.touched.received_by_name && Boolean(formik.errors.received_by_name)}\n                helperText={formik.touched.received_by_name && formik.errors.received_by_name}\n              />\n            </Grid>\n\n            <Grid item xs={12} sm={6}>\n              <TextField\n                fullWidth\n                type=\"date\"\n                label=\"Received Date *\"\n                name=\"received_by_date\"\n                value={formik.values.received_by_date}\n                onChange={formik.handleChange}\n                error={formik.touched.received_by_date && Boolean(formik.errors.received_by_date)}\n                helperText={formik.touched.received_by_date && formik.errors.received_by_date}\n                InputLabelProps={{ shrink: true }}\n              />\n            </Grid>\n\n            <Grid item xs={12}>\n              <TextField\n                fullWidth\n                multiline\n                rows={3}\n                label=\"Remarks\"\n                name=\"remarks\"\n                value={formik.values.remarks}\n                onChange={formik.handleChange}\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n        <DialogActions sx={{ px: 3, pb: 3 }}>\n          <Button onClick={handleClose} disabled={loading}>\n            Cancel\n          </Button>\n          <Button type=\"submit\" variant=\"contained\" disabled={loading} size=\"large\">\n            {loading ? <CircularProgress size={24} /> : \"Create Delivery & Generate Invoice\"}\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  );\n};\n\nexport default DeliveryBatchForm;","// src/pages/Trade/components/VoucherAllocationDialog.tsx - NEW\nimport React, { FC, useState, useEffect } from \"react\";\nimport {\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  Typography,\n  Box,\n  Radio,\n  RadioGroup,\n  FormControlLabel,\n  FormControl,\n  FormLabel,\n  CircularProgress,\n  Alert,\n  Chip,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Paper,\n  Checkbox,\n  Stack,\n} from \"@mui/material\";\nimport { toast } from \"react-hot-toast\";\nimport instance from \"../../../api\";\n\ninterface VoucherAllocationDialogProps {\n  open: boolean;\n  onClose: () => void;\n  tradeId: string;\n  tradeNumber: string;\n  requiredQuantityKg: number;\n  grainTypeId?: string;\n  hubId?: string;\n  onSuccess: (payload: any) => void;\n}\n\ninterface Voucher {\n  id: string;\n  voucher_number: string;\n  farmer_name: string;\n  quantity_kg: number;\n  status: string;\n  grain_type_name: string;\n}\n\nconst VoucherAllocationDialog: FC<VoucherAllocationDialogProps> = ({\n  open,\n  onClose,\n  tradeId,\n  tradeNumber,\n  requiredQuantityKg,\n  grainTypeId,\n  hubId,\n  onSuccess,\n}) => {\n  const [allocationType, setAllocationType] = useState<\"auto\" | \"manual\">(\"auto\");\n  const [loading, setLoading] = useState(false);\n  const [availableVouchers, setAvailableVouchers] = useState<Voucher[]>([]);\n  const [selectedVouchers, setSelectedVouchers] = useState<string[]>([]);\n  const [loadingVouchers, setLoadingVouchers] = useState(false);\n\n  useEffect(() => {\n    if (open && allocationType === \"manual\") {\n      fetchAvailableVouchers();\n    }\n  }, [open, allocationType, grainTypeId, hubId]);\n\n  const fetchAvailableVouchers = async () => {\n    try {\n      setLoadingVouchers(true);\n      const params: any = {\n        status: \"pending_allocation\",\n        page_size: 100,\n      };\n\n      if (grainTypeId) params.grain_type = grainTypeId;\n      if (hubId) params.hub = hubId;\n\n      const response = await instance.get(\"vouchers/\", { params });\n      setAvailableVouchers(response.data.results || []);\n    } catch (error) {\n      console.error(\"Failed to load vouchers:\", error);\n      toast.error(\"Failed to load available vouchers\");\n    } finally {\n      setLoadingVouchers(false);\n    }\n  };\n\n  const handleVoucherToggle = (voucherId: string) => {\n    setSelectedVouchers((prev) =>\n      prev.includes(voucherId)\n        ? prev.filter((id) => id !== voucherId)\n        : [...prev, voucherId]\n    );\n  };\n\n  const getSelectedQuantity = () => {\n    return selectedVouchers.reduce((sum, id) => {\n      const voucher = availableVouchers.find((v) => v.id === id);\n      return sum + (voucher?.quantity_kg || 0);\n    }, 0);\n  };\n\n  const handleAllocate = async () => {\n    const payload: any = {\n      allocation_type: allocationType,\n    };\n\n    if (allocationType === \"manual\") {\n      if (selectedVouchers.length === 0) {\n        toast.error(\"Please select at least one voucher\");\n        return;\n      }\n\n      const selectedQty = getSelectedQuantity();\n      if (selectedQty < requiredQuantityKg) {\n        toast.error(\n          `Selected quantity (${selectedQty.toLocaleString()} kg) is less than required (${requiredQuantityKg.toLocaleString()} kg)`\n        );\n        return;\n      }\n\n      payload.voucher_ids = selectedVouchers;\n    }\n\n    setLoading(true);\n    onSuccess(payload);\n  };\n\n  const selectedQty = getSelectedQuantity();\n  const isQuantitySufficient = selectedQty >= requiredQuantityKg;\n\n  return (\n    <Dialog open={open} onClose={onClose} maxWidth=\"md\" fullWidth>\n      <DialogTitle>\n        <Box>\n          <Typography variant=\"h6\">Allocate Vouchers to Trade</Typography>\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            {tradeNumber}\n          </Typography>\n        </Box>\n      </DialogTitle>\n\n      <DialogContent>\n        <Alert severity=\"info\" sx={{ mb: 3 }}>\n          <Typography variant=\"body2\" fontWeight={600}>\n            Required Quantity: {requiredQuantityKg.toLocaleString()} kg\n          </Typography>\n          {allocationType === \"manual\" && selectedVouchers.length > 0 && (\n            <Typography variant=\"body2\" sx={{ mt: 1 }}>\n              Selected Quantity: {selectedQty.toLocaleString()} kg\n            </Typography>\n          )}\n        </Alert>\n\n        <FormControl component=\"fieldset\" sx={{ mb: 3 }}>\n          <FormLabel component=\"legend\">Allocation Method</FormLabel>\n          <RadioGroup\n            value={allocationType}\n            onChange={(e) => setAllocationType(e.target.value as \"auto\" | \"manual\")}\n          >\n            <FormControlLabel\n              value=\"auto\"\n              control={<Radio />}\n              label={\n                <Box>\n                  <Typography variant=\"body2\" fontWeight={600}>\n                    Automatic Allocation\n                  </Typography>\n                  <Typography variant=\"caption\" color=\"text.secondary\">\n                    System will automatically select vouchers from available inventory\n                  </Typography>\n                </Box>\n              }\n            />\n            <FormControlLabel\n              value=\"manual\"\n              control={<Radio />}\n              label={\n                <Box>\n                  <Typography variant=\"body2\" fontWeight={600}>\n                    Manual Selection\n                  </Typography>\n                  <Typography variant=\"caption\" color=\"text.secondary\">\n                    Manually select specific vouchers to allocate\n                  </Typography>\n                </Box>\n              }\n            />\n          </RadioGroup>\n        </FormControl>\n\n        {allocationType === \"manual\" && (\n          <>\n            {loadingVouchers ? (\n              <Box display=\"flex\" justifyContent=\"center\" py={4}>\n                <CircularProgress />\n              </Box>\n            ) : availableVouchers.length === 0 ? (\n              <Alert severity=\"warning\">\n                <Typography variant=\"body2\">\n                  No vouchers available for allocation. Check that vouchers exist with status\n                  'pending_allocation' for this grain type and hub.\n                </Typography>\n              </Alert>\n            ) : (\n              <>\n                <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\" mb={2}>\n                  <Typography variant=\"subtitle2\">\n                    Available Vouchers ({availableVouchers.length})\n                  </Typography>\n                  {selectedVouchers.length > 0 && (\n                    <Chip\n                      label={`${selectedVouchers.length} selected`}\n                      color={isQuantitySufficient ? \"success\" : \"warning\"}\n                      size=\"small\"\n                    />\n                  )}\n                </Stack>\n\n                <TableContainer component={Paper} sx={{ maxHeight: 400 }}>\n                  <Table stickyHeader size=\"small\">\n                    <TableHead>\n                      <TableRow>\n                        <TableCell padding=\"checkbox\"></TableCell>\n                        <TableCell>Voucher #</TableCell>\n                        <TableCell>Farmer</TableCell>\n                        <TableCell>Grain Type</TableCell>\n                        <TableCell align=\"right\">Quantity (kg)</TableCell>\n                      </TableRow>\n                    </TableHead>\n                    <TableBody>\n                      {availableVouchers.map((voucher) => (\n                        <TableRow\n                          key={voucher.id}\n                          hover\n                          selected={selectedVouchers.includes(voucher.id)}\n                          onClick={() => handleVoucherToggle(voucher.id)}\n                          sx={{ cursor: \"pointer\" }}\n                        >\n                          <TableCell padding=\"checkbox\">\n                            <Checkbox\n                              checked={selectedVouchers.includes(voucher.id)}\n                              onChange={() => handleVoucherToggle(voucher.id)}\n                            />\n                          </TableCell>\n                          <TableCell>\n                            <Typography variant=\"body2\" fontWeight={600}>\n                              {voucher.voucher_number}\n                            </Typography>\n                          </TableCell>\n                          <TableCell>\n                            <Typography variant=\"body2\">{voucher.farmer_name}</Typography>\n                          </TableCell>\n                          <TableCell>\n                            <Typography variant=\"body2\">{voucher.grain_type_name}</Typography>\n                          </TableCell>\n                          <TableCell align=\"right\">\n                            <Typography variant=\"body2\" fontWeight={600}>\n                              {voucher.quantity_kg.toLocaleString()}\n                            </Typography>\n                          </TableCell>\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n                </TableContainer>\n\n                {!isQuantitySufficient && selectedVouchers.length > 0 && (\n                  <Alert severity=\"warning\" sx={{ mt: 2 }}>\n                    <Typography variant=\"body2\">\n                      Selected quantity ({selectedQty.toLocaleString()} kg) is less than required (\n                      {requiredQuantityKg.toLocaleString()} kg). Please select more vouchers.\n                    </Typography>\n                  </Alert>\n                )}\n              </>\n            )}\n          </>\n        )}\n      </DialogContent>\n\n      <DialogActions sx={{ px: 3, pb: 3 }}>\n        <Button onClick={onClose} disabled={loading}>\n          Cancel\n        </Button>\n        <Button\n          onClick={handleAllocate}\n          variant=\"contained\"\n          disabled={\n            loading ||\n            (allocationType === \"manual\" &&\n              (selectedVouchers.length === 0 || !isQuantitySufficient))\n          }\n        >\n          {loading ? <CircularProgress size={24} /> : \"Allocate Vouchers\"}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default VoucherAllocationDialog;","// src/pages/Trade/TradeDetails.tsx - FIXED VERSION with proper GRN/allocation visibility\nimport React, { useEffect, useState } from \"react\";\nimport { useParams, useNavigate, useLocation } from \"react-router-dom\";\nimport {\n  Box,\n  Card,\n  CardContent,\n  Grid,\n  Typography,\n  Button,\n  Chip,\n  Paper,\n  Tabs,\n  Tab,\n  Stack,\n  IconButton,\n  Tooltip,\n  useMediaQuery,\n  useTheme,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Alert,\n} from \"@mui/material\";\nimport {\n  Add as AddIcon,\n  ArrowBack as ArrowBackIcon,\n  Edit as EditIcon,\n  LocalShipping as LocalShippingIcon,\n  Delete as DeleteIcon,\n  AssignmentTurnedIn as AllocateIcon,\n} from \"@mui/icons-material\";\nimport { toast } from \"react-hot-toast\";\nimport { TradeService } from \"./Trade.service\";\nimport { ITrade } from \"./Trade.interface\";\nimport TradeStatusStepper from \"./TradeStatusStepper\";\nimport CostBreakdown from \"./components/CostBreakdown\";\nimport TradeCostForm from \"./components/TradeCostForm\";\nimport TradeBrokerageForm from \"./components/TradeBrokerageForm\";\nimport TradeFinancingForm from \"./components/TradeFinancingForm\";\nimport TradeLoanForm from \"./components/TradeLoanForm\";\nimport GRNForm from \"./components/GRNForm\";\nimport useTitle from \"../../hooks/useTitle\";\nimport ProgressIndicator from \"../../components/UI/ProgressIndicator\";\nimport TradeForm from \"./TradeForm\";\nimport DeliveryProgressCard from \"./components/DeliveryProgressCard\";\nimport GRNListWithInvoices from \"./components/GRNListWithInvoices\";\nimport DeliveryBatchForm from \"./components/DeliveryBatchForm\";\nimport VoucherAllocationDialog from \"./components/VoucherAllocationDialog\";\nimport { canCreateDelivery, getNextActionMessage } from \"./tradeWorkflowHelper\";\n\ninterface TabPanelProps {\n  children?: React.ReactNode;\n  index: number;\n  value: number;\n}\n\nfunction TabPanel(props: TabPanelProps) {\n  const { children, value, index, ...other } = props;\n  return (\n    <div hidden={value !== index} {...other}>\n      {value === index && <Box>{children}</Box>}\n    </div>\n  );\n}\n\nconst TradeDetails = () => {\n  const { tradeId } = useParams<{ tradeId: string }>();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down(\"md\"));\n\n  const [trade, setTrade] = useState<ITrade | null>(null);\n  const [loading, setLoading] = useState(true);\n  \n  //  FIX: Get initial tab from URL query param\n  const getInitialTab = () => {\n    const params = new URLSearchParams(location.search);\n    const tab = params.get('tab');\n    if (tab === 'delivery') return 7; // GRN/Delivery tab\n    if (tab === 'vouchers') return 8; // New voucher allocation tab\n    return 0;\n  };\n  \n  const [tabValue, setTabValue] = useState(getInitialTab());\n\n  const [openDeliveryForm, setOpenDeliveryForm] = useState(false);\n  const [deliveryProgress, setDeliveryProgress] = useState<any>(null);\n\n  // Modal states\n  const [openCostForm, setOpenCostForm] = useState(false);\n  const [openBrokerageForm, setOpenBrokerageForm] = useState(false);\n  const [openFinancingForm, setOpenFinancingForm] = useState(false);\n  const [openLoanForm, setOpenLoanForm] = useState(false);\n  const [openGRNForm, setOpenGRNForm] = useState(false);\n  const [openVoucherAllocation, setOpenVoucherAllocation] = useState(false); //  NEW\n\n  // Edit states\n  const [editingCost, setEditingCost] = useState<any>(null);\n  const [editingBrokerage, setEditingBrokerage] = useState<any>(null);\n  const [openEditForm, setOpenEditForm] = useState(false);\n\n  useTitle(trade ? `Trade ${trade.trade_number}` : \"Trade Details\");\n\n  useEffect(() => {\n    if (tradeId) fetchTradeDetails();\n  }, [tradeId]);\n\n  const fetchTradeDetails = async () => {\n    try {\n      setLoading(true);\n      const data = await TradeService.getTradeDetails(tradeId!);\n      setTrade(data);\n    } catch (error: any) {\n      toast.error(error?.response?.data?.error || \"Failed to load trade\");\n      navigate(\"/admin/trade\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchDeliveryProgress = async () => {\n    try {\n      const data = await TradeService.getDeliveryProgress(tradeId!);\n      setDeliveryProgress(data);\n    } catch (error) {\n      console.error(\"Failed to load delivery progress:\", error);\n    }\n  };\n  \n  useEffect(() => {\n    if (tradeId && trade && ['ready_for_delivery', 'in_transit', 'delivered'].includes(trade.status)) {\n      fetchDeliveryProgress();\n    }\n  }, [tradeId, trade?.status]);\n\n  const handleProgressStatus = async () => {\n    try {\n      await TradeService.progressStatus(tradeId!, { notes: \"Progressed from details page\" });\n      toast.success(\"Status progressed successfully\");\n      fetchTradeDetails();\n    } catch (error: any) {\n      toast.error(error?.response?.data?.error || \"Failed to progress status\");\n    }\n  };\n\n  //  NEW: Voucher allocation handler\n  const handleAllocateVouchers = async (payload: any) => {\n    try {\n      await TradeService.allocateVouchers(tradeId!, payload);\n      toast.success(\"Vouchers allocated successfully\");\n      fetchTradeDetails();\n      setOpenVoucherAllocation(false);\n    } catch (error: any) {\n      toast.error(error?.response?.data?.error || \"Failed to allocate vouchers\");\n    }\n  };\n\n  const handleDeleteCost = async (costId: string) => {\n    if (window.confirm(\"Are you sure you want to delete this cost?\")) {\n      try {\n        await TradeService.deleteTradeCost(costId);\n        toast.success(\"Cost deleted successfully\");\n        fetchTradeDetails();\n      } catch (error: any) {\n        toast.error(\"Failed to delete cost\");\n      }\n    }\n  };\n\n  const handleDeleteBrokerage = async (brokerageId: string) => {\n    if (window.confirm(\"Are you sure you want to delete this brokerage?\")) {\n      try {\n        await TradeService.deleteBrokerage(brokerageId);\n        toast.success(\"Brokerage deleted successfully\");\n        fetchTradeDetails();\n      } catch (error: any) {\n        toast.error(\"Failed to delete brokerage\");\n      }\n    }\n  };\n\n  const formatCurrency = (value: number) =>\n    new Intl.NumberFormat(\"en-UG\", {\n      style: \"currency\",\n      currency: \"UGX\",\n      minimumFractionDigits: 0,\n    }).format(value);\n\n  if (loading) {\n    return (\n      <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" minHeight=\"70vh\">\n        <ProgressIndicator />\n      </Box>\n    );\n  }\n\n  if (!trade) {\n    return (\n      <Box p={3}>\n        <Typography>Trade not found</Typography>\n      </Box>\n    );\n  }\n\n  //  CRITICAL: Determine what actions are available\n  const showVoucherAllocation = trade.requires_voucher_allocation && !trade.allocation_complete;\n  const showDeliveryCreation = canCreateDelivery(trade);\n\n  return (\n    <Box sx={{ p: { xs: 2, sm: 3, md: 4 }, maxWidth: \"lg\", mx: \"auto\" }}>\n      {/* Header */}\n      <Stack\n        direction={{ xs: \"column\", sm: \"row\" }}\n        justifyContent=\"space-between\"\n        alignItems={{ xs: \"stretch\", sm: \"center\" }}\n        spacing={2}\n        mb={4}\n      >\n        <Stack direction=\"row\" alignItems=\"center\" spacing={2}>\n          <Button\n            startIcon={<ArrowBackIcon />}\n            onClick={() => navigate(\"/admin/trade\")}\n            variant=\"outlined\"\n            size={isMobile ? \"small\" : \"medium\"}\n          >\n            Back\n          </Button>\n          <Box>\n            <Typography variant={isMobile ? \"h5\" : \"h4\"} fontWeight={700}>\n              {trade.trade_number}\n            </Typography>\n            <Typography variant=\"body2\" color=\"text.secondary\">\n              Created {new Date(trade.created_at).toLocaleDateString()}\n            </Typography>\n          </Box>\n        </Stack>\n\n        <Stack direction=\"row\" spacing={1} flexWrap=\"wrap\" gap={1}>\n          <Chip label={trade.status_display} color=\"primary\" />\n          \n          {/*  CRITICAL: Show voucher allocation button when needed */}\n          {showVoucherAllocation && (\n            <Button\n              variant=\"outlined\"\n              color=\"warning\"\n              startIcon={<AllocateIcon />}\n              onClick={() => setOpenVoucherAllocation(true)}\n              size=\"small\"\n            >\n              Allocate Vouchers\n            </Button>\n          )}\n          \n          {trade.status === \"draft\" && (\n            <Tooltip title=\"Edit Trade\">\n              <IconButton onClick={() => setOpenEditForm(true)} color=\"primary\">\n                <EditIcon />\n              </IconButton>\n            </Tooltip>\n          )}\n          \n          {trade.status !== \"completed\" && trade.status !== \"cancelled\" && (\n            <Button\n              variant=\"contained\"\n              startIcon={<LocalShippingIcon />}\n              onClick={handleProgressStatus}\n              size=\"small\"\n            >\n              Progress\n            </Button>\n          )}\n        </Stack>\n      </Stack>\n\n      {/*  Show warning if blocking issues exist */}\n      {(showVoucherAllocation || (trade.requires_financing && !trade.financing_complete)) && (\n        <Alert severity=\"warning\" sx={{ mb: 3 }}>\n          <Typography variant=\"subtitle2\" fontWeight={600}>\n            Action Required:\n          </Typography>\n          <ul style={{ margin: \"8px 0\", paddingLeft: 20 }}>\n            {showVoucherAllocation && (\n              <li>\n                <Typography variant=\"body2\">\n                  Allocate vouchers before progressing to delivery\n                </Typography>\n              </li>\n            )}\n            {trade.requires_financing && !trade.financing_complete && (\n              <li>\n                <Typography variant=\"body2\">\n                  Complete investor financing allocation\n                </Typography>\n              </li>\n            )}\n          </ul>\n        </Alert>\n      )}\n\n      {/* Stepper */}\n      <Card sx={{ mb: 4, borderRadius: 2, overflow: \"hidden\" }}>\n        <CardContent sx={{ py: 5 }}>\n          <TradeStatusStepper currentStatus={trade.status} />\n        </CardContent>\n      </Card>\n\n      {/* Tabs + Content */}\n      <Paper elevation={3} sx={{ borderRadius: 2, overflow: \"hidden\" }}>\n        <Tabs\n          value={tabValue}\n          onChange={(_, v) => setTabValue(v)}\n          variant={isMobile ? \"scrollable\" : \"standard\"}\n          scrollButtons=\"auto\"\n          sx={{\n            borderBottom: 1,\n            borderColor: \"divider\",\n            px: { xs: 2, sm: 3 },\n            pt: 1,\n          }}\n        >\n          <Tab label=\"Overview\" />\n          <Tab label=\"Cost Breakdown\" />\n          <Tab label=\"Costs\" />\n          <Tab label=\"Brokerages\" />\n          <Tab label=\"Financing\" />\n          <Tab label=\"Loans\" />\n          <Tab label=\"Invoices\" />\n          <Tab label=\"Delivery & GRN\" />\n          {trade.requires_voucher_allocation && <Tab label=\"Voucher Allocation\" />}\n        </Tabs>\n\n        <Box sx={{ p: { xs: 2, sm: 3, md: 4 } }}>\n          {/* Overview Tab */}\n          <TabPanel value={tabValue} index={0}>\n            {/* ... existing overview content ... */}\n            <Grid container spacing={4}>\n              <Grid item xs={12} md={6}>\n                <Typography variant=\"h6\" gutterBottom fontWeight={600}>\n                  Parties\n                </Typography>\n                <Grid container spacing={2}>\n                  {[\n                    { label: \"Buyer\", value: trade.buyer?.name },\n                    { label: \"Supplier\", value: `${trade.supplier?.first_name} ${trade.supplier?.last_name}` },\n                    { label: \"Hub\", value: trade.hub?.name },\n                    { label: \"Grain & Grade\", value: `${trade.grain_type?.name}  ${trade.quality_grade?.name}` },\n                  ].map((item) => (\n                    <Grid item xs={12} sm={6} key={item.label}>\n                      <Typography variant=\"body2\" color=\"text.secondary\">\n                        {item.label}\n                      </Typography>\n                      <Typography variant=\"body1\" fontWeight={600}>\n                        {item.value || \"N/A\"}\n                      </Typography>\n                    </Grid>\n                  ))}\n                </Grid>\n              </Grid>\n              {/* ... rest of overview ... */}\n              <Grid item xs={12} md={6}>\n                <Typography variant=\"h6\" gutterBottom fontWeight={600}>\n                  Quantities\n                </Typography>\n                <Grid container spacing={2}>\n                  {[\n                    { label: \"Gross Tonnage\", value: `${(trade.gross_tonnage / 1000).toFixed(2)} MT` },\n                    { label: \"Net Tonnage\", value: `${(trade.net_tonnage / 1000).toFixed(2)} MT` },\n                    { label: \"Quantity (kg)\", value: trade.quantity_kg.toLocaleString() + \" kg\" },\n                    { label: \"Bags\", value: trade.quantity_bags || \"N/A\" },\n                  ].map((item) => (\n                    <Grid item xs={12} sm={6} key={item.label}>\n                      <Typography variant=\"body2\" color=\"text.secondary\">\n                        {item.label}\n                      </Typography>\n                      <Typography variant=\"body1\" fontWeight={600}>\n                        {item.value}\n                      </Typography>\n                    </Grid>\n                  ))}\n                </Grid>\n              </Grid>\n\n              <Grid item xs={12}>\n                <Typography variant=\"h6\" gutterBottom fontWeight={600}>\n                  Financial Summary\n                </Typography>\n                <Grid container spacing={2}>\n                  {[\n                    { label: \"Buying Price\", value: `${formatCurrency(trade.buying_price)}/kg`, color: \"error.main\" },\n                    { label: \"Selling Price\", value: `${formatCurrency(trade.selling_price)}/kg`, color: \"success.main\" },\n                    { label: \"Total Cost\", value: formatCurrency(trade.total_trade_cost) },\n                    { label: \"Revenue\", value: formatCurrency(trade.payable_by_buyer) },\n                    { label: \"Margin\", value: formatCurrency(trade.margin), bold: true, color: \"primary.main\" },\n                    { label: \"ROI\", value: `${trade.roi_percentage.toFixed(2)}%`, bold: true, color: \"success.main\" },\n                  ].map((item) => (\n                    <Grid item xs={6} sm={4} md={2} key={item.label}>\n                      <Paper sx={{ p: 2, bgcolor: \"background.default\", borderRadius: 2, height: \"100%\" }}>\n                        <Typography variant=\"body2\" color=\"text.secondary\" gutterBottom>\n                          {item.label}\n                        </Typography>\n                        <Typography variant=\"h6\" fontWeight={item.bold ? 700 : 600} color={item.color}>\n                          {item.value}\n                        </Typography>\n                      </Paper>\n                    </Grid>\n                  ))}\n                </Grid>\n              </Grid>\n\n              {trade.loss_summary?.has_loss && (\n                <Grid item xs={12}>\n                  <Alert severity=\"warning\" sx={{ mt: 2 }}>\n                    <Typography variant=\"subtitle2\" fontWeight={600}>Loss Detected</Typography>\n                    <Typography>Quantity Lost: {trade.loss_summary.quantity_kg.toFixed(2)} kg ({trade.loss_summary.percentage.toFixed(2)}%)</Typography>\n                    <Typography>Cost of Loss: {formatCurrency(trade.loss_summary.cost)}</Typography>\n                    {trade.loss_summary.reason && <Typography>Reason: {trade.loss_summary.reason}</Typography>}\n                  </Alert>\n                </Grid>\n              )}\n\n            </Grid>\n          </TabPanel>\n\n          {/* Other existing tabs 1-6 remain the same */}\n          <TabPanel value={tabValue} index={1}>\n            <CostBreakdown tradeId={trade.id} />\n          </TabPanel>\n\n          {/* ... Costs, Brokerages, Financing, Loans, Invoices tabs ... */}\n\n          {/*  FIXED: Delivery & GRN Tab - Tab Index 7 */}\n          {/* Costs */}\n          <TabPanel value={tabValue} index={2}>\n            <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\" mb={3}>\n              <Typography variant=\"h6\">Additional Costs</Typography>\n              <Button variant=\"contained\" startIcon={<AddIcon />} onClick={() => { setEditingCost(null); setOpenCostForm(true); }}>\n                Add Cost\n              </Button>\n            </Stack>\n\n            {trade.additional_costs && trade.additional_costs.length > 0 ? (\n              <TableContainer component={Paper} sx={{ border: 1, borderColor: \"divider\" }}>\n                <Table>\n                  <TableHead>\n                    <TableRow>\n                      <TableCell>Cost Type</TableCell>\n                      <TableCell>Description</TableCell>\n                      <TableCell align=\"right\">Amount</TableCell>\n                      <TableCell align=\"center\">Per Unit</TableCell>\n                      <TableCell align=\"right\">Total</TableCell>\n                      <TableCell align=\"center\">Actions</TableCell>\n                    </TableRow>\n                  </TableHead>\n                  <TableBody>\n                    {trade.additional_costs.map((cost: any) => (\n                      <TableRow key={cost.id}>\n                        <TableCell>{cost.cost_type}</TableCell>\n                        <TableCell>{cost.description || \"-\"}</TableCell>\n                        <TableCell align=\"right\">{formatCurrency(cost.amount)}</TableCell>\n                        <TableCell align=\"center\">{cost.is_per_unit ? \"Yes\" : \"No\"}</TableCell>\n                        <TableCell align=\"right\">{formatCurrency(cost.total_amount || cost.amount)}</TableCell>\n                        <TableCell align=\"center\">\n                          <IconButton size=\"small\" onClick={() => { setEditingCost(cost); setOpenCostForm(true); }}>\n                            <EditIcon fontSize=\"small\" />\n                          </IconButton>\n                          <IconButton size=\"small\" color=\"error\" onClick={() => handleDeleteCost(cost.id)}>\n                            <DeleteIcon fontSize=\"small\" />\n                          </IconButton>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </TableContainer>\n            ) : (\n              <Paper sx={{ p: 8, textAlign: \"center\", bgcolor: \"grey.50\", borderRadius: 2 }}>\n                <Typography color=\"text.secondary\">No additional costs added yet</Typography>\n              </Paper>\n            )}\n          </TabPanel>\n\n          {/* Brokerages */}\n          <TabPanel value={tabValue} index={3}>\n            <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\" mb={3}>\n              <Typography variant=\"h6\">Brokerages</Typography>\n              <Button variant=\"contained\" startIcon={<AddIcon />} onClick={() => { setEditingBrokerage(null); setOpenBrokerageForm(true); }}>\n                Add Brokerage\n              </Button>\n            </Stack>\n\n            {trade.brokerages && trade.brokerages.length > 0 ? (\n              <TableContainer component={Paper} sx={{ border: 1, borderColor: \"divider\" }}>\n                <Table>\n                  <TableHead>\n                    <TableRow>\n                      <TableCell>Agent</TableCell>\n                      <TableCell>Type</TableCell>\n                      <TableCell align=\"right\">Commission Value</TableCell>\n                      <TableCell align=\"right\">Amount</TableCell>\n                      <TableCell>Notes</TableCell>\n                      <TableCell align=\"center\">Actions</TableCell>\n                    </TableRow>\n                  </TableHead>\n                  <TableBody>\n                    {trade.brokerages.map((brokerage: any) => (\n                      <TableRow key={brokerage.id}>\n                        <TableCell>{brokerage.agent ? `${brokerage.agent.first_name} ${brokerage.agent.last_name}` : \"N/A\"}</TableCell>\n                        <TableCell>{brokerage.commission_type}</TableCell>\n                        <TableCell align=\"right\">{brokerage.commission_value}</TableCell>\n                        <TableCell align=\"right\">{formatCurrency(brokerage.amount)}</TableCell>\n                        <TableCell>{brokerage.notes || \"-\"}</TableCell>\n                        <TableCell align=\"center\">\n                          <IconButton size=\"small\" onClick={() => { setEditingBrokerage(brokerage); setOpenBrokerageForm(true); }}>\n                            <EditIcon fontSize=\"small\" />\n                          </IconButton>\n                          <IconButton size=\"small\" color=\"error\" onClick={() => handleDeleteBrokerage(brokerage.id)}>\n                            <DeleteIcon fontSize=\"small\" />\n                          </IconButton>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </TableContainer>\n            ) : (\n              <Paper sx={{ p: 8, textAlign: \"center\", bgcolor: \"grey.50\", borderRadius: 2 }}>\n                <Typography color=\"text.secondary\">No brokerages added</Typography>\n              </Paper>\n            )}\n          </TabPanel>\n\n          {/* Financing */}\n          <TabPanel value={tabValue} index={4}>\n            <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\" mb={3}>\n              <Box>\n                <Typography variant=\"h6\">Investor Financing</Typography>\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  Total Allocated: {formatCurrency(trade.total_financing_allocated || 0)}\n                </Typography>\n              </Box>\n              {trade.requires_financing && !trade.financing_complete && (\n                <Button variant=\"contained\" startIcon={<AddIcon />} onClick={() => setOpenFinancingForm(true)}>\n                  Add Financing\n                </Button>\n              )}\n            </Stack>\n            {/* Table or empty state - same pattern */}\n            {trade.financing_allocations && trade.financing_allocations.length > 0 ? (\n              <TableContainer component={Paper} sx={{ border: 1, borderColor: \"divider\" }}>\n                <Table>\n                  <TableHead>\n                    <TableRow>\n                      <TableCell>Investor</TableCell>\n                      <TableCell align=\"right\">Amount</TableCell>\n                      <TableCell align=\"right\">Percentage</TableCell>\n                      <TableCell align=\"right\">Margin Earned</TableCell>\n                      <TableCell align=\"right\">Investor Share</TableCell>\n                      <TableCell>Date</TableCell>\n                    </TableRow>\n                  </TableHead>\n                  <TableBody>\n                    {trade.financing_allocations.map((fin: any) => (\n                      <TableRow key={fin.id}>\n                        <TableCell>{fin.investor ? `${fin.investor.first_name} ${fin.investor.last_name}` : \"N/A\"}</TableCell>\n                        <TableCell align=\"right\">{formatCurrency(fin.allocated_amount)}</TableCell>\n                        <TableCell align=\"right\">{fin.allocation_percentage.toFixed(2)}%</TableCell>\n                        <TableCell align=\"right\">{formatCurrency(fin.margin_earned)}</TableCell>\n                        <TableCell align=\"right\">{formatCurrency(fin.investor_margin)}</TableCell>\n                        <TableCell>{new Date(fin.allocation_date).toLocaleDateString()}</TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </TableContainer>\n            ) : (\n              <Paper sx={{ p: 8, textAlign: \"center\", bgcolor: \"grey.50\", borderRadius: 2 }}>\n                <Typography color=\"text.secondary\">\n                  {trade.requires_financing ? \"No financing allocated yet\" : \"This trade does not require investor financing\"}\n                </Typography>\n              </Paper>\n            )}\n          </TabPanel>\n\n          {/* Loans */}\n          <TabPanel value={tabValue} index={5}>\n            <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\" mb={3}>\n              <Box>\n                <Typography variant=\"h6\">Trade Loans</Typography>\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  Total Loans: {formatCurrency(trade.total_loans || 0)}\n                </Typography>\n              </Box>\n              <Button variant=\"contained\" startIcon={<AddIcon />} onClick={() => setOpenLoanForm(true)}>\n                Add Loan\n              </Button>\n            </Stack>\n            {trade.loans && trade.loans.length > 0 ? (\n              <TableContainer component={Paper} sx={{ border: 1, borderColor: \"divider\" }}>\n                <Table>\n                  <TableHead>\n                    <TableRow>\n                      <TableCell>Investor</TableCell>\n                      <TableCell align=\"right\">Amount</TableCell>\n                      <TableCell align=\"right\">Interest Rate</TableCell>\n                      <TableCell>Due Date</TableCell>\n                      <TableCell align=\"right\">Total Due</TableCell>\n                      <TableCell align=\"right\">Outstanding</TableCell>\n                      <TableCell>Status</TableCell>\n                    </TableRow>\n                  </TableHead>\n                  <TableBody>\n                    {trade.loans.map((loan: any) => (\n                      <TableRow key={loan.id}>\n                        <TableCell>{loan.investor ? `${loan.investor.first_name} ${loan.investor.last_name}` : \"N/A\"}</TableCell>\n                        <TableCell align=\"right\">{formatCurrency(loan.amount)}</TableCell>\n                        <TableCell align=\"right\">{loan.interest_rate}%</TableCell>\n                        <TableCell>{new Date(loan.due_date).toLocaleDateString()}</TableCell>\n                        <TableCell align=\"right\">{formatCurrency(loan.total_due || 0)}</TableCell>\n                        <TableCell align=\"right\">{formatCurrency(loan.outstanding_balance || 0)}</TableCell>\n                        <TableCell>\n                          <Chip label={loan.status} size=\"small\" color={loan.status === \"repaid\" ? \"success\" : loan.status === \"active\" ? \"primary\" : \"default\"} />\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </TableContainer>\n            ) : (\n              <Paper sx={{ p: 8, textAlign: \"center\", bgcolor: \"grey.50\", borderRadius: 2 }}>\n                <Typography color=\"text.secondary\">No loans for this trade</Typography>\n              </Paper>\n            )}\n          </TabPanel>\n\n          {/* Invoices */}\n          <TabPanel value={tabValue} index={6}>\n            {trade.invoices_list && trade.invoices_list.length > 0 ? (\n              <Grid container spacing={3}>\n                {trade.invoices_list.map((inv) => (\n                  <Grid item xs={12} md={6} key={inv.id}>\n                    <Paper sx={{ p: 3, height: \"100%\" }}>\n                      <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"flex-start\">\n                        <Box>\n                          <Typography variant=\"subtitle1\" fontWeight={600}>{inv.invoice_number}</Typography>\n                          {inv.grn_number && <Typography variant=\"body2\" color=\"text.secondary\">GRN: {inv.grn_number}</Typography>}\n                          <Typography variant=\"body2\">Amount: {formatCurrency(inv.total_amount)}</Typography>\n                          <Typography variant=\"body2\" color=\"error.main\">Due: {formatCurrency(inv.amount_due)}</Typography>\n                        </Box>\n                        <Chip label={inv.status} size=\"small\" />\n                      </Stack>\n                    </Paper>\n                  </Grid>\n                ))}\n              </Grid>\n            ) : (\n              <Paper sx={{ p: 8, textAlign: \"center\", bgcolor: \"grey.50\", borderRadius: 2 }}>\n                <Typography color=\"text.secondary\" gutterBottom>No invoices generated yet</Typography>\n                {trade.status === \"delivered\" && (\n                  <Typography variant=\"body2\" color=\"text.secondary\">\n                    Create a GRN to automatically generate an invoice\n                  </Typography>\n                )}\n              </Paper>\n            )}\n          </TabPanel>\n\n          {/* GRN */}\n          {/* <TabPanel value={tabValue} index={7}>\n            <Stack direction=\"row\" justifyContent=\"space-between\" alignItems=\"center\" mb={3}>\n              <Typography variant=\"h6\">Goods Received Note</Typography>\n              {trade.status === \"in_transit\" && !trade.grn && (\n                <Button variant=\"contained\" startIcon={<AddIcon />} onClick={() => setOpenGRNForm(true)}>\n                  Create GRN\n                </Button>\n              )}\n            </Stack>\n\n            {trade.grn ? (\n              <Paper sx={{ p: 4 }}>\n                <Typography>GRN details will be displayed here</Typography>\n              </Paper>\n            ) : (\n              <Paper sx={{ p: 8, textAlign: \"center\", bgcolor: \"grey.50\", borderRadius: 2 }}>\n                <Typography color=\"text.secondary\">\n                  {trade.status === \"in_transit\"\n                    ? \"No GRN created yet - Click 'Create GRN' to generate\"\n                    : \"GRN can only be created when trade is in transit\"}\n                </Typography>\n              </Paper>\n            )}\n          </TabPanel> */}\n          <TabPanel value={tabValue} index={7}>\n            <Typography variant=\"h6\" fontWeight={600} mb={3}>\n              Delivery Management\n            </Typography>\n\n            {/*  Show based on trade status */}\n            {['ready_for_delivery', 'in_transit', 'delivered', 'completed'].includes(trade.status) ? (\n              <>\n                {/* Delivery Progress Card */}\n                {deliveryProgress?.delivery_summary && (\n                  <DeliveryProgressCard\n                    deliverySummary={deliveryProgress.delivery_summary}\n                    onCreateDelivery={() => setOpenDeliveryForm(true)}\n                  />\n                )}\n\n                {/* Next Steps Alert */}\n                {deliveryProgress?.next_steps && deliveryProgress.next_steps.length > 0 && (\n                  <Alert severity=\"info\" sx={{ mb: 3 }}>\n                    <Typography variant=\"subtitle2\" fontWeight={600} gutterBottom>\n                      Next Steps:\n                    </Typography>\n                    <ul style={{ margin: 0, paddingLeft: 20 }}>\n                      {deliveryProgress.next_steps.map((step: string, idx: number) => (\n                        <li key={idx}>\n                          <Typography variant=\"body2\">{step}</Typography>\n                        </li>\n                      ))}\n                    </ul>\n                  </Alert>\n                )}\n\n                {/* GRN List with Invoices */}\n                {trade.grns && trade.grns.length > 0 ? (\n                  <GRNListWithInvoices\n                    grns={trade.grns}\n                    onViewGRN={(grn) => console.log(\"View GRN:\", grn)}\n                    onRecordPayment={(invoiceId) => console.log(\"Record payment:\", invoiceId)}\n                  />\n                ) : (\n                  <Paper sx={{ p: 8, textAlign: \"center\", bgcolor: \"grey.50\", borderRadius: 2 }}>\n                    <Typography color=\"text.secondary\" gutterBottom>\n                      No delivery batches created yet\n                    </Typography>\n                    <Typography variant=\"body2\" color=\"text.secondary\">\n                      Click \"Create New Delivery Batch\" above to start deliveries\n                    </Typography>\n                  </Paper>\n                )}\n              </>\n            ) : (\n              <Alert severity=\"info\">\n                <Typography variant=\"body2\">\n                  Delivery management will be available when trade reaches 'ready_for_delivery' status.\n                </Typography>\n                <Typography variant=\"body2\" fontWeight={600} sx={{ mt: 1 }}>\n                  Current status: {trade.status_display}\n                </Typography>\n                <Typography variant=\"caption\" display=\"block\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                  {getNextActionMessage(trade)}\n                </Typography>\n              </Alert>\n            )}\n          </TabPanel>\n\n          {/*  NEW: Voucher Allocation Tab - Tab Index 8 (if required) */}\n          {trade.requires_voucher_allocation && (\n            <TabPanel value={tabValue} index={8}>\n              <Typography variant=\"h6\" fontWeight={600} mb={3}>\n                Voucher Allocation\n              </Typography>\n\n              {trade.allocation_complete ? (\n                <Alert severity=\"success\" sx={{ mb: 3 }}>\n                  <Typography variant=\"body2\" fontWeight={600}>\n                     Vouchers allocated successfully\n                  </Typography>\n                  <Typography variant=\"body2\">\n                    {trade.vouchers_count} voucher(s) allocated for this trade\n                  </Typography>\n                </Alert>\n              ) : (\n                <Alert severity=\"warning\" sx={{ mb: 3 }}>\n                  <Typography variant=\"body2\" fontWeight={600}>\n                    Voucher allocation required\n                  </Typography>\n                  <Typography variant=\"body2\">\n                    This trade requires voucher allocation before delivery can begin.\n                  </Typography>\n                  <Button\n                    variant=\"contained\"\n                    startIcon={<AllocateIcon />}\n                    onClick={() => setOpenVoucherAllocation(true)}\n                    sx={{ mt: 2 }}\n                  >\n                    Allocate Vouchers Now\n                  </Button>\n                </Alert>\n              )}\n\n              {/* Show allocated vouchers if any */}\n              {trade.vouchers_detail && trade.vouchers_detail.length > 0 && (\n                <TableContainer component={Paper} sx={{ mt: 3 }}>\n                  <Table>\n                    <TableHead>\n                      <TableRow>\n                        <TableCell>Voucher Number</TableCell>\n                        <TableCell>Farmer</TableCell>\n                        <TableCell align=\"right\">Quantity (kg)</TableCell>\n                        <TableCell>Status</TableCell>\n                      </TableRow>\n                    </TableHead>\n                    <TableBody>\n                      {trade.vouchers_detail.map((voucher: any) => (\n                        <TableRow key={voucher.id}>\n                          <TableCell>{voucher.voucher_number}</TableCell>\n                          <TableCell>{voucher.farmer_name}</TableCell>\n                          <TableCell align=\"right\">{voucher.quantity_kg?.toLocaleString()}</TableCell>\n                          <TableCell>\n                            <Chip label={voucher.status} size=\"small\" />\n                          </TableCell>\n                        </TableRow>\n                      ))}\n                    </TableBody>\n                  </Table>\n                </TableContainer>\n              )}\n            </TabPanel>\n          )}\n        </Box>\n      </Paper>\n\n      {/* Modals */}\n      <TradeCostForm\n        open={openCostForm}\n        onClose={() => { setOpenCostForm(false); setEditingCost(null); }}\n        tradeId={trade.id}\n        onSuccess={fetchTradeDetails}\n        initialValues={editingCost}\n      />\n      <TradeBrokerageForm\n        open={openBrokerageForm}\n        onClose={() => { setOpenBrokerageForm(false); setEditingBrokerage(null); }}\n        tradeId={trade.id}\n        onSuccess={fetchTradeDetails}\n        initialValues={editingBrokerage}\n      />\n      <TradeFinancingForm\n        open={openFinancingForm}\n        onClose={() => setOpenFinancingForm(false)}\n        tradeId={trade.id}\n        onSuccess={fetchTradeDetails}\n        tradeDetails={trade}\n      />\n      <TradeLoanForm\n        open={openLoanForm}\n        onClose={() => setOpenLoanForm(false)}\n        tradeId={trade.id}\n        onSuccess={fetchTradeDetails}\n      />\n\n      {/*  Delivery Batch Form Dialog */}\n      <DeliveryBatchForm\n        open={openDeliveryForm}\n        onClose={() => setOpenDeliveryForm(false)}\n        tradeId={trade.id}\n        tradeNumber={trade.trade_number}\n        remainingQuantityKg={trade.remaining_quantity_kg}\n        onSuccess={() => {\n          fetchTradeDetails();\n          fetchDeliveryProgress();\n        }}\n      />\n\n      {/*  NEW: Voucher Allocation Dialog */}\n      {trade.requires_voucher_allocation && (\n        <VoucherAllocationDialog\n          open={openVoucherAllocation}\n          onClose={() => setOpenVoucherAllocation(false)}\n          tradeId={trade.id}\n          tradeNumber={trade.trade_number}\n          requiredQuantityKg={trade.quantity_kg}\n          grainTypeId={trade.grain_type?.id}\n          hubId={trade.hub?.id}\n          onSuccess={handleAllocateVouchers}\n        />\n      )}\n\n      {/* Edit Trade Form */}\n      {openEditForm && (\n        <TradeForm\n          callBack={fetchTradeDetails}\n          formType=\"Update\"\n          handleClose={() => setOpenEditForm(false)}\n          initialValues={trade}\n        />\n      )}\n    </Box>\n  );\n};\n\nexport default TradeDetails;"],"names":["statusSteps","statusLabels","draft","pending_approval","approved","pending_allocation","ready_for_delivery","in_transit","delivered","completed","optionalStatuses","_ref","currentStatus","_jsx","Box","sx","textAlign","py","children","Chip","label","color","fontSize","px","activeStep","indexOf","width","Stepper","alternativeLabel","map","step","Step","StepLabel","optional","includes","component","undefined","tradeId","breakdown","setBreakdown","useState","loading","setLoading","useEffect","fetchBreakdown","async","data","TradeService","getCostBreakdown","error","console","display","justifyContent","p","ProgressIndicator","Typography","formatCurrency","value","Intl","NumberFormat","style","currency","minimumFractionDigits","format","_jsxs","Grid","container","spacing","item","xs","md","Paper","variant","gutterBottom","Table","size","TableBody","TableRow","TableCell","align","purchase_cost","aflatoxin_qa_cost","weighbridge_cost","offloading_cost","loading_cost","transport_cost","financing_cost","git_insurance_cost","deduction_cost","other_expenses","bennu_to_seller","loss_cost","Divider","my","fontWeight","total_trade_cost","payable_by_buyer","margin","net_profit","brokerage_costs","length","TableHead","brokerage","index","agent","commission_type","commission_value","amount","validationSchema","Yup","cost_type","required","min","description","is_per_unit","costTypes","open","onClose","onSuccess","initialValues","formik","useFormik","enableReinitialize","onSubmit","payload","_objectSpread","values","trade","id","updateTradeCost","toast","success","createTradeCost","resetForm","_error$response","_error$response$data","response","handleClose","Dialog","maxWidth","fullWidth","DialogTitle","handleSubmit","DialogContent","TextField","select","name","onChange","handleChange","touched","Boolean","errors","helperText","type","MenuItem","InputProps","startAdornment","FormControlLabel","control","Checkbox","checked","multiline","rows","DialogActions","Button","onClick","disabled","CircularProgress","agent_id","notes","commissionTypes","agents","setAgents","agentLoading","setAgentLoading","loadAgents","getAgents","search","results","concat","first_name","last_name","updateBrokerage","createBrokerage","Autocomplete","options","find","a","_","newValue","setFieldValue","onInputChange","renderInput","params","placeholder","investor_account_id","allocated_amount","tradeDetails","investors","setInvestors","investorLoading","setInvestorLoading","loadInvestors","getInvestorAccounts","inv","investor_name","available_balance","createFinancingAllocation","_error$response$data$","_error$response2","_error$response2$data","Alert","severity","mb","total_financing_allocated","i","interest_rate","max","due_date","createLoan","interestCalc","calculateInterest","parseFloat","rate","dueDate","Date","today","days","Math","ceil","getTime","interest","total","sm","endAdornment","InputLabelProps","shrink","inputProps","toISOString","split","deliverySummary","onCreateDelivery","total_ordered_kg","total_delivered_kg","remaining_kg","completion_percentage","is_fully_delivered","delivery_count","can_create_more_deliveries","Card","borderRadius","border","borderColor","bgcolor","CardContent","Stack","direction","alignItems","gap","ShippingIcon","icon","CheckIcon","formatNumber","toFixed","LinearProgress","height","backgroundColor","background","startIcon","AddIcon","mt","grns","onViewGRN","onRecordPayment","TableContainer","grn","_grn$invoice$payment_","hover","grn_number","formatDate","delivery_date","net_weight_kg","toLocaleString","vehicle_number","driver_name","invoice","ReceiptIcon","invoice_number","total_amount","payment_status","toUpperCase","getPaymentStatusColor","amount_due","days_overdue","Tooltip","title","IconButton","ViewIcon","PaymentIcon","test","remainingQuantity","this","context","point_of_loading","loading_date","delivered_to_name","delivered_to_address","delivered_to_contact","driver_id_number","driver_phone","gross_weight_kg","tare_weight_kg","warehouse_manager_name","warehouse_manager_date","received_by_name","received_by_date","tradeNumber","remainingQuantityKg","quantity_bags","remarks","validateOnChange","validateOnBlur","_response$invoice","createDeliveryBatch","_error$response2$data2","errorMsg","gross","tare","readOnly","pb","requiredQuantityKg","grainTypeId","hubId","allocationType","setAllocationType","availableVouchers","setAvailableVouchers","selectedVouchers","setSelectedVouchers","loadingVouchers","setLoadingVouchers","fetchAvailableVouchers","status","page_size","grain_type","hub","instance","get","handleVoucherToggle","voucherId","prev","filter","getSelectedQuantity","reduce","sum","voucher","v","quantity_kg","selectedQty","isQuantitySufficient","FormControl","FormLabel","RadioGroup","e","target","Radio","_Fragment","maxHeight","stickyHeader","padding","selected","cursor","voucher_number","farmer_name","grain_type_name","allocation_type","voucher_ids","TabPanel","props","other","_objectWithoutProperties","_excluded","hidden","TradeDetails","_trade$buyer","_trade$supplier","_trade$supplier2","_trade$hub","_trade$grain_type","_trade$quality_grade","_trade$loss_summary","_trade$grain_type2","_trade$hub2","useParams","navigate","useNavigate","location","useLocation","theme","useTheme","isMobile","useMediaQuery","breakpoints","down","setTrade","tabValue","setTabValue","getInitialTab","tab","URLSearchParams","openDeliveryForm","setOpenDeliveryForm","deliveryProgress","setDeliveryProgress","openCostForm","setOpenCostForm","openBrokerageForm","setOpenBrokerageForm","openFinancingForm","setOpenFinancingForm","openLoanForm","setOpenLoanForm","openGRNForm","setOpenGRNForm","openVoucherAllocation","setOpenVoucherAllocation","editingCost","setEditingCost","editingBrokerage","setEditingBrokerage","openEditForm","setOpenEditForm","useTitle","trade_number","fetchTradeDetails","getTradeDetails","fetchDeliveryProgress","getDeliveryProgress","minHeight","showVoucherAllocation","requires_voucher_allocation","allocation_complete","canCreateDelivery","mx","ArrowBackIcon","created_at","toLocaleDateString","flexWrap","status_display","AllocateIcon","EditIcon","LocalShippingIcon","progressStatus","requires_financing","financing_complete","paddingLeft","overflow","TradeStatusStepper","elevation","Tabs","scrollButtons","borderBottom","pt","Tab","buyer","supplier","quality_grade","gross_tonnage","net_tonnage","buying_price","selling_price","bold","roi_percentage","loss_summary","has_loss","percentage","cost","reason","CostBreakdown","additional_costs","window","confirm","deleteTradeCost","costId","handleDeleteCost","DeleteIcon","brokerages","deleteBrokerage","brokerageId","handleDeleteBrokerage","financing_allocations","fin","investor","allocation_percentage","margin_earned","investor_margin","allocation_date","total_loans","loans","loan","total_due","outstanding_balance","invoices_list","delivery_summary","DeliveryProgressCard","next_steps","idx","GRNListWithInvoices","log","invoiceId","getNextActionMessage","vouchers_count","vouchers_detail","_voucher$quantity_kg","TradeCostForm","TradeBrokerageForm","TradeFinancingForm","TradeLoanForm","DeliveryBatchForm","remaining_quantity_kg","VoucherAllocationDialog","allocateVouchers","_error$response3","_error$response3$data","TradeForm","callBack","formType"],"sourceRoot":""}