"use strict";(self.webpackChunkinvest=self.webpackChunkinvest||[]).push([[878],{13194:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(65043),r=a(95926);const n=e=>{const{title:t,setTitle:a}=(0,i.useContext)(r.C);return(0,i.useEffect)(()=>a(e),[e,a]),t}},23722:(e,t,a)=>{a.d(t,{A:()=>l});var i=a(89379),r=(a(65043),a(67024)),n=a(81637),s=a(70579);const l=e=>{let{size:t,color:a="primary",sx:l}=e;return(0,s.jsx)(r.A,{sx:(0,i.A)({color:"grey.500"},l),spacing:2,direction:"row",children:(0,s.jsx)(n.A,{size:t,color:a})})}},46055:(e,t,a)=>{a.d(t,{pU:()=>i});const i=e=>{if(!e)return"N/A";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const a=t.getDate().toString().padStart(2,"0"),i=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getFullYear();return"".concat(a,"/").concat(i,"/").concat(r)}},49250:(e,t,a)=>{a.d(t,{A:()=>s});var i=a(89379),r=a(8122),n=a(70579);const s=e=>(0,n.jsxs)(r.A,(0,i.A)((0,i.A)({viewBox:"0 0 20 20"},e),{},{children:[(0,n.jsx)("path",{d:"M8.80758 0C3.95121 0 0 3.95121 0 8.80758C0 13.6642 3.95121 17.6152 8.80758 17.6152C13.6642 17.6152 17.6152 13.6642 17.6152 8.80758C17.6152 3.95121 13.6642 0 8.80758 0ZM8.80758 15.9892C4.84769 15.9892 1.62602 12.7675 1.62602 8.80762C1.62602 4.84773 4.84769 1.62602 8.80758 1.62602C12.7675 1.62602 15.9891 4.84769 15.9891 8.80758C15.9891 12.7675 12.7675 15.9892 8.80758 15.9892Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M19.7617 18.6124L15.1005 13.9511C14.7829 13.6335 14.2685 13.6335 13.9509 13.9511C13.6332 14.2684 13.6332 14.7834 13.9509 15.1007L18.6121 19.762C18.7709 19.9208 18.9788 20.0002 19.1869 20.0002C19.3948 20.0002 19.6029 19.9208 19.7617 19.762C20.0794 19.4446 20.0794 18.9297 19.7617 18.6124Z",fill:"currentColor"})]}))},61408:(e,t,a)=>{a.d(t,{A:()=>_});var i=a(89379),r=a(14126),n=a(34535),s=a(59135),l=a(26240),o=a(96446),d=a(71806),c=a(84882),u=a(28076),p=a(10039),x=a(73460),m=a(67024),h=a(72949),y=a(65043),v=a(71094),A=a(6905),g=a(42438),b=a(70579);const j=e=>{let{message:t}=e;return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(o.A,{sx:{width:"100%",color:"text.disabled"},children:(0,b.jsx)("p",{className:"font13",style:{fontWeight:500,color:"text.disabled"},children:t})})})};var f=a(32513),k=a(55935);const S=(0,n.Ay)(s.A)(e=>{let{theme:t}=e;return{"& .MuiPaginationItem-root":{fontSize:12,fontWeight:500,color:t.palette.text.disabled},"& .MuiPaginationItem-page:hover":{borderRadius:20,backgroundColor:"transparent",color:t.palette.primary.main,border:"1px solid ".concat(t.palette.primary.main)},"& .MuiPaginationItem-page.Mui-selected":{borderRadius:20,backgroundColor:"transparent",color:t.palette.primary.main,border:"1px solid ".concat(t.palette.primary.main)},"& .MuiPaginationItem-previousNext":{margin:10,borderRadius:20,color:t.palette.primary.main,border:"1px solid ".concat(t.palette.primary.main),"&:hover":{backgroundColor:"transparent"}}}}),_=e=>{const{data:t,rowClick:a,showFooter:n,columnShape:s,hidePagination:_=!1,dataCount:C,pageInitialState:R,setPageIndex:w,pageIndex:T,loading:q}=e,B=(0,l.A)(),I=(0,y.useMemo)(()=>t,[t]),W=(0,y.useMemo)(()=>s,[s]),V=(0,y.useMemo)(()=>R,[R]),{getTableProps:z,getTableBodyProps:D,headerGroups:P,prepareRow:F,page:M,state:{pageSize:E},setPageSize:O}=(0,v.useTable)({columns:W,data:I,initialState:V},v.useSortBy,v.useExpanded,v.usePagination,v.useRowSelect);return(0,y.useEffect)(()=>{O(R.pageSize)},[R,O]),(0,b.jsxs)(o.A,{children:[(0,b.jsx)("div",{className:"table-responsive whiteBg",style:{borderRadius:10,border:"1px solid #eee"},children:(0,b.jsxs)(d.A,(0,i.A)((0,i.A)({},z()),{},{sx:{borderSpacing:"0 0.2rem",borderCollapse:"separate"},children:[(0,b.jsx)(c.A,{children:P.map(e=>(0,b.jsxs)(u.A,(0,i.A)((0,i.A)({},e.getHeaderGroupProps()),{},{children:[(0,b.jsx)(p.A,{sx:{paddingY:1,fontSize:13,width:10},children:"#"}),e.headers.map(e=>(0,b.jsx)(p.A,(0,i.A)((0,i.A)({},e.getHeaderProps(e.getSortByToggleProps())),{},{sx:{paddingY:0,fontSize:13,fontWeight:600,color:"text.black",width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth,"&:last-child":{textAlign:"center"}},children:e.render("Header")})))]})))}),(0,b.jsx)(x.A,(0,i.A)((0,i.A)({},D()),{},{children:q?(0,b.jsx)(u.A,{children:(0,b.jsx)(p.A,{colSpan:W.length+1,sx:{textAlign:"left"},children:(0,b.jsx)(f.a,{})})}):M.length>0?M.map((e,t)=>{var r;return F(e),(0,b.jsxs)(u.A,(0,i.A)((0,i.A)({},e.getRowProps()),{},{onClick:a&&a(e.original),sx:{backgroundColor:null!==(r=e.original)&&void 0!==r&&r.has_error?"pink":1&t?"background.paper":k.j3,borderTop:"1.5px solid ".concat(k.j3),cursor:a?"pointer":"unset","& td:first-of-type":{},"& td:last-of-type":{textAlign:"center"},"&:last-of-type .MuiTableCell-root":{borderBottom:"dark"===B.palette.mode?"1px solid ".concat(B.palette.divider," !important"):"1px solid ".concat(B.palette.text.secondary," !important")},borderSpacing:5},children:[(0,b.jsx)(p.A,{sx:{fontSize:12,fontWeight:500,paddingY:1.2,color:"text.black","&:last-of-type div.css-o3rlxk":{display:"flex",justifyContent:"center"}},children:100*((T||1)-1)+t+1}),e.cells.map(e=>(0,b.jsx)(p.A,(0,i.A)((0,i.A)({},e.getCellProps()),{},{sx:{fontSize:12,fontWeight:500,paddingY:1.2,color:"text.black","&:last-of-type div.css-o3rlxk":{display:"flex",justifyContent:"center"}},children:null===e||void 0===e?void 0:e.render("Cell")})))]}))}):(0,b.jsx)(u.A,{sx:{borderBottomWidth:0,borderColor:"white"},children:(0,b.jsx)(p.A,{colSpan:W.length+1,sx:{textAlign:"center"},children:(0,b.jsx)(j,{message:"No Data Available"})})})}))]}))}),!_&&(0,b.jsx)(m.A,{alignItems:"flex-end",marginY:1,children:(0,b.jsx)(S,{count:Math.ceil(C/E),shape:"rounded",page:T,onChange:(e,t)=>{w(t)}})}),n&&(0,b.jsxs)(A.A,{alignItems:"center",justifyContent:"space-between",children:[(0,b.jsx)(g.H5,{color:"text.disabled",children:"Showing 1-12 of 24 result"}),(0,b.jsxs)(h.A,{disableRipple:!0,sx:{fontSize:14,fontWeight:600},children:["See All",(0,b.jsx)(r.A,{sx:{marginLeft:.5}})]})]})]})}},64093:(e,t,a)=>{a.d(t,{A:()=>d});var i=a(89379),r=a(62559),n=a(34535),s=a(49250),l=a(70579);const o=(0,n.Ay)(r.Ay)(e=>{let{theme:t}=e;return{height:35,fontSize:13,width:"100%",maxWidth:270,fontWeight:500,padding:"0 1rem",borderRadius:"8px",border:"1px solid ",borderColor:"light"===t.palette.mode?t.palette.secondary[300]:t.palette.divider,color:t.palette.text.primary,backgroundColor:t.palette.background.paper,[t.breakpoints.down(500)]:{maxWidth:"100%"}}}),d=e=>(0,l.jsx)(o,(0,i.A)((0,i.A)({},e),{},{sx:(0,i.A)({justifyContent:"initial"},e.sx),startAdornment:(0,l.jsx)(s.A,{sx:{fontSize:13,marginRight:1,color:"#bbb"}})}))},70878:(e,t,a)=>{a.r(t),a.d(t,{default:()=>We});var i=a(89379),r=a(80045),n=a(96446),s=a(85865),l=a(8302),o=a(68903),d=a(12110),c=a(43845),u=a(14912),p=a(24056),x=a(65043),m=a(13194),h=a(8433),y=a(56629);const v={getReportExports:async e=>y.A.get("reports/exports/",{params:e}).then(e=>e.data),getReportExportDetails:async e=>y.A.get("reports/exports/".concat(e,"/")).then(e=>e.data),downloadReport:async e=>y.A.get("reports/exports/".concat(e,"/download/"),{responseType:"blob"}).then(e=>e.data),cleanupExpiredReports:async()=>y.A.get("reports/exports/cleanup_expired/").then(e=>e.data),getReportSchedules:async e=>y.A.get("reports/schedules/",{params:e}).then(e=>e.data),getReportScheduleDetails:async e=>y.A.get("reports/schedules/".concat(e,"/")).then(e=>e.data),createReportSchedule:async e=>y.A.post("reports/schedules/",e).then(e=>e.data),updateReportSchedule:async(e,t)=>y.A.patch("reports/schedules/".concat(e,"/"),t).then(e=>e.data),deleteReportSchedule:async e=>y.A.delete("reports/schedules/".concat(e,"/")).then(e=>e.data),runScheduleNow:async e=>y.A.post("reports/schedules/".concat(e,"/run_now/")).then(e=>e.data),toggleScheduleActive:async e=>y.A.post("reports/schedules/".concat(e,"/toggle_active/")).then(e=>e.data),generateSupplierReport:async e=>y.A.post("reports/generate/supplier/",e).then(e=>e.data),generateTradeReport:async e=>y.A.post("reports/generate/trade/",e).then(e=>e.data),generateInvoiceReport:async e=>y.A.post("reports/generate/invoice/",e).then(e=>e.data),generatePaymentReport:async e=>y.A.post("reports/generate/payment/",e).then(e=>e.data),generateDepositorReport:async e=>y.A.post("reports/generate/depositor/",e).then(e=>e.data),generateVoucherReport:async e=>y.A.post("reports/generate/voucher/",e).then(e=>e.data),generateInventoryReport:async e=>y.A.post("reports/generate/inventory/",e).then(e=>e.data),generateInvestorReport:async e=>y.A.post("reports/generate/investor/",e).then(e=>e.data),getDashboardStats:async()=>y.A.get("reports/dashboard/stats/").then(e=>e.data)};var A=a(28994),g=a(4245),b=a(58094),j=a(77739),f=a(17392),k=a(23768),S=a(41132),_=a(48625),C=a(64093),R=a(61408),w=a(36644),T=a(46055),q=a(42438),B=a(23722),I=a(70579);const W={tablePreHeader:{display:"flex",alignItems:"center",gap:2,marginBottom:2}},V=()=>{const[e,t]=(0,x.useState)(),[a,r]=(0,x.useState)(null),[l,o]=(0,x.useState)(!1),[d,u]=(0,x.useState)("");(0,x.useEffect)(()=>{p(a)},[a]);const p=async e=>{try{o(!0);const a=await v.getReportExports(e);t(a),o(!1)}catch(a){o(!1),console.error("Error fetching exports:",a),k.oR.error("Failed to load report exports")}},m=[{Header:"Report Type",accessor:"report_type_display",minWidth:150,Cell:e=>{let{row:t}=e;const a=t.original;return(0,I.jsxs)(n.A,{children:[(0,I.jsx)(s.A,{variant:"body2",fontWeight:600,children:a.report_type_display}),(0,I.jsx)(s.A,{variant:"caption",color:"text.secondary",children:a.format_display})]})}},{Header:"Status",accessor:"status",minWidth:120,Cell:e=>{let{row:t}=e;return(e=>{const t={pending:{color:"default",label:"Pending"},processing:{color:"info",label:"Processing"},completed:{color:"success",label:"Completed"},failed:{color:"error",label:"Failed"}},a=t[e]||t.pending;return(0,I.jsx)(c.A,{label:a.label,color:a.color,size:"small"})})(t.original.status)}},{Header:"Records",accessor:"record_count",minWidth:100,Cell:e=>{let{row:t}=e;return(0,I.jsx)(c.A,{label:t.original.record_count.toLocaleString(),size:"small",variant:"outlined"})}},{Header:"Requested",accessor:"requested_at",minWidth:150,Cell:e=>{let{row:t}=e;const a=t.original;return(0,I.jsxs)(n.A,{children:[(0,I.jsx)(s.A,{variant:"body2",children:(0,T.pU)(a.requested_at)}),(0,I.jsxs)(s.A,{variant:"caption",color:"text.secondary",children:["by ",a.generated_by.first_name," ",a.generated_by.last_name]})]})}},{Header:"Completed",accessor:"completed_at",minWidth:120,Cell:e=>{let{row:t}=e;const a=t.original;return a.completed_at?(0,I.jsx)(s.A,{variant:"body2",children:(0,T.pU)(a.completed_at)}):(0,I.jsx)(q.L9,{sx:{fontSize:12,color:"text.secondary"},children:"-"})}},{Header:"Expires",accessor:"expires_at",minWidth:120,Cell:e=>{let{row:t}=e;const a=t.original;return(0,I.jsxs)(n.A,{children:[(0,I.jsx)(s.A,{variant:"body2",children:(0,T.pU)(a.expires_at)}),a.is_expired&&(0,I.jsx)(c.A,{label:"Expired",color:"error",size:"small",variant:"outlined"})]})}},{Header:"Action",accessor:"action",minWidth:100,maxWidth:100,Cell:e=>{let{row:t}=e;const a=t.original;return(0,I.jsxs)(n.A,{sx:{display:"flex",gap:1},children:["completed"===a.status&&!a.is_expired&&(0,I.jsx)(j.A,{title:"Download Report",children:(0,I.jsx)(f.A,{size:"small",color:"primary",onClick:()=>(async e=>{try{k.oR.loading("Preparing download...");const t=await v.downloadReport(e.id),a=window.URL.createObjectURL(t),i=document.createElement("a");i.href=a,i.download="".concat(e.report_type,"_report_").concat((0,T.pU)(e.requested_at),".").concat(e.format),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(a),k.oR.dismiss(),k.oR.success("Report downloaded successfully")}catch(t){k.oR.dismiss(),k.oR.error(t.message||"Failed to download report")}})(a),children:(0,I.jsx)(S.A,{fontSize:"small"})})}),"processing"===a.status&&(0,I.jsx)(B.A,{size:20}),"failed"===a.status&&(0,I.jsx)(j.A,{title:a.error_message,children:(0,I.jsx)(c.A,{label:"Error",color:"error",size:"small"})})]})}}];return(0,I.jsxs)(n.A,{children:[(0,I.jsxs)(n.A,{sx:W.tablePreHeader,children:[(0,I.jsx)(C.A,{value:d,onChange:e=>u(e.target.value),type:"text",placeholder:"Search reports..."}),(0,I.jsx)(j.A,{title:"Refresh",children:(0,I.jsx)(f.A,{onClick:()=>{p(a)},color:"primary",children:(0,I.jsx)(_.A,{})})})]}),(0,I.jsx)(R.A,{columnShape:m,data:(null===e||void 0===e?void 0:e.results)||[],dataCount:(null===e||void 0===e?void 0:e.count)||0,pageInitialState:{pageSize:w.hk,pageIndex:0},setPageIndex:e=>r((0,i.A)((0,i.A)({},a),{},{page:e})),pageIndex:(null===a||void 0===a?void 0:a.page)||1,setPageSize:e=>r((0,i.A)((0,i.A)({},a),{},{page_size:e})),loading:l})]})};var z=a(4598),D=a(95540),P=a(63471),F=a(54469),M=a(22505),E=a(63516),O=a(73033),L=a(74523),H=a(80644),U=a(25933),G=a(75992);const N=[{label:"Supplier Report",value:"supplier"},{label:"Trade Report",value:"trade"},{label:"Invoice Report",value:"invoice"},{label:"Payment Report",value:"payment"},{label:"Depositor Report",value:"depositor"},{label:"Voucher Report",value:"voucher"},{label:"Inventory Report",value:"inventory"},{label:"Investor Report",value:"investor"}],Y=[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],X=[{label:"Daily",value:"daily"},{label:"Weekly",value:"weekly"},{label:"Monthly",value:"monthly"},{label:"Quarterly",value:"quarterly"}],K=[{label:"Monday",value:0},{label:"Tuesday",value:1},{label:"Wednesday",value:2},{label:"Thursday",value:3},{label:"Friday",value:4},{label:"Saturday",value:5},{label:"Sunday",value:6}],Q=e=>{let{handleClose:t,formType:a="Save",initialValues:i,callBack:r}=e;const[s,o]=(0,x.useState)(!1),d=[{name:"name",initailValue:"",label:"Schedule Name",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:12,md:12},required:!0},{name:"report_type",initailValue:"",label:"Report Type",type:"select",uiType:"select",options:N,uiBreakpoints:{xs:12,sm:6,md:6},required:!0},{name:"format",initailValue:"pdf",label:"Export Format",type:"select",uiType:"select",options:Y,uiBreakpoints:{xs:12,sm:6,md:6},required:!0},{name:"frequency",initailValue:"",label:"Frequency",type:"select",uiType:"select",options:X,uiBreakpoints:{xs:12,sm:6,md:6},required:!0},{name:"day_of_week",initailValue:"",label:"Day of Week (for weekly)",type:"select",uiType:"select",options:K,uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"day_of_month",initailValue:"",label:"Day of Month (for monthly)",type:"number",uiType:"number",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"time_of_day",initailValue:"09:00",label:"Time of Day",type:"time",uiType:"time",uiBreakpoints:{xs:12,sm:6,md:6},required:!0},{name:"recipient_ids",initailValue:[],label:"Recipients (User IDs)",type:"text",uiType:"multiselect",uiBreakpoints:{xs:12,sm:12,md:12},required:!0,options:[]},{name:"hub_id",initailValue:"",label:"Hub (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"is_active",initailValue:!0,label:"Active",type:"checkbox",uiType:"checkbox",uiBreakpoints:{xs:12,sm:6,md:6},required:!1}],c=(0,E.Wx)({initialValues:(0,U.f6)(d),validationSchema:O.Ik().shape({name:O.Yj().required("Schedule name is required").min(3,"Name must be at least 3 characters"),report_type:O.Yj().required("Report type is required"),format:O.Yj().required("Format is required"),frequency:O.Yj().required("Frequency is required"),time_of_day:O.Yj().required("Time is required"),day_of_week:O.ai().when("frequency",{is:"weekly",then:e=>e.required("Day of week is required for weekly schedules")}),day_of_month:O.ai().when("frequency",{is:"monthly",then:e=>e.required("Day of month is required for monthly schedules").min(1,"Day must be between 1 and 31").max(31,"Day must be between 1 and 31")}),recipient_ids:O.YO().min(1,"At least one recipient is required")}),validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,enableReinitialize:!0,onSubmit:e=>u(e)});(0,x.useEffect)(()=>{if("Update"===a&&i){const e=(0,U.RA)(d)(i||{});i.recipients&&(e.recipient_ids=i.recipients.map(e=>e.id)),c.setValues(e)}},[i,a]);const u=async e=>{o(!0);try{"Update"===a?(await v.updateReportSchedule(i.id,e),k.oR.success("Schedule updated successfully")):(await v.createReportSchedule(e),k.oR.success("Schedule created successfully")),c.resetForm(),r&&r(),t(),o(!1)}catch(s){var n;o(!1),null!==(n=s.response)&&void 0!==n&&n.data&&c.setErrors(s.response.data),k.oR.error(s.message||"An error occurred")}},p=()=>{c.resetForm(),t()};return(0,I.jsx)(L.A,{title:"Save"===a?"New Report Schedule":"Edit Report Schedule",onClose:p,id:(0,G.A)(),ActionButtons:()=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(l.A,{onClick:p,disabled:s,children:"Cancel"}),(0,I.jsx)(l.A,{onClick:()=>c.handleSubmit(),variant:"contained",disabled:s,children:s?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(B.A,{color:"inherit",size:20})," ",(0,I.jsx)(q.L9,{style:{marginLeft:"0.5rem"},color:"primary",children:"Saving..."})]}):"Update"===a?"Update Schedule":"Create Schedule"})]}),maxWidth:"md",children:(0,I.jsx)("form",{onSubmit:c.handleSubmit,children:(0,I.jsx)(n.A,{sx:{width:"100%",py:2},children:(0,I.jsx)(H.A,{formikInstance:c,formFields:d,validationSchema:O.Ik()})})})})},Z={tablePreHeader:{display:"flex",alignItems:"center",gap:2,marginBottom:2}},J=()=>{const{setShowModal:e}=(0,h.k3)(),[t,a]=(0,x.useState)(),[r,o]=(0,x.useState)(null),[d,u]=(0,x.useState)(!1),[p,m]=(0,x.useState)(""),[y,A]=(0,x.useState)(null),[g,b]=(0,x.useState)("Save");(0,x.useEffect)(()=>{S(r)},[r]);const S=async e=>{try{u(!0);const t=await v.getReportSchedules(e);a(t),u(!1)}catch(t){u(!1),console.error("Error fetching schedules:",t),k.oR.error("Failed to load report schedules")}},_=[{Header:"Schedule Name",accessor:"name",minWidth:200,Cell:e=>{let{row:t}=e;const a=t.original;return(0,I.jsxs)(n.A,{children:[(0,I.jsx)(s.A,{variant:"body2",fontWeight:600,children:a.name}),(0,I.jsxs)(s.A,{variant:"caption",color:"text.secondary",children:[a.report_type_display," \xb7 ",a.format.toUpperCase()]})]})}},{Header:"Frequency",accessor:"frequency",minWidth:120,Cell:e=>{let{row:t}=e;const a=t.original;return(0,I.jsx)(c.A,{label:a.frequency_display,size:"small",color:"primary",variant:"outlined"})}},{Header:"Schedule Details",accessor:"schedule_details",minWidth:150,Cell:e=>{let{row:t}=e;const a=t.original;let i="";if("weekly"===a.frequency&&null!==a.day_of_week){i="".concat(["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][a.day_of_week]," at ").concat(a.time_of_day)}else i="monthly"===a.frequency&&a.day_of_month?"Day ".concat(a.day_of_month," at ").concat(a.time_of_day):"at ".concat(a.time_of_day);return(0,I.jsx)(s.A,{variant:"body2",children:i})}},{Header:"Recipients",accessor:"recipients",minWidth:100,Cell:e=>{let{row:t}=e;const a=t.original;return(0,I.jsx)(c.A,{label:"".concat(a.recipients.length," users"),size:"small",variant:"outlined"})}},{Header:"Last Run",accessor:"last_run",minWidth:120,Cell:e=>{let{row:t}=e;const a=t.original;return a.last_run?(0,I.jsx)(s.A,{variant:"body2",children:(0,T.pU)(a.last_run)}):(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Never"})}},{Header:"Next Run",accessor:"next_run",minWidth:120,Cell:e=>{let{row:t}=e;const a=t.original;return a.next_run?(0,I.jsx)(s.A,{variant:"body2",fontWeight:600,color:"primary",children:(0,T.pU)(a.next_run)}):(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"-"})}},{Header:"Active",accessor:"is_active",minWidth:80,Cell:e=>{let{row:t}=e;const a=t.original;return(0,I.jsx)(z.A,{checked:a.is_active,onChange:()=>(async e=>{try{await v.toggleScheduleActive(e.id),k.oR.success("Schedule ".concat(e.is_active?"deactivated":"activated"," successfully")),S(r)}catch(t){k.oR.error("Failed to toggle schedule status")}})(a),size:"small"})}},{Header:"Action",accessor:"action",minWidth:150,Cell:t=>{let{row:a}=t;const i=a.original;return(0,I.jsxs)(n.A,{sx:{display:"flex",gap:.5},children:[(0,I.jsx)(j.A,{title:"Run Now",children:(0,I.jsx)(f.A,{size:"small",color:"success",onClick:()=>(async e=>{try{k.oR.loading("Triggering report generation..."),await v.runScheduleNow(e.id),k.oR.dismiss(),k.oR.success("Report generation started")}catch(t){k.oR.dismiss(),k.oR.error("Failed to run schedule")}})(i),children:(0,I.jsx)(F.A,{fontSize:"small"})})}),(0,I.jsx)(j.A,{title:"Edit",children:(0,I.jsx)(f.A,{size:"small",color:"primary",onClick:()=>{return t=i,b("Update"),A(t),void setTimeout(()=>{e(!0)});var t},children:(0,I.jsx)(D.A,{fontSize:"small"})})}),(0,I.jsx)(j.A,{title:"Delete",children:(0,I.jsx)(f.A,{size:"small",color:"error",onClick:()=>(async e=>{if(window.confirm('Are you sure you want to delete "'.concat(e.name,'"?')))try{await v.deleteReportSchedule(e.id),k.oR.success("Schedule deleted successfully"),S(r)}catch(t){k.oR.error("Failed to delete schedule")}})(i),children:(0,I.jsx)(P.A,{fontSize:"small"})})})]})}}];return(0,I.jsxs)(n.A,{children:[(0,I.jsxs)(n.A,{sx:Z.tablePreHeader,children:[(0,I.jsx)(C.A,{value:p,onChange:e=>m(e.target.value),type:"text",placeholder:"Search schedules..."}),(0,I.jsx)(l.A,{variant:"contained",startIcon:(0,I.jsx)(M.A,{}),onClick:()=>{b("Save"),A(null),e(!0)},children:"New Schedule"})]}),(0,I.jsx)(R.A,{columnShape:_,data:(null===t||void 0===t?void 0:t.results)||[],dataCount:(null===t||void 0===t?void 0:t.count)||0,pageInitialState:{pageSize:w.hk,pageIndex:0},setPageIndex:e=>o((0,i.A)((0,i.A)({},r),{},{page:e})),pageIndex:(null===r||void 0===r?void 0:r.page)||1,setPageSize:e=>o((0,i.A)((0,i.A)({},r),{},{page_size:e})),loading:d}),(0,I.jsx)(Q,{handleClose:()=>{e(!1),A(null)},formType:g,initialValues:y,callBack:()=>S(r)})]})};var $=a(26494),ee=a(41180),te=a(11474),ae=a(87734),ie=a(52185),re=a(6026),ne=a(80379),se=a(70095),le=a(33331),oe=a(16992),de=a(56102),ce=a(17869),ue=a(37912),pe=a(93881);const xe=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82ca9d"],me={kpiCard:{height:"100%",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:6}},insightBox:{p:2,borderRadius:2,bgcolor:"background.default"}},he=()=>{const[e,t]=(0,x.useState)(null),[a,i]=(0,x.useState)(!1);(0,x.useEffect)(()=>{r()},[]);const r=async()=>{try{i(!0);const e=await v.getDashboardStats();t(e),i(!1)}catch(e){i(!1),console.error("Error fetching stats:",e)}};if(!e)return(0,I.jsx)(n.A,{sx:{textAlign:"center",py:8},children:(0,I.jsx)(s.A,{variant:"h6",color:"text.secondary",children:"Loading analytics..."})});const u=[{name:"Trades",value:e.trades.count,amount:e.trades.value},{name:"Invoices",value:e.invoices.count,amount:0},{name:"Payments",value:e.payments.count,amount:e.payments.value},{name:"Deposits",value:e.deposits.count,amount:0}],p=[{name:"Trade Value",value:e.trades.value},{name:"Payments",value:e.payments.value}],m=[{name:"Paid",value:e.invoices.count-e.invoices.overdue_count},{name:"Overdue",value:e.invoices.overdue_count}];return(0,I.jsxs)(n.A,{children:[(0,I.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,I.jsxs)(n.A,{children:[(0,I.jsx)(s.A,{variant:"h5",fontWeight:600,children:"Business Analytics Dashboard"}),(0,I.jsxs)(s.A,{variant:"body2",color:"text.secondary",children:[e.period.start_date," to ",e.period.end_date]})]}),(0,I.jsxs)(n.A,{sx:{display:"flex",gap:1},children:[(0,I.jsx)(l.A,{startIcon:(0,I.jsx)(_.A,{}),onClick:r,variant:"outlined",size:"small",children:"Refresh"}),(0,I.jsx)(l.A,{startIcon:(0,I.jsx)(S.A,{}),variant:"contained",size:"small",children:"Export Dashboard"})]})]}),(0,I.jsxs)(o.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(d.A,{sx:me.kpiCard,children:(0,I.jsxs)($.A,{children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Total Trades"}),(0,I.jsx)(s.A,{variant:"h3",fontWeight:600,color:"primary",children:e.trades.count}),(0,I.jsx)(n.A,{sx:{mt:2},children:(0,I.jsx)(c.A,{icon:(0,I.jsx)(ue.A,{}),label:"UGX ".concat(e.trades.value.toLocaleString()),color:"success",size:"small"})})]})})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(d.A,{sx:me.kpiCard,children:(0,I.jsxs)($.A,{children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Total Invoices"}),(0,I.jsx)(s.A,{variant:"h3",fontWeight:600,color:"info.main",children:e.invoices.count}),(0,I.jsx)(n.A,{sx:{mt:2},children:(0,I.jsx)(c.A,{icon:(0,I.jsx)(pe.A,{}),label:"".concat(e.invoices.overdue_count," Overdue"),color:"error",size:"small"})})]})})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(d.A,{sx:me.kpiCard,children:(0,I.jsxs)($.A,{children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Total Payments"}),(0,I.jsx)(s.A,{variant:"h3",fontWeight:600,color:"success.main",children:e.payments.count}),(0,I.jsx)(n.A,{sx:{mt:2},children:(0,I.jsx)(c.A,{icon:(0,I.jsx)(ue.A,{}),label:"UGX ".concat(e.payments.value.toLocaleString()),color:"success",size:"small"})})]})})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(d.A,{sx:me.kpiCard,children:(0,I.jsxs)($.A,{children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Active Vouchers"}),(0,I.jsx)(s.A,{variant:"h3",fontWeight:600,color:"warning.main",children:e.vouchers.active_count}),(0,I.jsx)(n.A,{sx:{mt:2},children:(0,I.jsx)(c.A,{label:"".concat(e.deposits.quantity_kg.toLocaleString()," kg"),color:"warning",size:"small"})})]})})})]}),(0,I.jsxs)(o.Ay,{container:!0,spacing:3,children:[(0,I.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,I.jsx)(d.A,{children:(0,I.jsxs)($.A,{children:[(0,I.jsx)(s.A,{variant:"h6",gutterBottom:!0,fontWeight:600,children:"Transaction Overview"}),(0,I.jsx)(ee.u,{width:"100%",height:300,children:(0,I.jsxs)(te.E,{data:u,children:[(0,I.jsx)(ae.d,{strokeDasharray:"3 3"}),(0,I.jsx)(ie.W,{dataKey:"name"}),(0,I.jsx)(re.h,{}),(0,I.jsx)(ne.m,{}),(0,I.jsx)(se.s,{}),(0,I.jsx)(le.yP,{dataKey:"value",fill:"#8884d8",name:"Count"})]})})]})})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,I.jsx)(d.A,{children:(0,I.jsxs)($.A,{children:[(0,I.jsx)(s.A,{variant:"h6",gutterBottom:!0,fontWeight:600,children:"Financial Overview (UGX)"}),(0,I.jsx)(ee.u,{width:"100%",height:300,children:(0,I.jsxs)(oe.r,{children:[(0,I.jsx)(de.Fq,{data:p,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",children:p.map((e,t)=>(0,I.jsx)(ce.f,{fill:xe[t%xe.length]},"cell-".concat(t)))}),(0,I.jsx)(ne.m,{formatter:e=>e.toLocaleString()})]})})]})})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,I.jsx)(d.A,{children:(0,I.jsxs)($.A,{children:[(0,I.jsx)(s.A,{variant:"h6",gutterBottom:!0,fontWeight:600,children:"Invoice Payment Status"}),(0,I.jsx)(ee.u,{width:"100%",height:300,children:(0,I.jsxs)(oe.r,{children:[(0,I.jsx)(de.Fq,{data:m,cx:"50%",cy:"50%",labelLine:!1,label:e=>"".concat(e.name,": ").concat(e.value),outerRadius:80,fill:"#8884d8",dataKey:"value",children:m.map((e,t)=>(0,I.jsx)(ce.f,{fill:"Paid"===e.name?"#00C49F":"#FF8042"},"cell-".concat(t)))}),(0,I.jsx)(ne.m,{})]})})]})})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,I.jsx)(d.A,{children:(0,I.jsxs)($.A,{children:[(0,I.jsx)(s.A,{variant:"h6",gutterBottom:!0,fontWeight:600,children:"Quick Report Actions"}),(0,I.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[(0,I.jsx)(l.A,{variant:"outlined",fullWidth:!0,children:"Generate Monthly Summary Report"}),(0,I.jsx)(l.A,{variant:"outlined",fullWidth:!0,children:"Generate Financial Statement"}),(0,I.jsx)(l.A,{variant:"outlined",fullWidth:!0,children:"Generate Inventory Report"}),(0,I.jsx)(l.A,{variant:"outlined",fullWidth:!0,children:"Generate Performance Analytics"})]})]})})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,children:(0,I.jsx)(d.A,{children:(0,I.jsxs)($.A,{children:[(0,I.jsx)(s.A,{variant:"h6",gutterBottom:!0,fontWeight:600,children:"System Health & Insights"}),(0,I.jsxs)(o.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsxs)(n.A,{sx:me.insightBox,children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Average Trade Value"}),(0,I.jsxs)(s.A,{variant:"h5",fontWeight:600,children:["UGX ",e.trades.count>0?Math.round(e.trades.value/e.trades.count).toLocaleString():0]})]})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsxs)(n.A,{sx:me.insightBox,children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Overdue Rate"}),(0,I.jsxs)(s.A,{variant:"h5",fontWeight:600,children:[e.invoices.count>0?Math.round(e.invoices.overdue_count/e.invoices.count*100):0,"%"]})]})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsxs)(n.A,{sx:me.insightBox,children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Avg Deposit Size"}),(0,I.jsxs)(s.A,{variant:"h5",fontWeight:600,children:[e.deposits.count>0?Math.round(e.deposits.quantity_kg/e.deposits.count).toLocaleString():0," kg"]})]})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsxs)(n.A,{sx:me.insightBox,children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Payment Rate"}),(0,I.jsxs)(s.A,{variant:"h5",fontWeight:600,children:[e.invoices.count>0?Math.round((e.invoices.count-e.invoices.overdue_count)/e.invoices.count*100):0,"%"]})]})})]})]})})})]})]})},ye=[{label:"Draft",value:"draft"},{label:"Pending Approval",value:"pending_approval"},{label:"Approved",value:"approved"},{label:"Pending Allocation",value:"pending_allocation"},{label:"Ready for Delivery",value:"ready_for_delivery"},{label:"In Transit",value:"in_transit"},{label:"Delivered",value:"delivered"},{label:"Completed",value:"completed"},{label:"Cancelled",value:"cancelled"},{label:"Rejected",value:"rejected"}],ve=[{label:"Unpaid",value:"unpaid"},{label:"Partial",value:"partial"},{label:"Paid",value:"paid"},{label:"Overdue",value:"overdue"}],Ae=[{label:"Cash",value:"cash"},{label:"Bank Transfer",value:"bank_transfer"},{label:"Mobile Money",value:"mobile_money"},{label:"Cheque",value:"cheque"},{label:"Credit Card",value:"credit_card"},{label:"Other",value:"other"}],ge=[{label:"Pending Verification",value:"pending_verification"},{label:"Issued",value:"issued"},{label:"Transferred",value:"transferred"},{label:"Redeemed",value:"redeemed"},{label:"Expired",value:"expired"}],be=[{label:"Verified",value:"verified"},{label:"Pending",value:"pending"},{label:"Rejected",value:"rejected"}],je=[{name:"format",initailValue:"pdf",label:"Export Format",type:"select",uiType:"select",options:[{label:"PDF",value:"pdf"},{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],uiBreakpoints:{xs:12,sm:12,md:12},required:!0},{name:"start_date",initailValue:"",label:"Start Date",type:"date",uiType:"date",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"end_date",initailValue:"",label:"End Date",type:"date",uiType:"date",uiBreakpoints:{xs:12,sm:6,md:6},required:!1}];var fe=a(58422),ke=a(34044),Se=a(23939),_e=a(94216),Ce=a(76710),Re=a(44533);const we=[{value:"supplier",label:"Supplier Report",icon:(0,I.jsx)(Se.A,{}),description:"Track supplier performance and transactions"},{value:"trade",label:"Trade Report",icon:(0,I.jsx)(ue.A,{}),description:"Detailed trade transaction records"},{value:"invoice",label:"Invoice Report",icon:(0,I.jsx)(fe.A,{}),description:"Invoice status and aging analysis"},{value:"payment",label:"Payment Report",icon:(0,I.jsx)(ke.A,{}),description:"Payment tracking and reconciliation"},{value:"depositor",label:"Depositor Report",icon:(0,I.jsx)(Se.A,{}),description:"Farmer deposit records"},{value:"voucher",label:"Voucher Report",icon:(0,I.jsx)(_e.A,{}),description:"Voucher issuance and redemption"},{value:"inventory",label:"Inventory Report",icon:(0,I.jsx)(Ce.A,{}),description:"Stock levels and availability"},{value:"investor",label:"Investor Report",icon:(0,I.jsx)(Re.A,{}),description:"Investment performance and returns"}],Te=e=>{var t;let{handleClose:a,callBack:r}=e;const[c,u]=(0,x.useState)(!1),[p,m]=(0,x.useState)("supplier"),[h,y]=(0,x.useState)(1),A=(e=>{const t=[...je];switch(e){case"supplier":t.push({name:"supplier_id",initailValue:"",label:"Specific Supplier (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"grain_type_id",initailValue:"",label:"Grain Type (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"min_total_supplied",initailValue:"",label:"Minimum Total Supplied (kg)",type:"number",uiType:"number",uiBreakpoints:{xs:12,sm:6,md:6},required:!1});break;case"trade":t.push({name:"status",initailValue:[],label:"Trade Status",type:"multiselect",uiType:"multiselect",options:ye,uiBreakpoints:{xs:12,sm:12,md:12},required:!1},{name:"buyer_id",initailValue:"",label:"Buyer ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"supplier_id",initailValue:"",label:"Supplier ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"min_value",initailValue:"",label:"Minimum Value",type:"number",uiType:"number",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"max_value",initailValue:"",label:"Maximum Value",type:"number",uiType:"number",uiBreakpoints:{xs:12,sm:6,md:6},required:!1});break;case"invoice":t.push({name:"payment_status",initailValue:[],label:"Payment Status",type:"multiselect",uiType:"multiselect",options:ve,uiBreakpoints:{xs:12,sm:12,md:12},required:!1},{name:"account_id",initailValue:"",label:"Account ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"min_amount",initailValue:"",label:"Minimum Amount",type:"number",uiType:"number",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"overdue_only",initailValue:!1,label:"Overdue Only",type:"checkbox",uiType:"checkbox",uiBreakpoints:{xs:12,sm:6,md:6},required:!1});break;case"payment":t.push({name:"payment_method",initailValue:[],label:"Payment Method",type:"multiselect",uiType:"multiselect",options:Ae,uiBreakpoints:{xs:12,sm:12,md:12},required:!1},{name:"account_id",initailValue:"",label:"Account ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"min_amount",initailValue:"",label:"Minimum Amount",type:"number",uiType:"number",uiBreakpoints:{xs:12,sm:6,md:6},required:!1});break;case"depositor":t.push({name:"farmer_id",initailValue:"",label:"Farmer ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"grain_type_id",initailValue:"",label:"Grain Type ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"validated_only",initailValue:!1,label:"Validated Deposits Only",type:"checkbox",uiType:"checkbox",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"min_total_quantity",initailValue:"",label:"Minimum Total Quantity (kg)",type:"number",uiType:"number",uiBreakpoints:{xs:12,sm:6,md:6},required:!1});break;case"voucher":t.push({name:"status",initailValue:[],label:"Voucher Status",type:"multiselect",uiType:"multiselect",options:ge,uiBreakpoints:{xs:12,sm:12,md:12},required:!1},{name:"verification_status",initailValue:[],label:"Verification Status",type:"multiselect",uiType:"multiselect",options:be,uiBreakpoints:{xs:12,sm:12,md:12},required:!1},{name:"holder_id",initailValue:"",label:"Holder ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"grain_type_id",initailValue:"",label:"Grain Type ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1});break;case"inventory":t.push({name:"grain_type_id",initailValue:"",label:"Grain Type ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"min_quantity",initailValue:"",label:"Minimum Quantity (kg)",type:"number",uiType:"number",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"low_stock_only",initailValue:!1,label:"Low Stock Only",type:"checkbox",uiType:"checkbox",uiBreakpoints:{xs:12,sm:6,md:6},required:!1});break;case"investor":t.push({name:"investor_id",initailValue:"",label:"Investor ID (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"min_total_invested",initailValue:"",label:"Minimum Total Invested",type:"number",uiType:"number",uiBreakpoints:{xs:12,sm:6,md:6},required:!1},{name:"include_performance",initailValue:!0,label:"Include Performance Metrics",type:"checkbox",uiType:"checkbox",uiBreakpoints:{xs:12,sm:6,md:6},required:!1})}return t.push({name:"hub_id",initailValue:"",label:"Hub (Optional)",type:"text",uiType:"text",uiBreakpoints:{xs:12,sm:6,md:6},required:!1}),t})(p),g=(0,E.Wx)({initialValues:(0,i.A)({format:"pdf",start_date:"",end_date:""},Object.fromEntries(A.map(e=>[e.name,e.initailValue||""]))),validationSchema:O.Ik().shape({format:O.Yj().required("Format is required"),start_date:O.p6().nullable(),end_date:O.p6().nullable().when("start_date",(e,t)=>e?t.min(e,"End date must be after start date"):t)}),enableReinitialize:!0,onSubmit:e=>b(e)}),b=async e=>{u(!0);try{let t;const i={supplier:v.generateSupplierReport,trade:v.generateTradeReport,invoice:v.generateInvoiceReport,payment:v.generatePaymentReport,depositor:v.generateDepositorReport,voucher:v.generateVoucherReport,inventory:v.generateInventoryReport,investor:v.generateInvestorReport};t=await i[p](e),k.oR.success("Report generation started. You'll be notified when it's ready."),g.resetForm(),r&&r(),a(),u(!1)}catch(i){var t;u(!1),null!==(t=i.response)&&void 0!==t&&t.data&&g.setErrors(i.response.data),k.oR.error(i.message||"Failed to generate report")}},j=()=>{g.resetForm(),y(1),m("supplier"),a()},f=()=>{y(2)},S=()=>{y(1)};return(0,I.jsx)(L.A,{title:"Generate Report",onClose:j,id:(0,G.A)(),ActionButtons:()=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(l.A,{onClick:j,disabled:c,children:"Cancel"}),2===h&&(0,I.jsx)(l.A,{onClick:S,disabled:c,children:"Back"}),(0,I.jsx)(l.A,{onClick:1===h?f:e=>{var t;null===e||void 0===e||null===(t=e.preventDefault)||void 0===t||t.call(e),g.handleSubmit()},type:1===h?"button":"submit",variant:"contained",disabled:c||1===h&&!p,children:c?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(B.A,{color:"inherit",size:20})," ",(0,I.jsx)(q.L9,{style:{marginLeft:"0.5rem"},color:"primary",children:"Generating..."})]}):1===h?"Next":"Generate Report"})]}),maxWidth:"md",children:1===h?(0,I.jsxs)(n.A,{sx:{py:2},children:[(0,I.jsx)(s.A,{variant:"h6",sx:{mb:2},children:"Select Report Type"}),(0,I.jsx)(o.Ay,{container:!0,spacing:2,children:we.map(e=>(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,children:(0,I.jsx)(d.A,{sx:{cursor:"pointer",border:2,borderColor:p===e.value?"primary.main":"transparent","&:hover":{borderColor:"primary.light",boxShadow:2},transition:"all 0.3s"},onClick:()=>m(e.value),children:(0,I.jsxs)($.A,{children:[(0,I.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,I.jsx)(n.A,{sx:{color:"primary.main",mr:1},children:e.icon}),(0,I.jsx)(s.A,{variant:"h6",fontWeight:600,children:e.label})]}),(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:e.description})]})})},e.value))})]}):(0,I.jsx)("form",{onSubmit:g.handleSubmit,children:(0,I.jsxs)(n.A,{sx:{py:2},children:[(0,I.jsxs)(s.A,{variant:"h6",sx:{mb:2},children:["Configure ",null===(t=we.find(e=>e.value===p))||void 0===t?void 0:t.label]}),(0,I.jsx)(H.A,{formikInstance:g,formFields:A,validationSchema:O.Ik()})]})})})},qe=["children","value","index"];function Be(e){const{children:t,value:a,index:s}=e,l=(0,r.A)(e,qe);return(0,I.jsx)("div",(0,i.A)((0,i.A)({role:"tabpanel",hidden:a!==s,id:"reports-tabpanel-".concat(s),"aria-labelledby":"reports-tab-".concat(s)},l),{},{children:a===s&&(0,I.jsx)(n.A,{sx:{py:3},children:t})}))}const Ie={header:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:3},statCard:{p:2.5,height:"100%",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:4}}},We=()=>{(0,m.A)("Reports & Analytics");const{setShowModal:e}=(0,h.k3)(),[t,a]=(0,x.useState)(0),[i,r]=(0,x.useState)(null),[y,j]=(0,x.useState)(!1);(0,x.useEffect)(()=>{f()},[]);const f=async()=>{try{j(!0);const e=await v.getDashboardStats();r(e),j(!1)}catch(e){j(!1),console.error("Error fetching dashboard stats:",e)}};return(0,I.jsxs)(n.A,{pt:2,pb:4,children:[(0,I.jsxs)(n.A,{sx:Ie.header,children:[(0,I.jsx)(n.A,{children:(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Generate, schedule, and download comprehensive business reports"})}),(0,I.jsx)(l.A,{variant:"contained",startIcon:(0,I.jsx)(A.A,{}),onClick:()=>{e(!0)},size:"large",sx:{height:"fit-content"},children:"Generate Report"})]}),i&&(0,I.jsxs)(o.Ay,{container:!0,spacing:3,sx:{mb:3},children:[(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsxs)(d.A,{sx:Ie.statCard,children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Trades (30 days)"}),(0,I.jsx)(s.A,{variant:"h4",sx:{my:1,fontWeight:600},children:i.trades.count}),(0,I.jsx)(c.A,{label:"UGX ".concat(i.trades.value.toLocaleString()),size:"small",color:"primary",variant:"outlined"})]})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsxs)(d.A,{sx:Ie.statCard,children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Invoices"}),(0,I.jsx)(s.A,{variant:"h4",sx:{my:1,fontWeight:600},children:i.invoices.count}),(0,I.jsx)(c.A,{label:"".concat(i.invoices.overdue_count," Overdue"),size:"small",color:"error",variant:"outlined"})]})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsxs)(d.A,{sx:Ie.statCard,children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Payments"}),(0,I.jsx)(s.A,{variant:"h4",sx:{my:1,fontWeight:600},children:i.payments.count}),(0,I.jsx)(c.A,{label:"UGX ".concat(i.payments.value.toLocaleString()),size:"small",color:"success",variant:"outlined"})]})}),(0,I.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsxs)(d.A,{sx:Ie.statCard,children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Active Vouchers"}),(0,I.jsx)(s.A,{variant:"h4",sx:{my:1,fontWeight:600},children:i.vouchers.active_count}),(0,I.jsx)(c.A,{label:"".concat(i.deposits.quantity_kg.toLocaleString()," kg"),size:"small",color:"info",variant:"outlined"})]})})]}),(0,I.jsxs)(d.A,{children:[(0,I.jsx)(n.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,I.jsxs)(u.A,{value:t,onChange:(e,t)=>{a(t)},sx:{px:2},children:[(0,I.jsx)(p.A,{icon:(0,I.jsx)(b.A,{}),iconPosition:"start",label:"Dashboard"}),(0,I.jsx)(p.A,{icon:(0,I.jsx)(A.A,{}),iconPosition:"start",label:"Report Exports"}),(0,I.jsx)(p.A,{icon:(0,I.jsx)(g.A,{}),iconPosition:"start",label:"Scheduled Reports"})]})}),(0,I.jsx)(Be,{value:t,index:0,children:(0,I.jsx)(he,{})}),(0,I.jsx)(Be,{value:t,index:1,children:(0,I.jsx)(V,{})}),(0,I.jsx)(Be,{value:t,index:2,children:(0,I.jsx)(J,{})})]}),(0,I.jsx)(Te,{handleClose:()=>{e(!1)},callBack:()=>{}})]})}},74523:(e,t,a)=>{a.d(t,{A:()=>g});a(65043);var i=a(8302),r=a(34535),n=a(90035),s=a(4219),l=a(35316),o=a(29347),d=a(17392),c=a(74802),u=a(8433),p=a(42438),x=a(96446),m=a(10611),h=a(70579);const y=(0,r.Ay)(n.A)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}}),v=e=>{const{title:t,onClose:a,id:i}=e;return(0,h.jsxs)(s.A,{sx:{m:0,p:2},id:i,children:[(0,h.jsx)(p.L9,{sx:{fontSize:"1.2rem",fontWeight:"bold",padding:10,paddingLeft:0},children:t}),a?(0,h.jsx)(d.A,{"aria-label":"close",onClick:a,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,h.jsx)(c.A,{})}):null]})},A={loadingModalContentBackground:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#fff",opacity:.6,zIndex:1e3,pointerEvents:"none"}},g=e=>{let{children:t,onClose:a,title:r,maxWidth:n,minWidth:s,ActionButtons:d,selectedModalId:c,open:p}=e;const{showModal:g,loadingModalContent:b,modalId:j}=(0,u.k3)();if(!g&&!p)return null;if(void 0!==j&&j!==c)return null;return(0,h.jsx)(x.A,{children:(0,h.jsxs)(y,{onClose:e=>{a()},"aria-labelledby":"customized-dialog-title",open:void 0!==p?p:g,maxWidth:n,sx:{"& .MuiPaper-root":{minWidth:s||0}},style:{borderRadius:"10px"},children:[b&&(0,h.jsx)(x.A,{sx:{width:"100%",zIndex:1200},children:(0,h.jsx)(m.A,{})}),(0,h.jsx)(x.A,{sx:b?A.loadingModalContentBackground:{}}),(0,h.jsx)(v,{id:"customized-dialog-title",title:r,onClose:a}),(0,h.jsx)(l.A,{dividers:!0,children:t}),(0,h.jsx)(o.A,{children:d?(0,h.jsx)(d,{}):(0,h.jsx)(i.A,{autoFocus:!0,onClick:a,children:"Cancel"})})]})})}}}]);
//# sourceMappingURL=878.e2b8b2d6.chunk.js.map