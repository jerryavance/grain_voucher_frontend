"use strict";(self.webpackChunkinvest=self.webpackChunkinvest||[]).push([[6699],{13194:(e,t,a)=>{a.d(t,{A:()=>s});var r=a(65043),n=a(95926);const s=e=>{const{title:t,setTitle:a}=(0,r.useContext)(n.C);return(0,r.useEffect)((()=>a(e)),[e,a]),t}},23722:(e,t,a)=>{a.d(t,{A:()=>l});var r=a(89379),n=(a(65043),a(67024)),s=a(81637),i=a(70579);const l=e=>{let{size:t,color:a="primary",sx:l}=e;return(0,i.jsx)(n.A,{sx:(0,r.A)({color:"grey.500"},l),spacing:2,direction:"row",children:(0,i.jsx)(s.A,{size:t,color:a})})}},23817:(e,t,a)=>{a.d(t,{A:()=>d});var r=a(65043),n=a(17392),s=a(688),i=a(32143),l=a(42438),o=a(98082),c=a(70579);const d=e=>{let{actions:t,metaData:a,btnColor:d}=e;const[u,h]=(0,r.useState)(null),x=()=>{h(null)},p=t.filter((e=>!e.condition||e.condition(a)));return 0===p.length?null:(0,c.jsxs)("div",{children:[(0,c.jsx)(n.A,{size:"small",onClick:e=>{h(e.currentTarget)},children:(0,c.jsx)(o.A,{fontSize:"small"})}),(0,c.jsx)(s.A,{anchorEl:u,open:Boolean(u),onClose:x,children:p.map(((e,t)=>(0,c.jsxs)(i.A,{onClick:()=>(e=>{e.onClick(a),x()})(e),children:[e.icon,(0,c.jsx)(l.L9,{sx:{marginLeft:"0.5rem"},children:e.label})]},t)))})]})}},46055:(e,t,a)=>{a.d(t,{pU:()=>r});const r=e=>{if(!e)return"N/A";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const a=t.getDate().toString().padStart(2,"0"),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(a,"/").concat(r,"/").concat(n)}},46699:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ce});var r=a(89379),n=a(80045),s=a(65043),i=a(96446),l=a(14912),o=a(24056),c=a(93933),d=a(8302),u=a(90035),h=a(4219),x=a(35316),p=a(85865),m=a(67784),g=a(29347),j=a(23768),A=a(47260),v=a(19778),y=a(85502),f=a(34044),b=a(48625),C=a(13194),S=a(56629);const _={getVouchers:async e=>S.A.get("vouchers/vouchers/",{params:e}).then((e=>e.data)),getMyVouchers:async e=>S.A.get("vouchers/vouchers/my_vouchers/",{params:e}).then((e=>e.data)),getVoucherDetails:async e=>S.A.get("vouchers/vouchers/".concat(e,"/")).then((e=>e.data)),verifyVoucher:async e=>S.A.post("vouchers/vouchers/".concat(e,"/verify_voucher/")).then((e=>e.data)),rejectVoucher:async(e,t)=>S.A.post("vouchers/vouchers/".concat(e,"/reject_voucher/"),t).then((e=>e.data)),getPendingVerification:async e=>S.A.get("vouchers/vouchers/pending_verification/",{params:e}).then((e=>e.data)),updateVoucherValue:async e=>S.A.post("vouchers/vouchers/".concat(e,"/update_value/")).then((e=>e.data)),getRedemptions:async e=>S.A.get("vouchers/redemptions/",{params:e}).then((e=>e.data)),getRedemptionDetails:async e=>S.A.get("vouchers/redemptions/".concat(e,"/")).then((e=>e.data)),createRedemption:async e=>S.A.post("vouchers/redemptions/",e).then((e=>e.data)),approveRedemption:async e=>S.A.post("vouchers/redemptions/".concat(e,"/approve/")).then((e=>e.data)),rejectRedemption:async(e,t)=>S.A.post("vouchers/redemptions/".concat(e,"/reject/"),t).then((e=>e.data)),markRedemptionPaid:async(e,t)=>S.A.post("vouchers/redemptions/".concat(e,"/pay/"),t||{}).then((e=>e.data)),getDeposits:async e=>S.A.get("vouchers/deposits/",{params:e}).then((e=>e.data)),getDepositDetails:async e=>S.A.get("vouchers/deposits/".concat(e,"/")).then((e=>e.data)),validateDeposit:async e=>S.A.post("vouchers/deposits/".concat(e,"/validate_deposit/")).then((e=>e.data)),getLedgerEntries:async e=>S.A.get("vouchers/ledger-entries/",{params:e}).then((e=>e.data)),getInventories:async e=>S.A.get("vouchers/inventories/",{params:e}).then((e=>e.data))};var R=a(64093),k=a(61408),w=a(43845),P=a(46055),W=a(23817),V=a(42438),z=a(70579);const F=(e,t)=>[{Header:"GRN Number",accessor:"grn_number",Cell:e=>{let{value:a,row:r}=e;return(0,z.jsx)("span",{style:{cursor:"pointer",color:"#1976d2"},onClick:()=>t(r.original),children:a})}},{Header:"Current Value",accessor:"current_value",Cell:e=>{let{value:t}=e;return(0,z.jsx)("span",{children:"UGX ".concat((null===t||void 0===t?void 0:t.toLocaleString())||0)})}},{Header:"Holder Name",accessor:"holder",Cell:e=>{let{row:t}=e;const a=t.original.holder;return(0,z.jsxs)("span",{children:[null===a||void 0===a?void 0:a.first_name," ",null===a||void 0===a?void 0:a.last_name]})}},{Header:"Holder Phone",accessor:"holder.phone_number"},{Header:"Holder ID Number",accessor:"holder.id"},{Header:"Verification Status",accessor:"verification_status",Cell:e=>{let{value:t}=e;return(0,z.jsx)(w.A,{label:t,color:{pending:"warning",verified:"success",rejected:"error"}[t.toLowerCase()],size:"small"})}},{Header:"Action",accessor:"action",Cell:t=>{let{row:a}=t;return(0,z.jsx)(W.A,{actions:e,metaData:a.original})}}],I=e=>[{Header:"GRN Number",accessor:"grn_number",minWidth:150,Cell:e=>{let{row:t}=e;return(0,z.jsx)(V.L9,{sx:{fontSize:12,fontWeight:600},children:t.original.grn_number||"N/A"})}},{Header:"Farmer",accessor:"farmer",minWidth:150,Cell:e=>{let{row:t}=e;const{farmer:a}=t.original;return(0,z.jsxs)(V.L9,{sx:{fontSize:12},children:[null===a||void 0===a?void 0:a.first_name," ",null===a||void 0===a?void 0:a.last_name]})}},{Header:"Grain Type",accessor:"grain_type_details.name",minWidth:120,Cell:e=>{var t;let{row:a}=e;return(0,z.jsx)(V.L9,{sx:{fontSize:12},children:(null===(t=a.original.grain_type_details)||void 0===t?void 0:t.name)||"N/A"})}},{Header:"Quantity (kg)",accessor:"quantity_kg",minWidth:120,Cell:e=>{let{row:t}=e;return(0,z.jsx)(V.L9,{sx:{fontSize:12},children:parseFloat(t.original.quantity_kg||"0").toFixed(2)})}},{Header:"Value",accessor:"value",minWidth:120,Cell:e=>{let{row:t}=e;return(0,z.jsxs)(V.L9,{sx:{fontSize:12,fontWeight:600,color:"primary.main"},children:["UGX ",parseFloat(t.original.value||"0").toLocaleString()]})}},{Header:"Hub",accessor:"hub.name",minWidth:120,Cell:e=>{var t;let{row:a}=e;return(0,z.jsx)(V.L9,{sx:{fontSize:12},children:(null===(t=a.original.hub)||void 0===t?void 0:t.name)||"N/A"})}},{Header:"Validated",accessor:"validated",minWidth:100,Cell:e=>{let{row:t}=e;return(0,z.jsx)(w.A,{label:t.original.validated?"YES":"NO",color:t.original.validated?"success":"warning",size:"small"})}},{Header:"Deposit Date",accessor:"deposit_date",minWidth:120,Cell:e=>{let{row:t}=e;return(0,z.jsx)(V.L9,{sx:{fontSize:12},children:(0,P.pU)(t.original.deposit_date)})}},{Header:"Action",accessor:"action",minWidth:100,maxWidth:100,Cell:t=>{let{row:a}=t;const r=a.original;return(0,z.jsx)(W.A,{actions:e,metaData:r},a.id)}}];var L=a(68903),D=a(63336),H=a(39336);const N=e=>{let{voucher:t,handleClose:a}=e;if(!t)return null;const r=e=>{let{label:t,value:a,highlight:r=!1}=e;return(0,z.jsxs)(L.Ay,{container:!0,spacing:2,sx:{mb:1.5},children:[(0,z.jsx)(L.Ay,{item:!0,xs:5,children:(0,z.jsxs)(p.A,{variant:"body2",color:"textSecondary",fontWeight:600,children:[t,":"]})}),(0,z.jsx)(L.Ay,{item:!0,xs:7,children:(0,z.jsx)(p.A,{variant:"body2",fontWeight:r?600:400,color:r?"primary":"textPrimary",children:a})})]})},n=()=>(0,z.jsx)(i.A,{sx:{display:"flex",gap:1},children:(0,z.jsx)(d.A,{onClick:a,children:"Close"})});return(0,z.jsxs)(u.A,{open:!0,onClose:a,maxWidth:"md",fullWidth:!0,sx:{zIndex:1300},children:[(0,z.jsx)(h.A,{children:"Voucher Details"}),(0,z.jsx)(x.A,{children:(0,z.jsxs)(i.A,{sx:{p:2},children:[(0,z.jsx)(D.A,{elevation:0,sx:{p:2,bgcolor:"grey.50",mb:3},children:(0,z.jsxs)(L.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,z.jsxs)(L.Ay,{item:!0,xs:12,sm:6,children:[(0,z.jsx)(p.A,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:"Status"}),(0,z.jsx)(w.A,{label:t.status.replace("_"," ").toUpperCase(),color:(e=>{switch(e){case"issued":return"success";case"pending_verification":return"warning";case"transferred":return"info";case"redeemed":default:return"default";case"expired":return"error"}})(t.status),sx:{fontWeight:600}})]}),(0,z.jsxs)(L.Ay,{item:!0,xs:12,sm:6,children:[(0,z.jsx)(p.A,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:"Verification Status"}),(0,z.jsx)(w.A,{label:t.verification_status_display||t.verification_status,color:(e=>{switch(e){case"verified":return"success";case"pending":return"warning";case"rejected":return"error";default:return"default"}})(t.verification_status),sx:{fontWeight:600}})]})]})}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mt:2,mb:2},children:"Voucher Information"}),(0,z.jsx)(r,{label:"GRN Number",value:t.grn_number,highlight:!0}),(0,z.jsx)(r,{label:"Current Value",value:"UGX ".concat(parseFloat(t.current_value).toLocaleString()),highlight:!0}),(0,z.jsx)(r,{label:"Entry Price",value:"UGX ".concat(parseFloat(t.entry_price).toLocaleString())}),(0,z.jsx)(r,{label:"Issue Date",value:(0,P.pU)(t.issue_date)}),(0,z.jsx)(r,{label:"Last Updated",value:(0,P.pU)(t.updated_at)}),(0,z.jsx)(r,{label:"Can Be Traded",value:t.can_be_traded?"Yes":"No"}),(0,z.jsx)(r,{label:"Can Be Redeemed",value:t.can_be_redeemed?"Yes":"No"}),(0,z.jsx)(H.A,{sx:{my:3}}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Holder Information"}),(0,z.jsx)(r,{label:"Name",value:"".concat(t.holder.first_name," ").concat(t.holder.last_name)}),(0,z.jsx)(r,{label:"Phone",value:t.holder.phone_number}),(0,z.jsx)(r,{label:"Email",value:t.holder.email||"N/A"}),(0,z.jsx)(r,{label:"Role",value:t.holder.role.toUpperCase()}),(0,z.jsx)(H.A,{sx:{my:3}}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Deposit Information"}),(0,z.jsx)(r,{label:"Farmer",value:"".concat(t.deposit.farmer.first_name," ").concat(t.deposit.farmer.last_name)}),(0,z.jsx)(r,{label:"Hub",value:t.deposit.hub.name}),(0,z.jsx)(r,{label:"Grain Type",value:t.deposit.grain_type_details.name}),(0,z.jsx)(r,{label:"Quality Grade",value:t.deposit.quality_grade_details.name}),(0,z.jsx)(r,{label:"Quantity",value:"".concat(parseFloat(t.deposit.quantity_kg).toFixed(2)," kg")}),(0,z.jsx)(r,{label:"Moisture Level",value:"".concat(parseFloat(t.deposit.moisture_level).toFixed(2),"%")}),(0,z.jsx)(r,{label:"Deposit Date",value:(0,P.pU)(t.deposit.deposit_date)}),(0,z.jsx)(r,{label:"Validated",value:t.deposit.validated?"Yes":"No"}),t.deposit.agent&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(H.A,{sx:{my:2}}),(0,z.jsx)(r,{label:"Agent",value:"".concat(t.deposit.agent.first_name," ").concat(t.deposit.agent.last_name)})]}),t.verified_by&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(H.A,{sx:{my:3}}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Verification Information"}),(0,z.jsx)(r,{label:"Verified By",value:"".concat(t.verified_by.first_name," ").concat(t.verified_by.last_name)}),(0,z.jsx)(r,{label:"Verified At",value:t.verified_at?(0,P.pU)(t.verified_at):"N/A"})]}),t.deposit.notes&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(H.A,{sx:{my:3}}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Notes"}),(0,z.jsx)(p.A,{variant:"body2",color:"textSecondary",children:t.deposit.notes})]})]})}),(0,z.jsx)(g.A,{children:(0,z.jsx)(n,{})})]})};var U=a(23722);const B=e=>{var t;let{redemption:a,handleClose:r,onUpdate:n}=e;const[l,o]=(0,s.useState)(!1),[c,A]=(0,s.useState)(!1),[v,y]=(0,s.useState)(!1),[f,b]=(0,s.useState)(!1),[C,S]=(0,s.useState)(""),[R,k]=(0,s.useState)("");if(!a)return null;const W=e=>{let{label:t,value:a,highlight:r=!1}=e;return(0,z.jsxs)(L.Ay,{container:!0,spacing:2,sx:{mb:1.5},children:[(0,z.jsx)(L.Ay,{item:!0,xs:5,children:(0,z.jsxs)(p.A,{variant:"body2",color:"textSecondary",fontWeight:600,children:[t,":"]})}),(0,z.jsx)(L.Ay,{item:!0,xs:7,children:(0,z.jsx)(p.A,{variant:"body2",fontWeight:r?600:400,color:r?"primary":"textPrimary",children:a})})]})},V=()=>{const e="pending"===a.status,t="approved"===a.status;return(0,z.jsxs)(i.A,{sx:{display:"flex",gap:1},children:[(0,z.jsx)(d.A,{onClick:r,children:"Close"}),e&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(d.A,{variant:"outlined",color:"error",onClick:()=>y(!0),children:"Reject"}),(0,z.jsx)(d.A,{variant:"contained",color:"success",onClick:()=>A(!0),children:"Approve"})]}),t&&(0,z.jsx)(d.A,{variant:"contained",color:"primary",onClick:()=>b(!0),children:"Mark as Paid"})]})};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(u.A,{open:!0,onClose:r,maxWidth:"md",fullWidth:!0,sx:{zIndex:1300},children:[(0,z.jsx)(h.A,{children:"Redemption Details"}),(0,z.jsx)(x.A,{children:(0,z.jsxs)(i.A,{sx:{p:2},children:[(0,z.jsx)(D.A,{elevation:0,sx:{p:2,bgcolor:"grey.50",mb:3},children:(0,z.jsxs)(L.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,z.jsxs)(L.Ay,{item:!0,xs:12,sm:6,children:[(0,z.jsx)(p.A,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:"Status"}),(0,z.jsx)(w.A,{label:a.status.toUpperCase(),color:(F=a.status,{pending:"warning",approved:"info",rejected:"error",paid:"success"}[F]||"default"),sx:{fontWeight:600}})]}),(0,z.jsxs)(L.Ay,{item:!0,xs:12,sm:6,children:[(0,z.jsx)(p.A,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:"Payment Method"}),(0,z.jsx)(p.A,{variant:"body2",fontWeight:600,children:(null===(t=a.payment_method)||void 0===t?void 0:t.replace("_"," ").toUpperCase())||"N/A"})]})]})}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mt:2,mb:2},children:"Financial Summary"}),(0,z.jsxs)(D.A,{elevation:0,sx:{p:2,bgcolor:"primary.50",mb:2},children:[(0,z.jsx)(W,{label:"Redemption Amount",value:"UGX ".concat(parseFloat(a.amount).toLocaleString()),highlight:!0}),(0,z.jsx)(W,{label:"Fees",value:"UGX ".concat(parseFloat(a.fee).toLocaleString())}),(0,z.jsx)(H.A,{sx:{my:1}}),(0,z.jsx)(W,{label:"Net Payout",value:"UGX ".concat(parseFloat(a.net_payout).toLocaleString()),highlight:!0})]}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mt:3,mb:2},children:"Redemption Information"}),(0,z.jsx)(W,{label:"Request Date",value:(0,P.pU)(a.request_date)}),(0,z.jsx)(W,{label:"Redemption ID",value:a.id.substring(0,16)+"..."}),(0,z.jsx)(H.A,{sx:{my:3}}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Requester Information"}),(0,z.jsx)(W,{label:"Name",value:"".concat(a.requester.first_name," ").concat(a.requester.last_name)}),(0,z.jsx)(W,{label:"Phone",value:a.requester.phone_number}),(0,z.jsx)(W,{label:"Email",value:a.requester.email||"N/A"}),(0,z.jsx)(W,{label:"Role",value:a.requester.role.toUpperCase()}),(0,z.jsx)(H.A,{sx:{my:3}}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Associated Voucher"}),(0,z.jsx)(W,{label:"GRN Number",value:a.voucher_details.grn_number}),(0,z.jsx)(W,{label:"Current Voucher Value",value:"UGX ".concat(parseFloat(a.voucher_details.current_value).toLocaleString())}),(0,z.jsx)(W,{label:"Grain Type",value:a.voucher_details.deposit.grain_type_details.name}),(0,z.jsx)(W,{label:"Quantity",value:"".concat(parseFloat(a.voucher_details.deposit.quantity_kg).toFixed(2)," kg")}),(0,z.jsx)(W,{label:"Hub",value:a.voucher_details.deposit.hub.name}),a.notes&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(H.A,{sx:{my:3}}),(0,z.jsx)(p.A,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:"Notes"}),(0,z.jsx)(p.A,{variant:"body2",color:"textSecondary",children:a.notes})]})]})}),(0,z.jsx)(g.A,{children:(0,z.jsx)(V,{})})]}),(0,z.jsxs)(u.A,{open:c,onClose:()=>A(!1),children:[(0,z.jsx)(h.A,{children:"Approve Redemption"}),(0,z.jsx)(x.A,{children:(0,z.jsxs)(p.A,{children:["Are you sure you want to approve this redemption request for"," ",(0,z.jsxs)("strong",{children:["UGX ",parseFloat(a.net_payout).toLocaleString()]}),"?"]})}),(0,z.jsxs)(g.A,{children:[(0,z.jsx)(d.A,{onClick:()=>A(!1),disabled:l,children:"Cancel"}),(0,z.jsx)(d.A,{onClick:async()=>{o(!0);try{await _.approveRedemption(a.id),j.oR.success("Redemption approved successfully"),A(!1),n&&n(),r()}catch(e){j.oR.error(e.message||"Failed to approve redemption")}finally{o(!1)}},variant:"contained",color:"success",disabled:l,children:l?(0,z.jsx)(U.A,{size:20}):"Approve"})]})]}),(0,z.jsxs)(u.A,{open:v,onClose:()=>y(!1),children:[(0,z.jsx)(h.A,{children:"Reject Redemption"}),(0,z.jsxs)(x.A,{children:[(0,z.jsx)(p.A,{gutterBottom:!0,children:"Please provide a reason for rejecting this redemption:"}),(0,z.jsx)(m.A,{fullWidth:!0,multiline:!0,rows:3,value:C,onChange:e=>S(e.target.value),placeholder:"Enter rejection reason...",sx:{mt:2}})]}),(0,z.jsxs)(g.A,{children:[(0,z.jsx)(d.A,{onClick:()=>y(!1),disabled:l,children:"Cancel"}),(0,z.jsx)(d.A,{onClick:async()=>{if(C.trim()){o(!0);try{await _.rejectRedemption(a.id,{reason:C}),j.oR.success("Redemption rejected"),y(!1),n&&n(),r()}catch(e){j.oR.error(e.message||"Failed to reject redemption")}finally{o(!1)}}else j.oR.error("Please provide a reason for rejection")},variant:"contained",color:"error",disabled:l,children:l?(0,z.jsx)(U.A,{size:20}):"Reject"})]})]}),(0,z.jsxs)(u.A,{open:f,onClose:()=>b(!1),children:[(0,z.jsx)(h.A,{children:"Confirm Payment"}),(0,z.jsxs)(x.A,{children:[(0,z.jsxs)(p.A,{gutterBottom:!0,children:["Confirm that payment of"," ",(0,z.jsxs)("strong",{children:["UGX ",parseFloat(a.net_payout).toLocaleString()]})," ","has been made to ",a.requester.first_name," ",a.requester.last_name,"."]}),(0,z.jsx)(m.A,{fullWidth:!0,multiline:!0,rows:2,value:R,onChange:e=>k(e.target.value),placeholder:"Optional: Add payment notes (transaction ID, etc.)...",sx:{mt:2},label:"Payment Notes"})]}),(0,z.jsxs)(g.A,{children:[(0,z.jsx)(d.A,{onClick:()=>b(!1),disabled:l,children:"Cancel"}),(0,z.jsx)(d.A,{onClick:async()=>{o(!0);try{await _.markRedemptionPaid(a.id,{notes:R}),j.oR.success("Redemption marked as paid"),b(!1),n&&n(),r()}catch(e){j.oR.error(e.message||"Failed to mark as paid")}finally{o(!1)}},variant:"contained",color:"primary",disabled:l,children:l?(0,z.jsx)(U.A,{size:20}):"Confirm Payment"})]})]})]});var F};var M=a(53193),G=a(18356),q=a(72221),T=a(32143),E=a(28242),X=a(10155);const Y=e=>{let{filters:t,onFilterChange:a,onClearFilters:n}=e;const s=(e,n)=>{a((0,r.A)((0,r.A)({},t),{},{[e]:n,page:1}))};return(0,z.jsxs)(i.A,{sx:{display:"flex",gap:2,flexWrap:"wrap",alignItems:"center",mb:2},children:[(0,z.jsx)(E.A,{color:"action"}),(0,z.jsxs)(M.A,{size:"small",sx:{minWidth:150},children:[(0,z.jsx)(G.A,{children:"Status"}),(0,z.jsxs)(q.A,{value:t.status||"",onChange:e=>s("status",e.target.value),label:"Status",children:[(0,z.jsx)(T.A,{value:"",children:"All"}),(0,z.jsx)(T.A,{value:"issued",children:"Issued"}),(0,z.jsx)(T.A,{value:"pending_verification",children:"Pending Verification"}),(0,z.jsx)(T.A,{value:"transferred",children:"Transferred"}),(0,z.jsx)(T.A,{value:"redeemed",children:"Redeemed"}),(0,z.jsx)(T.A,{value:"expired",children:"Expired"})]})]}),(0,z.jsxs)(M.A,{size:"small",sx:{minWidth:180},children:[(0,z.jsx)(G.A,{children:"Verification Status"}),(0,z.jsxs)(q.A,{value:t.verification_status||"",onChange:e=>s("verification_status",e.target.value),label:"Verification Status",children:[(0,z.jsx)(T.A,{value:"",children:"All"}),(0,z.jsx)(T.A,{value:"verified",children:"Verified"}),(0,z.jsx)(T.A,{value:"pending",children:"Pending"}),(0,z.jsx)(T.A,{value:"rejected",children:"Rejected"})]})]}),(0,z.jsx)(d.A,{variant:"outlined",size:"small",startIcon:(0,z.jsx)(X.A,{}),onClick:n,children:"Clear Filters"})]})},Q=e=>{let{filters:t,onFilterChange:a,onClearFilters:n}=e;const s=(e,n)=>{a((0,r.A)((0,r.A)({},t),{},{[e]:n,page:1}))};return(0,z.jsxs)(i.A,{sx:{display:"flex",gap:2,flexWrap:"wrap",alignItems:"center",mb:2},children:[(0,z.jsx)(E.A,{color:"action"}),(0,z.jsxs)(M.A,{size:"small",sx:{minWidth:150},children:[(0,z.jsx)(G.A,{children:"Status"}),(0,z.jsxs)(q.A,{value:t.status||"",onChange:e=>s("status",e.target.value),label:"Status",children:[(0,z.jsx)(T.A,{value:"",children:"All"}),(0,z.jsx)(T.A,{value:"pending",children:"Pending"}),(0,z.jsx)(T.A,{value:"approved",children:"Approved"}),(0,z.jsx)(T.A,{value:"rejected",children:"Rejected"}),(0,z.jsx)(T.A,{value:"paid",children:"Paid"})]})]}),(0,z.jsxs)(M.A,{size:"small",sx:{minWidth:180},children:[(0,z.jsx)(G.A,{children:"Payment Method"}),(0,z.jsxs)(q.A,{value:t.payment_method||"",onChange:e=>s("payment_method",e.target.value),label:"Payment Method",children:[(0,z.jsx)(T.A,{value:"",children:"All"}),(0,z.jsx)(T.A,{value:"cash",children:"Cash Pickup"}),(0,z.jsx)(T.A,{value:"mobile_money",children:"Mobile Money"}),(0,z.jsx)(T.A,{value:"bank_transfer",children:"Bank Transfer"}),(0,z.jsx)(T.A,{value:"check",children:"Bank Check"}),(0,z.jsx)(T.A,{value:"grain",children:"In-Kind Grain"})]})]}),(0,z.jsx)(d.A,{variant:"outlined",size:"small",startIcon:(0,z.jsx)(X.A,{}),onClick:n,children:"Clear Filters"})]})},O=e=>{var t;let{redemption:a,handleClose:n,onSuccess:l}=e;const[o,c]=(0,s.useState)(!1),[A,v]=(0,s.useState)({transaction_id:"",payment_reference:"",payment_date:(new Date).toISOString().split("T")[0],notes:"",confirmation_method:"system"}),y=(e,t)=>{v((0,r.A)((0,r.A)({},A),{},{[e]:t}))};return(0,z.jsxs)(u.A,{open:!0,onClose:n,maxWidth:"sm",fullWidth:!0,sx:{zIndex:1300},children:[(0,z.jsx)(h.A,{children:"Log Payment"}),(0,z.jsx)(x.A,{children:(0,z.jsxs)(i.A,{sx:{p:2},children:[(0,z.jsxs)(p.A,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:["Recording payment for redemption to"," ",(0,z.jsxs)("strong",{children:[a.requester.first_name," ",a.requester.last_name]})]}),(0,z.jsxs)(i.A,{sx:{p:2,bgcolor:"primary.50",borderRadius:1,my:2},children:[(0,z.jsxs)(p.A,{variant:"h6",color:"primary",children:["Amount: UGX ",parseFloat(a.net_payout).toLocaleString()]}),(0,z.jsxs)(p.A,{variant:"body2",color:"textSecondary",children:["Payment Method: ",null===(t=a.payment_method)||void 0===t?void 0:t.replace("_"," ").toUpperCase()]})]}),(0,z.jsxs)(L.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,z.jsx)(L.Ay,{item:!0,xs:12,children:(0,z.jsx)(m.A,{fullWidth:!0,required:!0,label:"Transaction ID / Reference Number",value:A.transaction_id,onChange:e=>y("transaction_id",e.target.value),placeholder:"Enter transaction ID or reference number"})}),(0,z.jsx)(L.Ay,{item:!0,xs:12,children:(0,z.jsx)(m.A,{fullWidth:!0,label:"Payment Reference",value:A.payment_reference,onChange:e=>y("payment_reference",e.target.value),placeholder:"Additional reference (optional)"})}),(0,z.jsx)(L.Ay,{item:!0,xs:12,children:(0,z.jsx)(m.A,{fullWidth:!0,type:"date",label:"Payment Date",value:A.payment_date,onChange:e=>y("payment_date",e.target.value),InputLabelProps:{shrink:!0}})}),(0,z.jsx)(L.Ay,{item:!0,xs:12,children:(0,z.jsxs)(M.A,{fullWidth:!0,children:[(0,z.jsx)(G.A,{children:"Confirmation Method"}),(0,z.jsxs)(q.A,{value:A.confirmation_method,onChange:e=>y("confirmation_method",e.target.value),label:"Confirmation Method",children:[(0,z.jsx)(T.A,{value:"system",children:"System Confirmation"}),(0,z.jsx)(T.A,{value:"manual",children:"Manual Verification"}),(0,z.jsx)(T.A,{value:"bank_statement",children:"Bank Statement"}),(0,z.jsx)(T.A,{value:"receipt",children:"Physical Receipt"})]})]})}),(0,z.jsx)(L.Ay,{item:!0,xs:12,children:(0,z.jsx)(m.A,{fullWidth:!0,multiline:!0,rows:3,label:"Payment Notes",value:A.notes,onChange:e=>y("notes",e.target.value),placeholder:"Add any additional notes about this payment..."})})]})]})}),(0,z.jsxs)(g.A,{children:[(0,z.jsx)(d.A,{onClick:n,disabled:o,children:"Cancel"}),(0,z.jsx)(d.A,{onClick:async()=>{if(A.transaction_id.trim()){c(!0);try{await _.markRedemptionPaid(a.id,(0,r.A)((0,r.A)({},A),{},{paid_amount:a.net_payout})),j.oR.success("Payment logged successfully"),l(),n()}catch(e){j.oR.error(e.message||"Failed to log payment")}finally{c(!1)}}else j.oR.error("Transaction ID is required")},variant:"contained",color:"primary",disabled:o,children:o?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(U.A,{color:"inherit",size:20})," ",(0,z.jsx)("span",{style:{marginLeft:"0.5rem"},children:"Logging..."})]}):"Confirm Payment"})]})]})};var Z=a(12110),K=a(26494),J=a(78185),$=a(90837),ee=a(20273),te=a(42400),ae=a(98606);const re=e=>{let{title:t,value:a,icon:r,color:n,loading:s}=e;return(0,z.jsx)(Z.A,{sx:{height:"100%"},children:(0,z.jsxs)(K.A,{children:[(0,z.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,z.jsx)(i.A,{sx:{p:1,borderRadius:1,bgcolor:"".concat(n,".50"),color:"".concat(n,".main"),mr:2},children:r}),(0,z.jsx)(p.A,{variant:"h6",color:"textSecondary",children:t})]}),s?(0,z.jsx)(J.A,{variant:"text",width:"60%",height:40}):(0,z.jsx)(p.A,{variant:"h4",fontWeight:600,children:a})]})})},ne=e=>{let{refreshTrigger:t=0}=e;const[a,r]=(0,s.useState)(!0),[n,l]=(0,s.useState)({totalVouchers:0,pendingVerification:0,pendingRedemptions:0,totalValue:0});(0,s.useEffect)((()=>{o()}),[t]);const o=async()=>{r(!0);try{var e;const[t,a,r]=await Promise.all([_.getMyVouchers({}),_.getPendingVerification({}),_.getRedemptions({status:"pending"})]),n=null===(e=t.results)||void 0===e?void 0:e.reduce(((e,t)=>e+parseFloat(t.current_value||0)),0);l({totalVouchers:t.count||0,pendingVerification:a.count||0,pendingRedemptions:r.count||0,totalValue:n||0})}catch(t){console.error("Error fetching stats:",t)}finally{r(!1)}};return(0,z.jsx)(i.A,{sx:{mb:3},children:(0,z.jsxs)(L.Ay,{container:!0,spacing:3,children:[(0,z.jsx)(L.Ay,{item:!0,xs:6,sm:6,md:3,children:(0,z.jsx)(re,{title:"Total Vouchers",value:n.totalVouchers.toLocaleString(),icon:(0,z.jsx)($.A,{}),color:"primary",loading:a})}),(0,z.jsx)(L.Ay,{item:!0,xs:6,sm:6,md:3,children:(0,z.jsx)(re,{title:"Pending Verification",value:n.pendingVerification.toLocaleString(),icon:(0,z.jsx)(ee.A,{}),color:"warning",loading:a})}),(0,z.jsx)(L.Ay,{item:!0,xs:6,sm:6,md:3,children:(0,z.jsx)(re,{title:"Pending Redemptions",value:n.pendingRedemptions.toLocaleString(),icon:(0,z.jsx)(te.A,{}),color:"error",loading:a})}),(0,z.jsx)(L.Ay,{item:!0,xs:6,sm:6,md:3,children:(0,z.jsx)(re,{title:"Total Value",value:"UGX ".concat(n.totalValue.toLocaleString()),icon:(0,z.jsx)(ae.A,{}),color:"success",loading:a})})]})})};var se=a(36644);const ie=["children","value","index"];function le(e){const{children:t,value:a,index:s}=e,l=(0,n.A)(e,ie);return(0,z.jsx)("div",(0,r.A)((0,r.A)({role:"tabpanel",hidden:a!==s,id:"voucher-tabpanel-".concat(s),"aria-labelledby":"voucher-tab-".concat(s)},l),{},{children:a===s&&(0,z.jsx)(i.A,{sx:{py:3},children:t})}))}const oe={tablePreHeader:{display:"flex",alignItems:"center",gap:2,marginBottom:2}},ce=()=>{(0,C.A)("Voucher/Redemption Management");const[e,t]=(0,s.useState)(0),[a,n]=(0,s.useState)(""),[S,L]=(0,s.useState)(!1),[D,H]=(0,s.useState)(!1),[M,G]=(0,s.useState)(""),[q,T]=(0,s.useState)(),[E,X]=(0,s.useState)({page:1}),[Z,K]=(0,s.useState)(null),[J,$]=(0,s.useState)(!1),[ee,te]=(0,s.useState)(),[ae,re]=(0,s.useState)({page:1}),[ie,ce]=(0,s.useState)(null),[de,ue]=(0,s.useState)(!1),[he,xe]=(0,s.useState)(),[pe,me]=(0,s.useState)({page:1}),[ge,je]=(0,s.useState)(!1),[Ae,ve]=(0,s.useState)(""),[ye,fe]=(0,s.useState)(null),[be,Ce]=(0,s.useState)(!1),[Se,_e]=(0,s.useState)(null),[Re,ke]=(0,s.useState)(0),[we,Pe]=(0,s.useState)(0),[We,Ve]=(0,s.useState)(0);(0,s.useEffect)((()=>{0===e?(Fe(E),ze()):1===e?(Ie(ae),ze()):2===e&&Le(pe)}),[e,E,ae,pe]);const ze=async()=>{try{const[e,t]=await Promise.all([_.getPendingVerification({}),_.getRedemptions({status:"pending"})]);ke(e.count||0),Pe(t.count||0)}catch(e){console.error("Error fetching pending counts:",e)}},Fe=async e=>{try{L(!0);const t=await _.getMyVouchers(e);T(t)}catch(t){console.error("Error fetching vouchers:",t),j.oR.error("Failed to fetch vouchers")}finally{L(!1)}},Ie=async e=>{try{L(!0);const t=await _.getRedemptions(e);console.log("Redemptions fetched:",t.results),te(t)}catch(t){console.error("Error fetching redemptions:",t),j.oR.error("Failed to fetch redemptions")}finally{L(!1)}},Le=async e=>{try{L(!0);const t=await _.getDeposits(e);xe(t)}catch(t){console.error("Error fetching deposits:",t),j.oR.error("Failed to fetch deposits")}finally{L(!1)}},De=t=>{const a=t.target.value;console.log("Search input changed:",a),n(a);const s={search:a,page:1};0===e?X((0,r.A)((0,r.A)({},E),s)):1===e?re((0,r.A)((0,r.A)({},ae),s)):2===e&&me((0,r.A)((0,r.A)({},pe),s))},He=()=>{Ce(!1),_e(null),$(!1),K(null),ue(!1),ce(null)},Ne=[{label:"View Details",icon:(0,z.jsx)(A.A,{}),onClick:e=>{console.log("View Details clicked for voucher:",e),K(e),$(!0),ue(!1),ce(null),Ce(!1),_e(null),je(!1),fe(null)}},{label:"Verify",icon:(0,z.jsx)(v.A,{}),onClick:e=>{console.log("Verify clicked for voucher:",e),fe(e),(async e=>{try{L(!0),await _.verifyVoucher(e.id),j.oR.success("Voucher verified successfully"),Fe(E),ze(),Ve((e=>e+1))}catch(t){j.oR.error(t.message||"Failed to verify voucher")}finally{L(!1)}})(e)},condition:e=>"pending"===e.verification_status},{label:"Reject",icon:(0,z.jsx)(y.A,{}),onClick:e=>{console.log("Reject clicked for voucher:",e),fe(e),je(!0),$(!1),K(null),ue(!1),ce(null),Ce(!1),_e(null)},condition:e=>"pending"===e.verification_status}],Ue=[{label:"View Details",icon:(0,z.jsx)(A.A,{}),onClick:e=>{console.log("View Details clicked for redemption:",e),ce(e),ue(!0),$(!1),K(null),Ce(!1),_e(null),je(!1),fe(null)}},{label:"Log Payment",icon:(0,z.jsx)(f.A,{}),onClick:e=>{console.log("Log Payment clicked for redemption:",e),_e(e),Ce(!0),$(!1),K(null),ue(!1),ce(null),je(!1),fe(null)},condition:e=>"approved"===e.status},{label:"Approve",icon:(0,z.jsx)(v.A,{}),onClick:e=>{console.log("Approve clicked for redemption:",e),_.approveRedemption(e.id).then((()=>{j.oR.success("Redemption approved successfully"),Ie(ae),ze(),Ve((e=>e+1))})).catch((e=>{j.oR.error(e.message||"Failed to approve redemption")}))},condition:e=>"pending"===e.status},{label:"Reject",icon:(0,z.jsx)(y.A,{}),onClick:e=>{console.log("Reject clicked for redemption:",e),ce(e),je(!0),$(!1),K(null),ue(!1),ce(null),Ce(!1),_e(null)},condition:e=>"pending"===e.status}],Be=[{label:"View Details",icon:(0,z.jsx)(A.A,{}),onClick:e=>{console.log("View Details clicked for deposit:",e)}},{label:"Validate",icon:(0,z.jsx)(v.A,{}),onClick:e=>{console.log("Validate clicked for deposit:",e),_.validateDeposit(e.id).then((()=>{j.oR.success("Deposit validated successfully"),Le(pe)})).catch((e=>{j.oR.error(e.message||"Failed to validate deposit")}))},condition:e=>!e.validated}];return(0,z.jsxs)(i.A,{sx:{p:2},children:[(0,z.jsx)(ne,{refreshTrigger:We}),(0,z.jsxs)(l.A,{value:e,onChange:(e,a)=>t(a),"aria-label":"voucher management tabs",children:[(0,z.jsx)(o.A,{label:(0,z.jsx)(c.A,{badgeContent:Re,color:"warning",children:"Vouchers"}),id:"voucher-tab-0"}),(0,z.jsx)(o.A,{label:(0,z.jsx)(c.A,{badgeContent:we,color:"error",children:"Redemptions"}),id:"voucher-tab-1"}),(0,z.jsx)(o.A,{label:"Deposits",id:"voucher-tab-2"})]}),(0,z.jsxs)(le,{value:e,index:0,children:[(0,z.jsxs)(i.A,{sx:oe.tablePreHeader,children:[(0,z.jsx)(R.A,{value:a,onChange:De,type:"text",placeholder:"Search vouchers..."}),(0,z.jsx)(d.A,{variant:"outlined",size:"small",startIcon:(0,z.jsx)(b.A,{}),onClick:()=>Fe(E),sx:{ml:"auto"},children:"Refresh"})]}),(0,z.jsx)(Y,{filters:E,onFilterChange:X,onClearFilters:()=>X({page:1})}),(0,z.jsx)(k.A,{columnShape:F(Ne,(e=>{console.log("View Details from table for voucher:",e),K(e),$(!0),ue(!1),ce(null),Ce(!1),_e(null),je(!1),fe(null)})),data:(null===q||void 0===q?void 0:q.results)||[],dataCount:(null===q||void 0===q?void 0:q.count)||0,pageInitialState:{pageSize:se.hk,pageIndex:0},setPageIndex:e=>X((0,r.A)((0,r.A)({},E),{},{page:e})),pageIndex:(null===E||void 0===E?void 0:E.page)||1,setPageSize:e=>X((0,r.A)((0,r.A)({},E),{},{page_size:e})),loading:S})]}),(0,z.jsxs)(le,{value:e,index:1,children:[(0,z.jsxs)(i.A,{sx:oe.tablePreHeader,children:[(0,z.jsx)(R.A,{value:a,onChange:De,type:"text",placeholder:"Search redemptions..."}),(0,z.jsx)(d.A,{variant:"outlined",size:"small",startIcon:(0,z.jsx)(b.A,{}),onClick:()=>Ie(ae),sx:{ml:"auto"},children:"Refresh"})]}),(0,z.jsx)(Q,{filters:ae,onFilterChange:re,onClearFilters:()=>re({page:1})}),(0,z.jsx)(k.A,{columnShape:(Me=Ue,[{Header:"Redemption ID",accessor:"id",minWidth:150,Cell:e=>{let{row:t}=e;return(0,z.jsxs)(V.L9,{sx:{fontSize:12,fontWeight:600},children:[t.original.id.substring(0,8),"..."]})}},{Header:"Requester",accessor:"requester",minWidth:150,Cell:e=>{let{row:t}=e;const{requester:a}=t.original;return(0,z.jsxs)(V.L9,{sx:{fontSize:12},children:[null===a||void 0===a?void 0:a.first_name," ",null===a||void 0===a?void 0:a.last_name]})}},{Header:"GRN Number",accessor:"voucher_details.grn_number",minWidth:150,Cell:e=>{var t;let{row:a}=e;return(0,z.jsx)(V.L9,{sx:{fontSize:12},children:(null===(t=a.original.voucher_details)||void 0===t?void 0:t.grn_number)||"N/A"})}},{Header:"Amount",accessor:"amount",minWidth:120,Cell:e=>{let{row:t}=e;return(0,z.jsxs)(V.L9,{sx:{fontSize:12,fontWeight:600},children:["UGX ",parseFloat(t.original.amount||"0").toLocaleString()]})}},{Header:"Fee",accessor:"fee",minWidth:100,Cell:e=>{let{row:t}=e;return(0,z.jsxs)(V.L9,{sx:{fontSize:12,color:"error.main"},children:["UGX ",parseFloat(t.original.fee||"0").toLocaleString()]})}},{Header:"Net Payout",accessor:"net_payout",minWidth:120,Cell:e=>{let{row:t}=e;return(0,z.jsxs)(V.L9,{sx:{fontSize:12,fontWeight:600,color:"success.main"},children:["UGX ",parseFloat(t.original.net_payout||"0").toLocaleString()]})}},{Header:"Payment Method",accessor:"payment_method",minWidth:130,Cell:e=>{var t;let{row:a}=e;return(0,z.jsx)(V.L9,{sx:{fontSize:12},children:(null===(t=a.original.payment_method)||void 0===t?void 0:t.replace("_"," ").toUpperCase())||"N/A"})}},{Header:"Status",accessor:"status",minWidth:120,Cell:e=>{let{row:t}=e;const a=t.original.status;return(0,z.jsx)(w.A,{label:a.toUpperCase(),color:{pending:"warning",approved:"info",rejected:"error",paid:"success"}[a]||"default",size:"small"})}},{Header:"Request Date",accessor:"request_date",minWidth:120,Cell:e=>{let{row:t}=e;return(0,z.jsx)(V.L9,{sx:{fontSize:12},children:(0,P.pU)(t.original.request_date)})}},{Header:"Action",accessor:"action",minWidth:100,maxWidth:100,Cell:e=>{let{row:t}=e;const a=t.original;return(0,z.jsx)(W.A,{actions:Me,metaData:a},t.id)}}]),data:(null===ee||void 0===ee?void 0:ee.results)||[],dataCount:(null===ee||void 0===ee?void 0:ee.count)||0,pageInitialState:{pageSize:se.hk,pageIndex:0},setPageIndex:e=>re((0,r.A)((0,r.A)({},ae),{},{page:e})),pageIndex:(null===ae||void 0===ae?void 0:ae.page)||1,setPageSize:e=>re((0,r.A)((0,r.A)({},ae),{},{page_size:e})),loading:S})]}),(0,z.jsxs)(le,{value:e,index:2,children:[(0,z.jsxs)(i.A,{sx:oe.tablePreHeader,children:[(0,z.jsx)(R.A,{value:a,onChange:De,type:"text",placeholder:"Search deposits..."}),(0,z.jsx)(d.A,{variant:"outlined",size:"small",startIcon:(0,z.jsx)(b.A,{}),onClick:()=>Le(pe),sx:{ml:"auto"},children:"Refresh"})]}),(0,z.jsx)(k.A,{columnShape:I(Be),data:(null===he||void 0===he?void 0:he.results)||[],dataCount:(null===he||void 0===he?void 0:he.count)||0,pageInitialState:{pageSize:se.hk,pageIndex:0},setPageIndex:e=>me((0,r.A)((0,r.A)({},pe),{},{page:e})),pageIndex:(null===pe||void 0===pe?void 0:pe.page)||1,setPageSize:e=>me((0,r.A)((0,r.A)({},pe),{},{page_size:e})),loading:S})]}),J&&Z&&(0,z.jsx)(N,{voucher:Z,handleClose:()=>{$(!1),K(null),ue(!1),ce(null),Ce(!1),_e(null)},onUpdate:()=>Fe(E)}),de&&ie&&(0,z.jsx)(B,{redemption:ie,handleClose:()=>{ue(!1),ce(null),$(!1),K(null),Ce(!1),_e(null)},onUpdate:()=>{Ie(ae),ze(),Ve((e=>e+1))}}),be&&Se&&(0,z.jsx)(O,{redemption:Se,handleClose:He,onSuccess:()=>{Ie(ae),ze(),Ve((e=>e+1)),He()}}),ge&&(0,z.jsxs)(u.A,{open:ge,onClose:()=>{je(!1),G(""),ve(""),fe(null)},children:[(0,z.jsx)(h.A,{children:ye?"Reject Voucher":"Reject Redemption"}),(0,z.jsxs)(x.A,{children:[(0,z.jsxs)(p.A,{gutterBottom:!0,children:["Please provide a reason for rejecting this ",ye?"voucher":"redemption",":"]}),(0,z.jsx)(m.A,{fullWidth:!0,multiline:!0,rows:3,value:Ae,onChange:e=>{ve(e.target.value),e.target.value.trim().length>=5&&G("")},placeholder:"Enter rejection reason (minimum 5 characters)...",error:!!M,helperText:M,sx:{mt:2}})]}),(0,z.jsxs)(g.A,{children:[(0,z.jsx)(d.A,{onClick:()=>{je(!1),G(""),ve(""),fe(null)},disabled:D,children:"Cancel"}),(0,z.jsx)(d.A,{onClick:ye?async()=>{if(ye)if(Ae.trim().length<5)G("Please provide a reason (minimum 5 characters)");else try{H(!0),await _.rejectVoucher(ye.id,{reason:Ae}),j.oR.success("Voucher rejected successfully"),je(!1),ve(""),G(""),Fe(E),ze(),Ve((e=>e+1))}catch(e){j.oR.error(e.message||"Failed to reject voucher")}finally{H(!1)}}:async()=>{if(ie)if(Ae.trim().length<5)G("Please provide a reason (minimum 5 characters)");else try{H(!0),await _.rejectRedemption(ie.id,{reason:Ae}),j.oR.success("Redemption rejected successfully"),je(!1),ve(""),G(""),Ie(ae),ze(),Ve((e=>e+1))}catch(e){j.oR.error(e.message||"Failed to reject redemption")}finally{H(!1)}},variant:"contained",color:"error",disabled:D,children:D?(0,z.jsx)(U.A,{size:20}):"Reject"})]})]})]});var Me}},49250:(e,t,a)=>{a.d(t,{A:()=>i});var r=a(89379),n=a(8122),s=a(70579);const i=e=>(0,s.jsxs)(n.A,(0,r.A)((0,r.A)({viewBox:"0 0 20 20"},e),{},{children:[(0,s.jsx)("path",{d:"M8.80758 0C3.95121 0 0 3.95121 0 8.80758C0 13.6642 3.95121 17.6152 8.80758 17.6152C13.6642 17.6152 17.6152 13.6642 17.6152 8.80758C17.6152 3.95121 13.6642 0 8.80758 0ZM8.80758 15.9892C4.84769 15.9892 1.62602 12.7675 1.62602 8.80762C1.62602 4.84773 4.84769 1.62602 8.80758 1.62602C12.7675 1.62602 15.9891 4.84769 15.9891 8.80758C15.9891 12.7675 12.7675 15.9892 8.80758 15.9892Z",fill:"currentColor"}),(0,s.jsx)("path",{d:"M19.7617 18.6124L15.1005 13.9511C14.7829 13.6335 14.2685 13.6335 13.9509 13.9511C13.6332 14.2684 13.6332 14.7834 13.9509 15.1007L18.6121 19.762C18.7709 19.9208 18.9788 20.0002 19.1869 20.0002C19.3948 20.0002 19.6029 19.9208 19.7617 19.762C20.0794 19.4446 20.0794 18.9297 19.7617 18.6124Z",fill:"currentColor"})]}))},61408:(e,t,a)=>{a.d(t,{A:()=>_});var r=a(89379),n=a(14126),s=a(34535),i=a(59135),l=a(26240),o=a(96446),c=a(71806),d=a(84882),u=a(28076),h=a(10039),x=a(73460),p=a(67024),m=a(72949),g=a(65043),j=a(71094),A=a(6905),v=a(42438),y=a(70579);const f=e=>{let{message:t}=e;return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(o.A,{sx:{width:"100%",color:"text.disabled"},children:(0,y.jsx)("p",{className:"font13",style:{fontWeight:500,color:"text.disabled"},children:t})})})};var b=a(32513),C=a(55935);const S=(0,s.Ay)(i.A)((e=>{let{theme:t}=e;return{"& .MuiPaginationItem-root":{fontSize:12,fontWeight:500,color:t.palette.text.disabled},"& .MuiPaginationItem-page:hover":{borderRadius:20,backgroundColor:"transparent",color:t.palette.primary.main,border:"1px solid ".concat(t.palette.primary.main)},"& .MuiPaginationItem-page.Mui-selected":{borderRadius:20,backgroundColor:"transparent",color:t.palette.primary.main,border:"1px solid ".concat(t.palette.primary.main)},"& .MuiPaginationItem-previousNext":{margin:10,borderRadius:20,color:t.palette.primary.main,border:"1px solid ".concat(t.palette.primary.main),"&:hover":{backgroundColor:"transparent"}}}})),_=e=>{const{data:t,rowClick:a,showFooter:s,columnShape:i,hidePagination:_=!1,dataCount:R,pageInitialState:k,setPageIndex:w,pageIndex:P,loading:W}=e,V=(0,l.A)(),z=(0,g.useMemo)((()=>t),[t]),F=(0,g.useMemo)((()=>i),[i]),I=(0,g.useMemo)((()=>k),[k]),{getTableProps:L,getTableBodyProps:D,headerGroups:H,prepareRow:N,page:U,state:{pageSize:B},setPageSize:M}=(0,j.useTable)({columns:F,data:z,initialState:I},j.useSortBy,j.useExpanded,j.usePagination,j.useRowSelect);return(0,g.useEffect)((()=>{M(k.pageSize)}),[k,M]),(0,y.jsxs)(o.A,{children:[(0,y.jsx)("div",{className:"table-responsive whiteBg",style:{borderRadius:10,border:"1px solid #eee"},children:(0,y.jsxs)(c.A,(0,r.A)((0,r.A)({},L()),{},{sx:{borderSpacing:"0 0.2rem",borderCollapse:"separate"},children:[(0,y.jsx)(d.A,{children:H.map((e=>(0,y.jsxs)(u.A,(0,r.A)((0,r.A)({},e.getHeaderGroupProps()),{},{children:[(0,y.jsx)(h.A,{sx:{paddingY:1,fontSize:13,width:10},children:"#"}),e.headers.map((e=>(0,y.jsx)(h.A,(0,r.A)((0,r.A)({},e.getHeaderProps(e.getSortByToggleProps())),{},{sx:{paddingY:0,fontSize:13,fontWeight:600,color:"text.black",width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth,"&:last-child":{textAlign:"center"}},children:e.render("Header")}))))]}))))}),(0,y.jsx)(x.A,(0,r.A)((0,r.A)({},D()),{},{children:W?(0,y.jsx)(u.A,{children:(0,y.jsx)(h.A,{colSpan:F.length+1,sx:{textAlign:"left"},children:(0,y.jsx)(b.a,{})})}):U.length>0?U.map(((e,t)=>{var n;return N(e),(0,y.jsxs)(u.A,(0,r.A)((0,r.A)({},e.getRowProps()),{},{onClick:a&&a(e.original),sx:{backgroundColor:null!==(n=e.original)&&void 0!==n&&n.has_error?"pink":1&t?"background.paper":C.j3,borderTop:"1.5px solid ".concat(C.j3),cursor:a?"pointer":"unset","& td:first-of-type":{},"& td:last-of-type":{textAlign:"center"},"&:last-of-type .MuiTableCell-root":{borderBottom:"dark"===V.palette.mode?"1px solid ".concat(V.palette.divider," !important"):"1px solid ".concat(V.palette.text.secondary," !important")},borderSpacing:5},children:[(0,y.jsx)(h.A,{sx:{fontSize:12,fontWeight:500,paddingY:1.2,color:"text.black","&:last-of-type div.css-o3rlxk":{display:"flex",justifyContent:"center"}},children:100*((P||1)-1)+t+1}),e.cells.map((e=>(0,y.jsx)(h.A,(0,r.A)((0,r.A)({},e.getCellProps()),{},{sx:{fontSize:12,fontWeight:500,paddingY:1.2,color:"text.black","&:last-of-type div.css-o3rlxk":{display:"flex",justifyContent:"center"}},children:null===e||void 0===e?void 0:e.render("Cell")}))))]}))})):(0,y.jsx)(u.A,{sx:{borderBottomWidth:0,borderColor:"white"},children:(0,y.jsx)(h.A,{colSpan:F.length+1,sx:{textAlign:"center"},children:(0,y.jsx)(f,{message:"No Data Available"})})})}))]}))}),!_&&(0,y.jsx)(p.A,{alignItems:"flex-end",marginY:1,children:(0,y.jsx)(S,{count:Math.ceil(R/B),shape:"rounded",page:P,onChange:(e,t)=>{w(t)}})}),s&&(0,y.jsxs)(A.A,{alignItems:"center",justifyContent:"space-between",children:[(0,y.jsx)(v.H5,{color:"text.disabled",children:"Showing 1-12 of 24 result"}),(0,y.jsxs)(m.A,{disableRipple:!0,sx:{fontSize:14,fontWeight:600},children:["See All",(0,y.jsx)(n.A,{sx:{marginLeft:.5}})]})]})]})}},64093:(e,t,a)=>{a.d(t,{A:()=>c});var r=a(89379),n=a(34535),s=a(62559),i=a(49250),l=a(70579);const o=(0,n.Ay)(s.Ay)((e=>{let{theme:t}=e;return{height:35,fontSize:13,width:"100%",maxWidth:270,fontWeight:500,padding:"0 1rem",borderRadius:"8px",border:"1px solid ",borderColor:"light"===t.palette.mode?t.palette.secondary[300]:t.palette.divider,color:t.palette.text.primary,backgroundColor:t.palette.background.paper,[t.breakpoints.down(500)]:{maxWidth:"100%"}}})),c=e=>(0,l.jsx)(o,(0,r.A)((0,r.A)({},e),{},{sx:(0,r.A)({justifyContent:"initial"},e.sx),startAdornment:(0,l.jsx)(i.A,{sx:{fontSize:13,marginRight:1,color:"#bbb"}})}))}}]);
//# sourceMappingURL=6699.e2a132fc.chunk.js.map