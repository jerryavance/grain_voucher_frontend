"use strict";(self.webpackChunkgrain_voucher_system=self.webpackChunkgrain_voucher_system||[]).push([[7396],{13194:(e,t,a)=>{a.d(t,{A:()=>n});var o=a(65043),r=a(95926);const n=e=>{const{title:t,setTitle:a}=(0,o.useContext)(r.C);return(0,o.useEffect)((()=>a(e)),[e,a]),t}},15238:(e,t,a)=>{a.d(t,{D:()=>r});var o=a(56629);const r={getUsers:async e=>o.A.get("auth/users/",{params:e}).then((e=>e.data)),getAvailableFarmers:async e=>o.A.get("vouchers/deposits/available_farmers",{params:e}).then((e=>e.data)),createUser:async e=>o.A.post("auth/users/",e).then((e=>e.data)),getUserDetails:async e=>o.A.get("auth/users/".concat(e,"/")).then((e=>e.data)),updateUser:async(e,t)=>o.A.patch("auth/users/".concat(t,"/"),e).then((e=>e.data)),deactivateUser:async e=>o.A.delete("auth/users/".concat(e,"/")).then((e=>e.data))}},23722:(e,t,a)=>{a.d(t,{A:()=>s});var o=a(89379),r=(a(65043),a(67024)),n=a(81637),i=a(70579);const s=e=>{let{size:t,color:a="primary",sx:s}=e;return(0,i.jsx)(r.A,{sx:(0,o.A)({color:"grey.500"},s),spacing:2,direction:"row",children:(0,i.jsx)(n.A,{size:t,color:a})})}},23817:(e,t,a)=>{a.d(t,{A:()=>c});var o=a(65043),r=a(17392),n=a(688),i=a(32143),s=a(42438),l=a(98082),d=a(70579);const c=e=>{let{actions:t,metaData:a,btnColor:c}=e;const[u,h]=(0,o.useState)(null),p=()=>{h(null)},x=t.filter((e=>!e.condition||e.condition(a)));return 0===x.length?null:(0,d.jsxs)("div",{children:[(0,d.jsx)(r.A,{size:"small",onClick:e=>{h(e.currentTarget)},children:(0,d.jsx)(l.A,{fontSize:"small"})}),(0,d.jsx)(n.A,{anchorEl:u,open:Boolean(u),onClose:p,children:x.map(((e,t)=>(0,d.jsxs)(i.A,{onClick:()=>(e=>{e.onClick(a),p()})(e),children:[e.icon,(0,d.jsx)(s.L9,{sx:{marginLeft:"0.5rem"},children:e.label})]},t)))})]})}},47396:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var o=a(89379),r=a(96446),n=a(8302),i=a(65043),s=a(23768),l=a(63471),d=a(13194),c=a(8433),u=a(15238),h=a(64093),p=a(61408),x=a(23817),g=a(42438),m=a(70579);const A=e=>[{Header:"First name",accessor:"first_name",minWidth:100},{Header:"Last name",accessor:"last_name",minWidth:100},{Header:"Phone",accessor:"phone_number",minWidth:200},{Header:"Email",accessor:"email",minWidth:100},{Header:"Role",accessor:"role",minWidth:100},{Header:"Location",accessor:"profile.location",minWidth:100,Cell:e=>{let{row:t}=e;const{profile:a}=t.original;return(0,m.jsxs)(g.L9,{sx:{fontSize:12},children:[(null===a||void 0===a?void 0:a.location)||"Unknown"," ",(null===a||void 0===a?void 0:a.gender)||"Unknown"]})}},{Header:"Action",accessor:"action",minWidth:100,maxWidth:100,Cell:t=>{let{row:a}=t;const o=a.original;return(0,m.jsx)(x.A,{actions:e,metaData:o},a.id)}}];var f=a(95540),v=a(63516),j=a(74523),b=a(23722),C=a(80644),y=a(25933),S=a(75992),k=a(24896),w=a(85452),z=a(33479);const W=e=>{let{handleClose:t,formType:a="Save",initialValues:o,callBack:l}=e;const d=(0,i.useRef)(null),[c,h]=(0,i.useState)(!1),[p,x]=(0,i.useState)(!1),A=(0,k.H)(p),f=(0,v.Wx)({initialValues:(0,y.f6)(A),validationSchema:(0,z.y)(p),validateOnChange:!1,validateOnMount:!1,validateOnBlur:!1,enableReinitialize:!0,onSubmit:e=>W(e)});(0,i.useEffect)((()=>{"Update"===a&&o&&f.setValues((0,y.RA)(A)(o||{}))}),[o,a]);const W=async e=>{h(!0);try{const r={gender:null===e||void 0===e?void 0:e.gender,date_of_birth:null===e||void 0===e?void 0:e.date_of_birth,country:null===e||void 0===e?void 0:e.country};e.profile=r,"Update"===a?(await u.D.updateUser(e,o.id),s.oR.success("User updated successfully"),f.resetForm(),l&&l(),t()):p?(await w.h.Register(e),s.oR.success("User created successfully"),f.resetForm(),l&&l(),t()):(await w.h.requestOtp(e.phone_number,"registration"),s.oR.success("OTP sent successfully"),x(!0)),h(!1)}catch(n){var r;h(!1),null!==(r=n.response)&&void 0!==r&&r.data&&f.setErrors(n.response.data),s.oR.error(n.message||"An error occurred")}},M=()=>{f.resetForm(),x(!1),t()},P=()=>{f.handleSubmit()},U=()=>"Save"===a&&p?(0,m.jsx)(n.A,{onClick:()=>x(!1),variant:"text",disabled:c,size:"small",children:"\u2190 Back to Phone Number"}):null;return(0,m.jsx)(j.A,{title:"Save"===a?"New User":"Edit User",onClose:M,id:(0,S.A)(),ActionButtons:()=>(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(n.A,{onClick:M,disabled:c,children:"Close"}),(0,m.jsx)(n.A,{onClick:P,type:"button",variant:"contained",disabled:c,children:c?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(b.A,{color:"inherit",size:20})," ",(0,m.jsx)(g.L9,{style:{marginLeft:"0.5rem"},color:"primary",children:"Loading..."})]}):"Update"===a?"Update User":p?"Create Account":"Request OTP"})]}),children:(0,m.jsx)("form",{ref:d,onSubmit:e=>{e.preventDefault(),W(f.values)},encType:"multipart/form-data",children:(0,m.jsxs)(r.A,{sx:{width:"100%"},children:[(0,m.jsx)(U,{}),(0,m.jsx)(C.A,{others:{sx:{marginBottom:"0rem"}},formikInstance:f,formFields:A,validationSchema:(0,z.y)(p)})]})})})};var M=a(36644);const P={tablePreHeader:{display:"flex",alignItems:"center",gap:2,marginBottom:2},createButton:{marginLeft:"auto",height:"fit-content"},pageSize:{maxWidth:60,marginLeft:2}},U=()=>{(0,d.A)("Users");const{setShowModal:e}=(0,c.k3)(),[t,a]=(0,i.useState)(null),[x,g]=(0,i.useState)("Save"),[v,j]=(0,i.useState)(""),[b,C]=(0,i.useState)(),[y,S]=(0,i.useState)(null),[k,w]=(0,i.useState)(!1);(0,i.useEffect)((()=>{z(y)}),[y]);const z=async e=>{try{w(!0);const t=await u.D.getUsers(e);C(t),w(!1)}catch(t){w(!1),console.error("Error fetching Teams:",t)}},U=async()=>{try{w(!0);const e=await u.D.getUsers(v);C(e),w(!1)}catch(e){w(!1)}},R=[{label:"Edit",icon:(0,m.jsx)(f.A,{color:"primary"}),onClick:t=>(t=>{g("Update"),a(t),setTimeout((()=>{e(!0)}))})(t)},{label:"Deactivate User",icon:(0,m.jsx)(l.A,{color:"error"}),onClick:e=>(async e=>{try{await u.D.deactivateUser(null===e||void 0===e?void 0:e.id),s.oR.success("User deactivated successfully"),U()}catch(t){s.oR.error("Something went wrong")}})(e)}];return(0,m.jsxs)(r.A,{pt:2,pb:4,children:[(0,m.jsxs)(r.A,{sx:P.tablePreHeader,children:[(0,m.jsx)(h.A,{value:v,onChange:e=>{const t=e.target.value;j(t)},type:"text",placeholder:"Search user..."}),(0,m.jsx)(n.A,{sx:{marginLeft:"auto"},variant:"contained",onClick:()=>{g("Save"),e(!0)},children:"Create"})]}),(0,m.jsx)(p.A,{columnShape:A(R),data:(null===b||void 0===b?void 0:b.results)||[],dataCount:(null===b||void 0===b?void 0:b.count)||0,pageInitialState:{pageSize:M.hk,pageIndex:0},setPageIndex:e=>S((0,o.A)((0,o.A)({},y),{},{page:e})),pageIndex:(null===y||void 0===y?void 0:y.page)||1,setPageSize:e=>S((0,o.A)((0,o.A)({},y),{},{page_size:e})),loading:k}),(0,m.jsx)(W,{callBack:U,formType:x,handleClose:()=>{e(!1)},initialValues:(0,o.A)((0,o.A)({},t),null===t||void 0===t?void 0:t.profile)})]})}},49250:(e,t,a)=>{a.d(t,{A:()=>i});var o=a(89379),r=a(8122),n=a(70579);const i=e=>(0,n.jsxs)(r.A,(0,o.A)((0,o.A)({viewBox:"0 0 20 20"},e),{},{children:[(0,n.jsx)("path",{d:"M8.80758 0C3.95121 0 0 3.95121 0 8.80758C0 13.6642 3.95121 17.6152 8.80758 17.6152C13.6642 17.6152 17.6152 13.6642 17.6152 8.80758C17.6152 3.95121 13.6642 0 8.80758 0ZM8.80758 15.9892C4.84769 15.9892 1.62602 12.7675 1.62602 8.80762C1.62602 4.84773 4.84769 1.62602 8.80758 1.62602C12.7675 1.62602 15.9891 4.84769 15.9891 8.80758C15.9891 12.7675 12.7675 15.9892 8.80758 15.9892Z",fill:"currentColor"}),(0,n.jsx)("path",{d:"M19.7617 18.6124L15.1005 13.9511C14.7829 13.6335 14.2685 13.6335 13.9509 13.9511C13.6332 14.2684 13.6332 14.7834 13.9509 15.1007L18.6121 19.762C18.7709 19.9208 18.9788 20.0002 19.1869 20.0002C19.3948 20.0002 19.6029 19.9208 19.7617 19.762C20.0794 19.4446 20.0794 18.9297 19.7617 18.6124Z",fill:"currentColor"})]}))},61408:(e,t,a)=>{a.d(t,{A:()=>k});var o=a(89379),r=a(14126),n=a(34535),i=a(59135),s=a(26240),l=a(96446),d=a(71806),c=a(84882),u=a(28076),h=a(10039),p=a(73460),x=a(67024),g=a(72949),m=a(65043),A=a(71094),f=a(6905),v=a(42438),j=a(70579);const b=e=>{let{message:t}=e;return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(l.A,{sx:{width:"100%",color:"text.disabled"},children:(0,j.jsx)("p",{className:"font13",style:{fontWeight:500,color:"text.disabled"},children:t})})})};var C=a(32513),y=a(55935);const S=(0,n.Ay)(i.A)((e=>{let{theme:t}=e;return{"& .MuiPaginationItem-root":{fontSize:12,fontWeight:500,color:t.palette.text.disabled},"& .MuiPaginationItem-page:hover":{borderRadius:20,backgroundColor:"transparent",color:t.palette.primary.main,border:"1px solid ".concat(t.palette.primary.main)},"& .MuiPaginationItem-page.Mui-selected":{borderRadius:20,backgroundColor:"transparent",color:t.palette.primary.main,border:"1px solid ".concat(t.palette.primary.main)},"& .MuiPaginationItem-previousNext":{margin:10,borderRadius:20,color:t.palette.primary.main,border:"1px solid ".concat(t.palette.primary.main),"&:hover":{backgroundColor:"transparent"}}}})),k=e=>{const{data:t,rowClick:a,showFooter:n,columnShape:i,hidePagination:k=!1,dataCount:w,pageInitialState:z,setPageIndex:W,pageIndex:M,loading:P}=e,U=(0,s.A)(),R=(0,m.useMemo)((()=>t),[t]),B=(0,m.useMemo)((()=>i),[i]),I=(0,m.useMemo)((()=>z),[z]),{getTableProps:L,getTableBodyProps:H,headerGroups:T,prepareRow:_,page:D,state:{pageSize:E},setPageSize:F}=(0,A.useTable)({columns:B,data:R,initialState:I},A.useSortBy,A.useExpanded,A.usePagination,A.useRowSelect);return(0,m.useEffect)((()=>{F(z.pageSize)}),[z,F]),(0,j.jsxs)(l.A,{children:[(0,j.jsx)("div",{className:"table-responsive whiteBg",style:{borderRadius:10,border:"1px solid #eee"},children:(0,j.jsxs)(d.A,(0,o.A)((0,o.A)({},L()),{},{sx:{borderSpacing:"0 0.2rem",borderCollapse:"separate"},children:[(0,j.jsx)(c.A,{children:T.map((e=>(0,j.jsxs)(u.A,(0,o.A)((0,o.A)({},e.getHeaderGroupProps()),{},{children:[(0,j.jsx)(h.A,{sx:{paddingY:1,fontSize:13,width:10},children:"#"}),e.headers.map((e=>(0,j.jsx)(h.A,(0,o.A)((0,o.A)({},e.getHeaderProps(e.getSortByToggleProps())),{},{sx:{paddingY:0,fontSize:13,fontWeight:600,color:"text.black",width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth,"&:last-child":{textAlign:"center"}},children:e.render("Header")}))))]}))))}),(0,j.jsx)(p.A,(0,o.A)((0,o.A)({},H()),{},{children:P?(0,j.jsx)(u.A,{children:(0,j.jsx)(h.A,{colSpan:B.length+1,sx:{textAlign:"left"},children:(0,j.jsx)(C.a,{})})}):D.length>0?D.map(((e,t)=>{var r;return _(e),(0,j.jsxs)(u.A,(0,o.A)((0,o.A)({},e.getRowProps()),{},{onClick:a&&a(e.original),sx:{backgroundColor:null!==(r=e.original)&&void 0!==r&&r.has_error?"pink":1&t?"background.paper":y.j3,borderTop:"1.5px solid ".concat(y.j3),cursor:a?"pointer":"unset","& td:first-of-type":{},"& td:last-of-type":{textAlign:"center"},"&:last-of-type .MuiTableCell-root":{borderBottom:"dark"===U.palette.mode?"1px solid ".concat(U.palette.divider," !important"):"1px solid ".concat(U.palette.text.secondary," !important")},borderSpacing:5},children:[(0,j.jsx)(h.A,{sx:{fontSize:12,fontWeight:500,paddingY:1.2,color:"text.black","&:last-of-type div.css-o3rlxk":{display:"flex",justifyContent:"center"}},children:100*((M||1)-1)+t+1}),e.cells.map((e=>(0,j.jsx)(h.A,(0,o.A)((0,o.A)({},e.getCellProps()),{},{sx:{fontSize:12,fontWeight:500,paddingY:1.2,color:"text.black","&:last-of-type div.css-o3rlxk":{display:"flex",justifyContent:"center"}},children:null===e||void 0===e?void 0:e.render("Cell")}))))]}))})):(0,j.jsx)(u.A,{sx:{borderBottomWidth:0,borderColor:"white"},children:(0,j.jsx)(h.A,{colSpan:B.length+1,sx:{textAlign:"center"},children:(0,j.jsx)(b,{message:"No Data Available"})})})}))]}))}),!k&&(0,j.jsx)(x.A,{alignItems:"flex-end",marginY:1,children:(0,j.jsx)(S,{count:Math.ceil(w/E),shape:"rounded",page:M,onChange:(e,t)=>{W(t)}})}),n&&(0,j.jsxs)(f.A,{alignItems:"center",justifyContent:"space-between",children:[(0,j.jsx)(v.H5,{color:"text.disabled",children:"Showing 1-12 of 24 result"}),(0,j.jsxs)(g.A,{disableRipple:!0,sx:{fontSize:14,fontWeight:600},children:["See All",(0,j.jsx)(r.A,{sx:{marginLeft:.5}})]})]})]})}},63471:(e,t,a)=>{var o=a(24994);t.A=void 0;var r=o(a(40039)),n=a(70579);t.A=(0,r.default)((0,n.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},64093:(e,t,a)=>{a.d(t,{A:()=>d});var o=a(89379),r=a(34535),n=a(62559),i=a(49250),s=a(70579);const l=(0,r.Ay)(n.Ay)((e=>{let{theme:t}=e;return{height:35,fontSize:13,width:"100%",maxWidth:270,fontWeight:500,padding:"0 1rem",borderRadius:"8px",border:"1px solid ",borderColor:"light"===t.palette.mode?t.palette.secondary[300]:t.palette.divider,color:t.palette.text.primary,backgroundColor:t.palette.background.paper,[t.breakpoints.down(500)]:{maxWidth:"100%"}}})),d=e=>(0,s.jsx)(l,(0,o.A)((0,o.A)({},e),{},{sx:(0,o.A)({justifyContent:"initial"},e.sx),startAdornment:(0,s.jsx)(i.A,{sx:{fontSize:13,marginRight:1,color:"#bbb"}})}))},74523:(e,t,a)=>{a.d(t,{A:()=>v});a(65043);var o=a(8302),r=a(34535),n=a(90035),i=a(4219),s=a(35316),l=a(29347),d=a(17392),c=a(74802),u=a(8433),h=a(42438),p=a(96446),x=a(10611),g=a(70579);const m=(0,r.Ay)(n.A)((e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}})),A=e=>{const{title:t,onClose:a,id:o}=e;return(0,g.jsxs)(i.A,{sx:{m:0,p:2},id:o,children:[(0,g.jsx)(h.L9,{sx:{fontSize:"1.2rem",fontWeight:"bold",padding:10,paddingLeft:0},children:t}),a?(0,g.jsx)(d.A,{"aria-label":"close",onClick:a,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,g.jsx)(c.A,{})}):null]})},f={loadingModalContentBackground:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"#fff",opacity:.6,zIndex:1e3,pointerEvents:"none"}},v=e=>{let{children:t,onClose:a,title:r,maxWidth:n,minWidth:i,ActionButtons:d,selectedModalId:c,open:h}=e;const{showModal:v,loadingModalContent:j,modalId:b}=(0,u.k3)();if(!v&&!h)return null;if(void 0!==b&&b!==c)return null;return(0,g.jsx)(p.A,{children:(0,g.jsxs)(m,{onClose:e=>{a()},"aria-labelledby":"customized-dialog-title",open:void 0!==h?h:v,maxWidth:n,sx:{"& .MuiPaper-root":{minWidth:i||0}},style:{borderRadius:"10px"},children:[j&&(0,g.jsx)(p.A,{sx:{width:"100%",zIndex:1200},children:(0,g.jsx)(x.A,{})}),(0,g.jsx)(p.A,{sx:j?f.loadingModalContentBackground:{}}),(0,g.jsx)(A,{id:"customized-dialog-title",title:r,onClose:a}),(0,g.jsx)(s.A,{dividers:!0,children:t}),(0,g.jsx)(l.A,{children:d?(0,g.jsx)(d,{}):(0,g.jsx)(o.A,{autoFocus:!0,onClick:a,children:"Cancel"})})]})})}},74802:(e,t,a)=>{var o=a(24994);t.A=void 0;var r=o(a(40039)),n=a(70579);t.A=(0,r.default)((0,n.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},95540:(e,t,a)=>{var o=a(24994);t.A=void 0;var r=o(a(40039)),n=a(70579);t.A=(0,r.default)((0,n.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")}}]);
//# sourceMappingURL=7396.594330a5.chunk.js.map