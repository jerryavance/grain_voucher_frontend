"use strict";(self.webpackChunkgrain_voucher_system=self.webpackChunkgrain_voucher_system||[]).push([[9907],{5243:(e,t,r)=>{r.d(t,{G:()=>a});var s=r(56629);const a={getVouchers:async e=>s.A.get("vouchers/vouchers/",{params:e}).then((e=>e.data)),getMyVouchers:async e=>s.A.get("vouchers/vouchers/my_vouchers/",{params:e}).then((e=>e.data)),getVouchersForPurchase:async e=>s.A.get("vouchers/vouchers/available_for_purchase/",{params:e}).then((e=>e.data)),getVoucherDetails:async e=>s.A.get("vouchers/vouchers/".concat(e,"/")).then((e=>e.data)),createVoucher:async e=>(console.log("Creating voucher:",e),s.A.post("vouchers/vouchers/",e).then((e=>e.data))),updateVoucher:async(e,t)=>(console.log("Updating voucher:",e),s.A.patch("vouchers/vouchers/".concat(t,"/"),e).then((e=>e.data))),deleteVoucher:async e=>(console.log("Deleting voucher:",e),s.A.delete("vouchers/vouchers/".concat(e,"/")).then((e=>e.data))),getRedemptions:async e=>s.A.get("vouchers/redemptions/",{params:e}).then((e=>e.data)),createRedemption:async e=>(console.log("Creating redemption:",e),s.A.post("vouchers/redemptions/",e).then((e=>e.data))),getRedemptionDetails:async e=>s.A.get("vouchers/redemptions/".concat(e,"/")).then((e=>e.data)),updateRedemption:async(e,t)=>s.A.patch("vouchers/redemptions/".concat(t,"/"),e).then((e=>e.data)),approveRedemption:async e=>s.A.post("vouchers/redemptions/".concat(e,"/approve/")).then((e=>e.data)),payRedemption:async e=>s.A.post("vouchers/redemptions/".concat(e,"/pay/")).then((e=>e.data)),deleteRedemption:async e=>s.A.delete("vouchers/redemptions/".concat(e,"/")).then((e=>e.data))}},12110:(e,t,r)=>{r.d(t,{A:()=>A});var s=r(58168),a=r(98587),n=r(65043),o=r(58387),c=r(65049),i=r(34535),l=r(98206),h=r(63336),d=r(14987),m=r(60239);function x(e){return(0,m.Ay)("MuiCard",e)}(0,d.A)("MuiCard",["root"]);var p=r(70579);const u=["className","raised"],g=(0,i.Ay)(h.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"}))),A=n.forwardRef((function(e,t){const r=(0,l.b)({props:e,name:"MuiCard"}),{className:n,raised:i=!1}=r,h=(0,a.A)(r,u),d=(0,s.A)({},r,{raised:i}),m=(e=>{const{classes:t}=e;return(0,c.A)({root:["root"]},x,t)})(d);return(0,p.jsx)(g,(0,s.A)({className:(0,o.A)(m.root,n),elevation:i?8:void 0,ref:t,ownerState:d},h))}))},13194:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(65043),a=r(95926);const n=e=>{const{title:t,setTitle:r}=(0,s.useContext)(a.C);return(0,s.useEffect)((()=>r(e)),[e,r]),t}},42796:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(66734),a=r(70579);const n=(0,s.A)((0,a.jsx)("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}),"TrendingUp")},47805:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(66734),a=r(70579);const n=(0,s.A)((0,a.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh")},60975:(e,t,r)=>{r.d(t,{X:()=>a});var s=r(56629);const a={getGrainTypes:async e=>s.A.get("vouchers/grain-types/",{params:e}).then((e=>e.data)),getGrainTypeDetails:async e=>s.A.get("vouchers/grain-types/".concat(e,"/")).then((e=>e.data)),createGrainTypes:async e=>(console.log(e),s.A.post("vouchers/grain-types/",e).then((e=>e.data))),updateGrainTypes:async(e,t)=>(console.log(e),s.A.patch("vouchers/grain-types/".concat(t,"/"),e).then((e=>e.data))),deleteGrainTypes:async e=>(console.log(e),s.A.delete("vouchers/grain-types/".concat(e,"/")).then((e=>e.data)))}},67729:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(66734),a=r(70579);const n=(0,s.A)((0,a.jsx)("path",{d:"M10 12c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2M6 8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m12-8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m-4 8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m4-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-4-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m-4-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"Grain")},69974:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(66734),a=r(70579);const n=(0,s.A)((0,a.jsx)("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"}),"Phone")},74851:(e,t,r)=>{r.d(t,{h:()=>a});var s=r(56629);const a={getPriceFeeds:async e=>s.A.get("vouchers/price-feeds/",{params:e}).then((e=>e.data)),getPriceFeedDetails:async e=>s.A.get("vouchers/price-feeds/".concat(e,"/")).then((e=>e.data)),createPriceFeeds:async e=>(console.log(e),s.A.post("vouchers/price-feeds/",e).then((e=>e.data))),updatePriceFeeds:async(e,t)=>(console.log(e),s.A.patch("vouchers/price-feeds/".concat(t,"/"),e).then((e=>e.data))),deletePriceFeeds:async e=>(console.log(e),s.A.delete("vouchers/price-feeds/".concat(e,"/")).then((e=>e.data)))}},91082:(e,t,r)=>{r.d(t,{A:()=>n});var s=r(66734),a=r(70579);const n=(0,s.A)((0,a.jsx)("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"LocationOn")},99907:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var s=r(26240),a=r(96446),n=r(68903),o=r(12110),c=r(85865),i=r(65043),l=r(73216),h=r(13194),d=r(32672),m=r(74851),x=r(60975),p=r(5243),u=r(81637),g=r(66734),A=r(70579);const v=(0,g.A)((0,A.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m2 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"}),"Assignment");var y=r(67729);const f=(0,g.A)((0,A.jsx)("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"}),"AccountBalance");var j=r(42796);const b=e=>{let{stats:t,loading:r}=e;const s=e=>new Intl.NumberFormat("en-UG").format(e),i=[{title:"Total Vouchers",value:t.totalVouchers,icon:v,color:"#1976d2",bgcolor:"primary.main"},{title:"Total Grain",value:"".concat(s(t.totalQuantity),"kg"),icon:y.A,color:"primary.main",bgcolor:"success.main"},{title:"Total Value",value:"UGX ".concat(s(t.totalValue)),icon:f,color:"#ed6c02",bgcolor:"primary.main"},{title:"Active Vouchers",value:t.activeVouchers,icon:j.A,color:"#9c27b0",bgcolor:"secondary.main"}];return r?(0,A.jsxs)(a.A,{sx:{mb:4},children:[(0,A.jsx)(c.A,{variant:"h6",sx:{fontWeight:600,mb:2,color:"text.primary"},children:"My Grain Portfolio"}),(0,A.jsx)(n.Ay,{container:!0,spacing:2,children:[1,2,3,4].map((e=>(0,A.jsx)(n.Ay,{item:!0,xs:6,sm:6,md:3,children:(0,A.jsx)(o.A,{sx:{p:2,textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",minHeight:80},children:(0,A.jsx)(u.A,{size:30})})},e)))})]}):(0,A.jsxs)(a.A,{sx:{mb:4},children:[(0,A.jsx)(c.A,{variant:"h6",sx:{fontWeight:600,mb:2,color:"text.primary"},children:"My Grain Portfolio"}),(0,A.jsx)(n.Ay,{container:!0,spacing:2,children:i.map(((e,t)=>{const r=e.icon;return(0,A.jsx)(n.Ay,{item:!0,xs:6,sm:6,md:3,children:(0,A.jsxs)(o.A,{sx:{p:2,textAlign:"center",bgcolor:e.bgcolor,color:"white",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-4px)",boxShadow:6}},children:[(0,A.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:1},children:[(0,A.jsx)(r,{sx:{fontSize:24,mr:1}}),(0,A.jsx)(c.A,{variant:"h6",sx:{fontWeight:700},children:"string"===typeof e.value?e.value:s(e.value)})]}),(0,A.jsx)(c.A,{variant:"caption",sx:{fontSize:"0.75rem",opacity:.9},children:e.title})]})},t)}))})]})};var z=r(89379),w=r(17392),V=r(39336),M=r(43845);const C=(0,g.A)((0,A.jsx)("path",{d:"m16 18 2.29-2.29-4.88-4.88-4 4L2 7.41 3.41 6l6 6 4-4 6.3 6.29L22 12v6z"}),"TrendingDown"),_=(0,g.A)((0,A.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove");var G=r(47805);const S=(0,g.A)((0,A.jsx)("path",{d:"M20 4H4v2h16zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6zm-9 4H6v-4h6z"}),"Store");var P=r(91082);const F=e=>{let{priceFeeds:t,loading:r,onRefresh:l}=e;const h=(0,s.A)(),[d,m]=(0,i.useState)([]);(0,i.useEffect)((()=>{const e=t.map((e=>{const t=["up","down","stable"],r=t[Math.floor(Math.random()*t.length)],s=(10*Math.random()-5).toFixed(2);return(0,z.A)((0,z.A)({},e),{},{trend:r,changePercentage:parseFloat(s)})}));m(e)}),[t]);const x=e=>{const t="string"===typeof e?parseFloat(e):e;return new Intl.NumberFormat("en-UG",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)},p=(e,t)=>{const r={fontSize:18};return"up"===e||t>0?(0,A.jsx)(j.A,{sx:(0,z.A)((0,z.A)({},r),{},{color:h.palette.success.main})}):"down"===e||t<0?(0,A.jsx)(C,{sx:(0,z.A)((0,z.A)({},r),{},{color:h.palette.error.main})}):(0,A.jsx)(_,{sx:(0,z.A)((0,z.A)({},r),{},{color:h.palette.grey[500]})})};return r?(0,A.jsx)(o.A,{sx:{p:3,mb:4},children:(0,A.jsx)(a.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:200},children:(0,A.jsx)(u.A,{size:40,color:"primary"})})}):(0,A.jsxs)(o.A,{sx:{p:3,mb:4},children:[(0,A.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[(0,A.jsxs)(a.A,{children:[(0,A.jsx)(c.A,{variant:"h6",sx:{fontWeight:700,color:"text.primary"},children:"Live Market Prices"}),(0,A.jsx)(c.A,{variant:"body2",color:"text.primary",children:"Real-time grain prices across different hubs"})]}),(0,A.jsx)(w.A,{onClick:l,color:"primary",children:(0,A.jsx)(G.A,{})})]}),(0,A.jsx)(n.Ay,{container:!0,spacing:2,children:d.slice(0,8).map((e=>{var t,r,s;return(0,A.jsx)(n.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,A.jsxs)(o.A,{variant:"outlined",sx:{p:2,height:"100%",borderRadius:2,transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-3px)",boxShadow:6}},children:[(0,A.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,A.jsxs)(a.A,{sx:{flexGrow:1},children:[(0,A.jsx)(c.A,{variant:"subtitle1",sx:{fontWeight:600,color:"text.primary"},children:e.grain_type.name}),e.hub&&(0,A.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mt:.5},children:[(0,A.jsx)(S,{sx:{fontSize:14,color:"primary.main",mr:.5}}),(0,A.jsx)(c.A,{variant:"caption",color:"text.primary",children:e.hub.name})]})]}),p(e.trend||"stable",e.changePercentage||0)]}),(0,A.jsx)(V.A,{sx:{my:1}}),(0,A.jsxs)(a.A,{sx:{textAlign:"center",mb:1},children:[(0,A.jsxs)(c.A,{variant:"h5",sx:{fontWeight:800,color:"primary.main"},children:["UGX ",x(e.price_per_kg)]}),(0,A.jsx)(c.A,{variant:"caption",color:"text.secondary",children:"per kg"})]}),void 0!==e.changePercentage&&(0,A.jsx)(a.A,{sx:{textAlign:"center",mb:1},children:(0,A.jsx)(M.A,{size:"small",label:"".concat(e.changePercentage>0?"+":"").concat(e.changePercentage,"%"),sx:{bgcolor:(r=e.trend||"stable",s=e.changePercentage,"up"===r||s>0?h.palette.success.main:"down"===r||s<0?h.palette.error.main:h.palette.primary.main),color:"white",fontWeight:600,fontSize:"0.75rem",height:22,borderRadius:1}})}),(null===(t=e.hub)||void 0===t?void 0:t.location)&&(0,A.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,A.jsx)(P.A,{sx:{fontSize:14,color:"primary.main",mr:.5}}),(0,A.jsx)(c.A,{variant:"caption",color:"text.primary",children:e.hub.location})]})]})},e.id)}))}),0===d.length&&(0,A.jsx)(a.A,{sx:{textAlign:"center",py:4},children:(0,A.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"No price feeds available at the moment"})}),d.length>8&&(0,A.jsx)(a.A,{sx:{textAlign:"center",mt:2},children:(0,A.jsxs)(c.A,{variant:"caption",color:"text.secondary",children:["Showing 8 of ",d.length," price feeds"]})})]})};var R=r(81045),k=r(69974);const H=e=>{let{user:t}=e;return t?(0,A.jsx)(o.A,{sx:{p:3,mb:4,bgcolor:"primary.main",color:"white"},children:(0,A.jsxs)(n.Ay,{container:!0,spacing:2,alignItems:"center",children:[(0,A.jsx)(n.Ay,{item:!0,children:(0,A.jsx)(R.A,{sx:{width:64,height:64,bgcolor:"rgba(255, 255, 255, 0.2)",fontSize:"1.5rem",fontWeight:600},src:t.avatar,children:t.avatar?void 0:null!==t&&void 0!==t&&t.first_name&&null!==t&&void 0!==t&&t.last_name?"".concat(t.first_name.charAt(0)).concat(t.last_name.charAt(0)).toUpperCase():"U"})}),(0,A.jsxs)(n.Ay,{item:!0,xs:!0,children:[(0,A.jsxs)(c.A,{variant:"h5",sx:{fontWeight:600,mb:.5},children:[(()=>{const e=(new Date).getHours();return e<12?"Good Morning":e<17?"Good Afternoon":"Good Evening"})(),", ",t.first_name,"!"]}),(0,A.jsxs)(c.A,{variant:"h6",sx:{fontWeight:400,opacity:.9,mb:1},children:[t.first_name," ",t.last_name]}),t.phone&&(0,A.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",opacity:.8},children:[(0,A.jsx)(k.A,{sx:{fontSize:16,mr:1}}),(0,A.jsx)(c.A,{variant:"body2",children:t.phone})]})]}),(0,A.jsx)(n.Ay,{item:!0,children:(0,A.jsx)(a.A,{sx:{textAlign:"right"},children:(0,A.jsx)(c.A,{variant:"body2",sx:{opacity:.8},children:(new Date).toLocaleDateString("en-UG",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})})})]})}):(0,A.jsx)(a.A,{sx:{mb:4},children:(0,A.jsx)(c.A,{variant:"h5",sx:{fontWeight:600},children:"Welcome to Grain Trading Platform"})})},T=()=>{(0,h.A)("Dashboard");(0,s.A)(),(0,l.Zp)();const{user:e}=(0,d.A)(),[t,r]=(0,i.useState)({}),[u,g]=(0,i.useState)({}),[v,y]=(0,i.useState)([]),[f,j]=(0,i.useState)([]),[z,w]=(0,i.useState)(!0),[V,M]=(0,i.useState)(!0);(0,i.useEffect)((()=>{C()}),[]);const C=async()=>{w(!0);try{await Promise.all([_(),G(),S()])}catch(e){console.error("Error fetching dashboard data:",e)}finally{w(!1)}},_=async()=>{try{const e={page_size:100},t=await p.G.getMyVouchers(e);if(t&&t.results){const e=t.results,r={totalVouchers:e.length,totalValue:e.reduce(((e,t)=>e+parseFloat(t.current_value)),0),totalQuantity:e.reduce(((e,t)=>e+parseFloat(t.deposit.quantity_kg)),0),activeVouchers:e.filter((e=>"issued"===e.status)).length};g(r)}}catch(e){console.error("Error fetching voucher stats:",e),g({totalVouchers:0,totalValue:0,totalQuantity:0,activeVouchers:0})}},G=async()=>{M(!0);try{const e={page_size:20,ordering:"-effective_date"},t=await m.h.getPriceFeeds(e);t&&t.results&&y(t.results)}catch(e){console.error("Error fetching price feeds:",e),y([])}finally{M(!1)}},S=async()=>{try{const e={page_size:100},t=await x.X.getGrainTypes(e);t&&t.results&&j(t.results)}catch(e){console.error("Error fetching grain types:",e),j([])}};return(0,A.jsxs)(a.A,{pt:2,pb:4,sx:{bgcolor:"grey.50",minHeight:"100vh"},children:[(0,A.jsx)(H,{user:e}),(0,A.jsx)(b,{stats:u,loading:z}),(0,A.jsx)(F,{priceFeeds:v,loading:V,onRefresh:G}),(0,A.jsx)(n.Ay,{container:!0,spacing:4,pt:4,children:(0,A.jsx)(n.Ay,{item:!0,lg:8,md:7,xs:12,children:(0,A.jsxs)(o.A,{sx:{p:3,height:"100%"},children:[(0,A.jsx)(c.A,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Market Analytics"}),(0,A.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Track market trends and price movements for better trading decisions."}),(0,A.jsx)(a.A,{sx:{height:300,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"grey.100",borderRadius:2},children:(0,A.jsx)(c.A,{color:"text.secondary",children:"Analytics Chart Coming Soon"})})]})})})]})}}}]);
//# sourceMappingURL=9907.29d0a2da.chunk.js.map